||||||||    protected function send($subscriber_mail, $replaces, $subject, $id, $template) {
        global $lang;

        $text = rawLocale($template);
        $trep = array_merge($replaces, array('PAGE' => $id));

        $subject = $lang['mail_'.$subject].' '.$id;
        $mail    = new Mailer();
        $mail->bcc($subscriber_mail);
        $mail->subject($subject);
        $mail->setBody($text, $trep);
        $mail->setHeader(
            'List-Unsubscribe',
            '<'.wl($id, array('do'=> 'subscribe'), true, '&').'>',
            false
        );
        return $mail->send();
    }



    // FIXME no refactoring below, yet

    /**
     * Return a string with the email addresses of all the
     * users subscribed to a page
     *
     * This is the default action for COMMON_NOTIFY_ADDRESSLIST.
     *
     * @author Steven Danz <steven-danz@kc.rr.com>
     * @author Adrian Lang <lang@cosmocode.de>
     *
     * @todo this does NOT return a string but uses a reference to write back, either fix function or docs
     * @param array $data Containing $id (the page id), $self (whether the author
     *                    should be notified, $addresslist (current email address
     *                    list)
     * @return string
     */
||||||||||||||||HAS_DOC_COMMENTNO_RETURN_TYPE
(NO_PARAM_TYPENO_PARAM_DEFAULTNO_PARAM_TYPENO_PARAM_DEFAULTNO_PARAM_TYPENO_PARAM_DEFAULTNO_PARAM_TYPENO_PARAM_DEFAULTNO_PARAM_TYPENO_PARAM_DEFAULT)
(
    (AST_GLOBAL
        (AST_VAR))
    (AST_ASSIGN
        (AST_VAR)
        (AST_CALL
            (
                (AST_VAR))))
    (AST_ASSIGN
        (AST_VAR)
        (AST_CALL
            (
                (AST_VAR)
                (AST_ARRAY
                    (AST_ARRAY_ELEM
                        (AST_VAR)
                        (SCALAR))))))
    (AST_ASSIGN
        (AST_VAR)
        (AST_BINARY_OP
            (AST_BINARY_OP
                (AST_DIM
                    (AST_VAR)
                    (AST_BINARY_OP
                        (SCALAR)
                        (AST_VAR)))
                (SCALAR))
            (AST_VAR)))
    (AST_ASSIGN
        (AST_VAR)
        (AST_NEW))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (AST_VAR)))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (AST_VAR)))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (AST_VAR)
            (AST_VAR)))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_BINARY_OP
                (AST_BINARY_OP
                    (SCALAR)
                    (AST_CALL
                        (
                            (AST_VAR)
                            (AST_ARRAY
                                (AST_ARRAY_ELEM
                                    (SCALAR)
                                    (SCALAR)))
                            (AST_CONST)
                            (SCALAR))))
                (SCALAR))
            (AST_CONST)))
    (AST_RETURN
        (AST_METHOD_CALL
            (AST_VAR))))