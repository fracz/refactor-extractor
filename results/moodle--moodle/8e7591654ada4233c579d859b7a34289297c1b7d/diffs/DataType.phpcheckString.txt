||||||||	public static function checkString($pValue = null)
	{
		if ($pValue instanceof PHPExcel_RichText) {
			// TODO: Sanitize Rich-Text string (max. character count is 32,767)
			return $pValue;
		}

		// string must never be longer than 32,767 characters, truncate if necessary
		$pValue = PHPExcel_Shared_String::Substring($pValue, 0, 32767);

		// we require that newline is represented as "\n" in core, not as "\r\n" or "\r"
		$pValue = str_replace(array("\r\n", "\r"), "\n", $pValue);

		return $pValue;
	}

	/**
	 * Check a value that it is a valid error code
	 *
	 * @param mixed Value to sanitize to an Excel error code
	 * @return string Sanitized value
	 */
||||||||||||||||HAS_DOC_COMMENTNO_RETURN_TYPE
(NO_PARAM_TYPEPARAM_DEFAULT)
(
    (AST_IF
        (AST_IF_ELEM
            (AST_INSTANCEOF
                (AST_VAR))
            (
                (AST_RETURN
                    (AST_VAR)))))
    (AST_ASSIGN
        (AST_VAR)
        (AST_STATIC_CALL
            (
                (AST_VAR)
                (SCALAR)
                (SCALAR))))
    (AST_ASSIGN
        (AST_VAR)
        (AST_CALL
            (
                (AST_ARRAY
                    (AST_ARRAY_ELEM
                        (SCALAR)
                        (NULL))
                    (AST_ARRAY_ELEM
                        (SCALAR)
                        (NULL)))
                (SCALAR)
                (AST_VAR))))
    (AST_RETURN
        (AST_VAR)))