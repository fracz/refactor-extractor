||||||||    public function get_file_info($context, $filearea=null, $itemid=null, $filepath=null, $filename=null) {
        global $USER, $CFG, $DB;

        $fs = get_file_storage();

        if ($context->contextlevel == CONTEXT_SYSTEM) {
            if (is_null($filearea)) {
                return new file_info_system($this);
            }
            //TODO: question files browsing

        } else if ($context->contextlevel == CONTEXT_USER) {
            // access control: only own files
            if ($context->instanceid != $USER->id) {
                return null;
            }

            if (!is_null($filearea) and !in_array($filearea, array('user_private', 'user_draft'))) {
                // file area does not exist, sorry
                return null;
            }

            if (is_null($filearea)) {
                return new file_info_user($this, $context);
            } else {
                if ($filearea == 'user_private') {
                    if (is_null($itemid)) {
                        return new file_info_user($this, $context);
                    }
                    $filepath = is_null($filepath) ? '/' : $filepath;
                    $filename = is_null($filename) ? '.' : $filename;

                    if (!$localfile = $fs->get_file($context->id, $filearea, 0, $filepath, $filename)) {
                        if ($filepath === '/' and $filename === '.') {
                            $localfile = $fs->create_directory($context->id, $filearea, 0, $filepath, $USER->id);
                        } else {
                            // not found
                            return null;
                        }
                    }
                    $urlbase = $CFG->wwwroot.'/userfile.php';
                    // TODO: localise
                    return new file_info_stored($this, $context, $localfile, $urlbase, 'Personal files', false, true, true);

                } else if ($filearea == 'user_draft') {
                    if (empty($itemid)) {
                        return new file_info_user($this, $context);
                    }
                    $urlbase = $CFG->wwwroot.'/draftfile.php';
                    if (!$localfile = $fs->get_file($context->id, $filearea, $itemid, $filepath, $filename)) {
                        return null;
                    }
                    //something must create the top most directory
                    // TODO: localise
                    return new file_info_stored($this, $context, $localfile, $urlbase, 'Draft file area', true, true, true);
                }
            }

        } else if ($context->contextlevel == CONTEXT_COURSECAT) {
            if (!$category = $DB->get_record('course_categories', array('id'=>$context->instanceid))) {
                return null;
            }

            if (!$category->visible and !has_capability('moodle/course:viewhiddencourses', $context)) {
                return null;
            }

            if (!is_null($filearea) and !in_array($filearea, array('coursecat_intro'))) {
                // file area does not exist, sorry
                $filearea = null;
            }

            if (is_null($filearea) or is_null($itemid)) {
                return new file_info_coursecat($this, $context, $category);

            } else {
                if ($filearea == 'coursecat_intro') {
                    if (!has_capability('moodle/course:update', $context)) {
                        return null;
                    }

                    $filepath = is_null($filepath) ? '/' : $filepath;
                    $filename = is_null($filename) ? '.' : $filename;

                    $urlbase = $CFG->wwwroot.'/pluginfile.php';
                    if (!$localfile = $fs->get_file($context->id, $filearea, 0, $filepath, $filename)) {
                        if ($filepath === '/' and $filename === '.') {
                            $localfile = $fs->create_directory($context->id, $filearea, 0, $filepath);
                        } else {
                            // not found
                            return null;
                        }
                    }
                    // TODO: localise
                    return new file_info_stored($this, $context, $localfile, $urlbase, 'Category introduction files', false, true, true);

                }
            }

        } else if ($context->contextlevel == CONTEXT_COURSE) {
            if (!$course = $DB->get_record('course', array('id'=>$context->instanceid))) {
                return null;
            }

            if (!$course->visible and !has_capability('moodle/course:viewhiddencourses', $context)) {
                return null;
            }

            if (!is_null($filearea) and !in_array($filearea, array('course_intro', 'course_content', 'course_backup'))) {
                // file area does not exist, sorry
                $filearea = null;
            }

            $filepath = is_null($filepath) ? '/' : $filepath;
            $filename = is_null($filename) ? '.' : $filename;

            if (is_null($filearea) or is_null($itemid)) {
                return new file_info_course($this, $context, $course);

            } else {
                if ($filearea === 'course_intro') {
                    if (!has_capability('moodle/course:update', $context)) {
                        return null;
                    }

                    $urlbase = $CFG->wwwroot.'/pluginfile.php';
                    if (!$localfile = $fs->get_file($context->id, $filearea, 0, $filepath, $filename)) {
                        if ($filepath === '/' and $filename === '.') {
                            $localfile = $fs->create_directory($context->id, $filearea, 0, $filepath);
                        } else {
                            // not found
                            return null;
                        }
                    }
                    // TODO: localise
                    return new file_info_stored($this, $context, $localfile, $urlbase, 'Course introduction files', false, true, true);

                } else if ($filearea == 'course_backup') {
                    if (!has_capability('moodle/site:backup', $context) and !has_capability('moodle/site:restore', $context)) {
                        return null;
                    }

                    $urlbase = $CFG->wwwroot.'/pluginfile.php';
                    if (!$localfile = $fs->get_file($context->id, $filearea, 0, $filepath, $filename)) {
                        if ($filepath === '/' and $filename === '.') {
                            $localfile = $fs->create_directory($context->id, $filearea, 0, $filepath);
                        } else {
                            // not found
                            return null;
                        }
                    }

                    $downloadable = has_capability('moodle/site:backupdownload', $context);
                    $uploadable   = has_capability('moodle/site:backupupload', $context);
                    // TODO: localise
                    return new file_info_stored($this, $context, $localfile, $urlbase, 'Backup files', false, $downloadable, $uploadable);

                } else if ($filearea == 'course_content') {
                    if (!has_capability('moodle/course:managefiles', $context)) {
                        return null;
                    }

                    if (!$localfile = $fs->get_file($context->id, $filearea, 0, $filepath, $filename)) {
                        if ($filepath === '/' and $filename === '.') {
                            $localfile = $fs->create_directory($context->id, $filearea, 0, $filepath);
                        } else {
                            // not found
                            return null;
                        }
                    }

                    return new file_info_coursefile($this, $context, $localfile);
                }
            }

        } else if ($context->contextlevel == CONTEXT_MODULE) {
            //TODO
        }

        return null;
    }

    /**
     * Returns content of local directory
     */
||||||||||||||||HAS_DOC_COMMENTNO_RETURN_TYPE
(NO_PARAM_TYPENO_PARAM_DEFAULTNO_PARAM_TYPEPARAM_DEFAULTNO_PARAM_TYPEPARAM_DEFAULTNO_PARAM_TYPEPARAM_DEFAULTNO_PARAM_TYPEPARAM_DEFAULT)
(
    (AST_GLOBAL
        (AST_VAR))
    (AST_GLOBAL
        (AST_VAR))
    (AST_GLOBAL
        (AST_VAR))
    (AST_ASSIGN
        (AST_VAR)
        (AST_CALL))
    (AST_IF
        (AST_IF_ELEM
            (AST_BINARY_OP
                (AST_PROP
                    (AST_VAR))
                (AST_CONST))
            (
                (AST_IF
                    (AST_IF_ELEM
                        (AST_CALL
                            (
                                (AST_VAR)))
                        (
                            (AST_RETURN
                                (AST_NEW
                                    (
                                        (AST_VAR)))))))))
        (AST_IF_ELEM
            (NULL)
            (
                (AST_IF
                    (AST_IF_ELEM
                        (AST_BINARY_OP
                            (AST_PROP
                                (AST_VAR))
                            (AST_CONST))
                        (
                            (AST_IF
                                (AST_IF_ELEM
                                    (AST_BINARY_OP
                                        (AST_PROP
                                            (AST_VAR))
                                        (AST_PROP
                                            (AST_VAR)))
                                    (
                                        (AST_RETURN
                                            (AST_CONST)))))
                            (AST_IF
                                (AST_IF_ELEM
                                    (AST_BINARY_OP
                                        (AST_UNARY_OP
                                            (AST_CALL
                                                (
                                                    (AST_VAR))))
                                        (AST_UNARY_OP
                                            (AST_CALL
                                                (
                                                    (AST_VAR)
                                                    (AST_ARRAY
                                                        (AST_ARRAY_ELEM
                                                            (SCALAR)
                                                            (NULL))
                                                        (AST_ARRAY_ELEM
                                                            (SCALAR)
                                                            (NULL)))))))
                                    (
                                        (AST_RETURN
                                            (AST_CONST)))))
                            (AST_IF
                                (AST_IF_ELEM
                                    (AST_CALL
                                        (
                                            (AST_VAR)))
                                    (
                                        (AST_RETURN
                                            (AST_NEW
                                                (
                                                    (AST_VAR)
                                                    (AST_VAR))))))
                                (AST_IF_ELEM
                                    (NULL)
                                    (
                                        (AST_IF
                                            (AST_IF_ELEM
                                                (AST_BINARY_OP
                                                    (AST_VAR)
                                                    (SCALAR))
                                                (
                                                    (AST_IF
                                                        (AST_IF_ELEM
                                                            (AST_CALL
                                                                (
                                                                    (AST_VAR)))
                                                            (
                                                                (AST_RETURN
                                                                    (AST_NEW
                                                                        (
                                                                            (AST_VAR)
                                                                            (AST_VAR)))))))
                                                    (AST_ASSIGN
                                                        (AST_VAR)
                                                        (AST_CONDITIONAL
                                                            (AST_CALL
                                                                (
                                                                    (AST_VAR)))
                                                            (SCALAR)
                                                            (AST_VAR)))
                                                    (AST_ASSIGN
                                                        (AST_VAR)
                                                        (AST_CONDITIONAL
                                                            (AST_CALL
                                                                (
                                                                    (AST_VAR)))
                                                            (SCALAR)
                                                            (AST_VAR)))
                                                    (AST_IF
                                                        (AST_IF_ELEM
                                                            (AST_UNARY_OP
                                                                (AST_ASSIGN
                                                                    (AST_VAR)
                                                                    (AST_METHOD_CALL
                                                                        (AST_VAR)
                                                                        (
                                                                            (AST_PROP
                                                                                (AST_VAR))
                                                                            (AST_VAR)
                                                                            (SCALAR)
                                                                            (AST_VAR)
                                                                            (AST_VAR)))))
                                                            (
                                                                (AST_IF
                                                                    (AST_IF_ELEM
                                                                        (AST_BINARY_OP
                                                                            (AST_BINARY_OP
                                                                                (AST_VAR)
                                                                                (SCALAR))
                                                                            (AST_BINARY_OP
                                                                                (AST_VAR)
                                                                                (SCALAR)))
                                                                        (
                                                                            (AST_ASSIGN
                                                                                (AST_VAR)
                                                                                (AST_METHOD_CALL
                                                                                    (AST_VAR)
                                                                                    (
                                                                                        (AST_PROP
                                                                                            (AST_VAR))
                                                                                        (AST_VAR)
                                                                                        (SCALAR)
                                                                                        (AST_VAR)
                                                                                        (AST_PROP
                                                                                            (AST_VAR)))))))
                                                                    (AST_IF_ELEM
                                                                        (NULL)
                                                                        (
                                                                            (AST_RETURN
                                                                                (AST_CONST))))))))
                                                    (AST_ASSIGN
                                                        (AST_VAR)
                                                        (AST_BINARY_OP
                                                            (AST_PROP
                                                                (AST_VAR))
                                                            (SCALAR)))
                                                    (AST_RETURN
                                                        (AST_NEW
                                                            (
                                                                (AST_VAR)
                                                                (AST_VAR)
                                                                (AST_VAR)
                                                                (AST_VAR)
                                                                (SCALAR)
                                                                (AST_CONST)
                                                                (AST_CONST)
                                                                (AST_CONST))))))
                                            (AST_IF_ELEM
                                                (NULL)
                                                (
                                                    (AST_IF
                                                        (AST_IF_ELEM
                                                            (AST_BINARY_OP
                                                                (AST_VAR)
                                                                (SCALAR))
                                                            (
                                                                (AST_IF
                                                                    (AST_IF_ELEM
                                                                        (AST_EMPTY
                                                                            (AST_VAR))
                                                                        (
                                                                            (AST_RETURN
                                                                                (AST_NEW
                                                                                    (
                                                                                        (AST_VAR)
                                                                                        (AST_VAR)))))))
                                                                (AST_ASSIGN
                                                                    (AST_VAR)
                                                                    (AST_BINARY_OP
                                                                        (AST_PROP
                                                                            (AST_VAR))
                                                                        (SCALAR)))
                                                                (AST_IF
                                                                    (AST_IF_ELEM
                                                                        (AST_UNARY_OP
                                                                            (AST_ASSIGN
                                                                                (AST_VAR)
                                                                                (AST_METHOD_CALL
                                                                                    (AST_VAR)
                                                                                    (
                                                                                        (AST_PROP
                                                                                            (AST_VAR))
                                                                                        (AST_VAR)
                                                                                        (AST_VAR)
                                                                                        (AST_VAR)
                                                                                        (AST_VAR)))))
                                                                        (
                                                                            (AST_RETURN
                                                                                (AST_CONST)))))
                                                                (AST_RETURN
                                                                    (AST_NEW
                                                                        (
                                                                            (AST_VAR)
                                                                            (AST_VAR)
                                                                            (AST_VAR)
                                                                            (AST_VAR)
                                                                            (SCALAR)
                                                                            (AST_CONST)
                                                                            (AST_CONST)
                                                                            (AST_CONST)))))))))))))))
                    (AST_IF_ELEM
                        (NULL)
                        (
                            (AST_IF
                                (AST_IF_ELEM
                                    (AST_BINARY_OP
                                        (AST_PROP
                                            (AST_VAR))
                                        (AST_CONST))
                                    (
                                        (AST_IF
                                            (AST_IF_ELEM
                                                (AST_UNARY_OP
                                                    (AST_ASSIGN
                                                        (AST_VAR)
                                                        (AST_METHOD_CALL
                                                            (AST_VAR)
                                                            (
                                                                (SCALAR)
                                                                (AST_ARRAY
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_PROP
                                                                            (AST_VAR))
                                                                        (SCALAR)))))))
                                                (
                                                    (AST_RETURN
                                                        (AST_CONST)))))
                                        (AST_IF
                                            (AST_IF_ELEM
                                                (AST_BINARY_OP
                                                    (AST_UNARY_OP
                                                        (AST_PROP
                                                            (AST_VAR)))
                                                    (AST_UNARY_OP
                                                        (AST_CALL
                                                            (
                                                                (SCALAR)
                                                                (AST_VAR)))))
                                                (
                                                    (AST_RETURN
                                                        (AST_CONST)))))
                                        (AST_IF
                                            (AST_IF_ELEM
                                                (AST_BINARY_OP
                                                    (AST_UNARY_OP
                                                        (AST_CALL
                                                            (
                                                                (AST_VAR))))
                                                    (AST_UNARY_OP
                                                        (AST_CALL
                                                            (
                                                                (AST_VAR)
                                                                (AST_ARRAY
                                                                    (AST_ARRAY_ELEM
                                                                        (SCALAR)
                                                                        (NULL)))))))
                                                (
                                                    (AST_ASSIGN
                                                        (AST_VAR)
                                                        (AST_CONST)))))
                                        (AST_IF
                                            (AST_IF_ELEM
                                                (AST_BINARY_OP
                                                    (AST_CALL
                                                        (
                                                            (AST_VAR)))
                                                    (AST_CALL
                                                        (
                                                            (AST_VAR))))
                                                (
                                                    (AST_RETURN
                                                        (AST_NEW
                                                            (
                                                                (AST_VAR)
                                                                (AST_VAR)
                                                                (AST_VAR))))))
                                            (AST_IF_ELEM
                                                (NULL)
                                                (
                                                    (AST_IF
                                                        (AST_IF_ELEM
                                                            (AST_BINARY_OP
                                                                (AST_VAR)
                                                                (SCALAR))
                                                            (
                                                                (AST_IF
                                                                    (AST_IF_ELEM
                                                                        (AST_UNARY_OP
                                                                            (AST_CALL
                                                                                (
                                                                                    (SCALAR)
                                                                                    (AST_VAR))))
                                                                        (
                                                                            (AST_RETURN
                                                                                (AST_CONST)))))
                                                                (AST_ASSIGN
                                                                    (AST_VAR)
                                                                    (AST_CONDITIONAL
                                                                        (AST_CALL
                                                                            (
                                                                                (AST_VAR)))
                                                                        (SCALAR)
                                                                        (AST_VAR)))
                                                                (AST_ASSIGN
                                                                    (AST_VAR)
                                                                    (AST_CONDITIONAL
                                                                        (AST_CALL
                                                                            (
                                                                                (AST_VAR)))
                                                                        (SCALAR)
                                                                        (AST_VAR)))
                                                                (AST_ASSIGN
                                                                    (AST_VAR)
                                                                    (AST_BINARY_OP
                                                                        (AST_PROP
                                                                            (AST_VAR))
                                                                        (SCALAR)))
                                                                (AST_IF
                                                                    (AST_IF_ELEM
                                                                        (AST_UNARY_OP
                                                                            (AST_ASSIGN
                                                                                (AST_VAR)
                                                                                (AST_METHOD_CALL
                                                                                    (AST_VAR)
                                                                                    (
                                                                                        (AST_PROP
                                                                                            (AST_VAR))
                                                                                        (AST_VAR)
                                                                                        (SCALAR)
                                                                                        (AST_VAR)
                                                                                        (AST_VAR)))))
                                                                        (
                                                                            (AST_IF
                                                                                (AST_IF_ELEM
                                                                                    (AST_BINARY_OP
                                                                                        (AST_BINARY_OP
                                                                                            (AST_VAR)
                                                                                            (SCALAR))
                                                                                        (AST_BINARY_OP
                                                                                            (AST_VAR)
                                                                                            (SCALAR)))
                                                                                    (
                                                                                        (AST_ASSIGN
                                                                                            (AST_VAR)
                                                                                            (AST_METHOD_CALL
                                                                                                (AST_VAR)
                                                                                                (
                                                                                                    (AST_PROP
                                                                                                        (AST_VAR))
                                                                                                    (AST_VAR)
                                                                                                    (SCALAR)
                                                                                                    (AST_VAR))))))
                                                                                (AST_IF_ELEM
                                                                                    (NULL)
                                                                                    (
                                                                                        (AST_RETURN
                                                                                            (AST_CONST))))))))
                                                                (AST_RETURN
                                                                    (AST_NEW
                                                                        (
                                                                            (AST_VAR)
                                                                            (AST_VAR)
                                                                            (AST_VAR)
                                                                            (AST_VAR)
                                                                            (SCALAR)
                                                                            (AST_CONST)
                                                                            (AST_CONST)
                                                                            (AST_CONST))))))))))))
                                (AST_IF_ELEM
                                    (NULL)
                                    (
                                        (AST_IF
                                            (AST_IF_ELEM
                                                (AST_BINARY_OP
                                                    (AST_PROP
                                                        (AST_VAR))
                                                    (AST_CONST))
                                                (
                                                    (AST_IF
                                                        (AST_IF_ELEM
                                                            (AST_UNARY_OP
                                                                (AST_ASSIGN
                                                                    (AST_VAR)
                                                                    (AST_METHOD_CALL
                                                                        (AST_VAR)
                                                                        (
                                                                            (SCALAR)
                                                                            (AST_ARRAY
                                                                                (AST_ARRAY_ELEM
                                                                                    (AST_PROP
                                                                                        (AST_VAR))
                                                                                    (SCALAR)))))))
                                                            (
                                                                (AST_RETURN
                                                                    (AST_CONST)))))
                                                    (AST_IF
                                                        (AST_IF_ELEM
                                                            (AST_BINARY_OP
                                                                (AST_UNARY_OP
                                                                    (AST_PROP
                                                                        (AST_VAR)))
                                                                (AST_UNARY_OP
                                                                    (AST_CALL
                                                                        (
                                                                            (SCALAR)
                                                                            (AST_VAR)))))
                                                            (
                                                                (AST_RETURN
                                                                    (AST_CONST)))))
                                                    (AST_IF
                                                        (AST_IF_ELEM
                                                            (AST_BINARY_OP
                                                                (AST_UNARY_OP
                                                                    (AST_CALL
                                                                        (
                                                                            (AST_VAR))))
                                                                (AST_UNARY_OP
                                                                    (AST_CALL
                                                                        (
                                                                            (AST_VAR)
                                                                            (AST_ARRAY
                                                                                (AST_ARRAY_ELEM
                                                                                    (SCALAR)
                                                                                    (NULL))
                                                                                (AST_ARRAY_ELEM
                                                                                    (SCALAR)
                                                                                    (NULL))
                                                                                (AST_ARRAY_ELEM
                                                                                    (SCALAR)
                                                                                    (NULL)))))))
                                                            (
                                                                (AST_ASSIGN
                                                                    (AST_VAR)
                                                                    (AST_CONST)))))
                                                    (AST_ASSIGN
                                                        (AST_VAR)
                                                        (AST_CONDITIONAL
                                                            (AST_CALL
                                                                (
                                                                    (AST_VAR)))
                                                            (SCALAR)
                                                            (AST_VAR)))
                                                    (AST_ASSIGN
                                                        (AST_VAR)
                                                        (AST_CONDITIONAL
                                                            (AST_CALL
                                                                (
                                                                    (AST_VAR)))
                                                            (SCALAR)
                                                            (AST_VAR)))
                                                    (AST_IF
                                                        (AST_IF_ELEM
                                                            (AST_BINARY_OP
                                                                (AST_CALL
                                                                    (
                                                                        (AST_VAR)))
                                                                (AST_CALL
                                                                    (
                                                                        (AST_VAR))))
                                                            (
                                                                (AST_RETURN
                                                                    (AST_NEW
                                                                        (
                                                                            (AST_VAR)
                                                                            (AST_VAR)
                                                                            (AST_VAR))))))
                                                        (AST_IF_ELEM
                                                            (NULL)
                                                            (
                                                                (AST_IF
                                                                    (AST_IF_ELEM
                                                                        (AST_BINARY_OP
                                                                            (AST_VAR)
                                                                            (SCALAR))
                                                                        (
                                                                            (AST_IF
                                                                                (AST_IF_ELEM
                                                                                    (AST_UNARY_OP
                                                                                        (AST_CALL
                                                                                            (
                                                                                                (SCALAR)
                                                                                                (AST_VAR))))
                                                                                    (
                                                                                        (AST_RETURN
                                                                                            (AST_CONST)))))
                                                                            (AST_ASSIGN
                                                                                (AST_VAR)
                                                                                (AST_BINARY_OP
                                                                                    (AST_PROP
                                                                                        (AST_VAR))
                                                                                    (SCALAR)))
                                                                            (AST_IF
                                                                                (AST_IF_ELEM
                                                                                    (AST_UNARY_OP
                                                                                        (AST_ASSIGN
                                                                                            (AST_VAR)
                                                                                            (AST_METHOD_CALL
                                                                                                (AST_VAR)
                                                                                                (
                                                                                                    (AST_PROP
                                                                                                        (AST_VAR))
                                                                                                    (AST_VAR)
                                                                                                    (SCALAR)
                                                                                                    (AST_VAR)
                                                                                                    (AST_VAR)))))
                                                                                    (
                                                                                        (AST_IF
                                                                                            (AST_IF_ELEM
                                                                                                (AST_BINARY_OP
                                                                                                    (AST_BINARY_OP
                                                                                                        (AST_VAR)
                                                                                                        (SCALAR))
                                                                                                    (AST_BINARY_OP
                                                                                                        (AST_VAR)
                                                                                                        (SCALAR)))
                                                                                                (
                                                                                                    (AST_ASSIGN
                                                                                                        (AST_VAR)
                                                                                                        (AST_METHOD_CALL
                                                                                                            (AST_VAR)
                                                                                                            (
                                                                                                                (AST_PROP
                                                                                                                    (AST_VAR))
                                                                                                                (AST_VAR)
                                                                                                                (SCALAR)
                                                                                                                (AST_VAR))))))
                                                                                            (AST_IF_ELEM
                                                                                                (NULL)
                                                                                                (
                                                                                                    (AST_RETURN
                                                                                                        (AST_CONST))))))))
                                                                            (AST_RETURN
                                                                                (AST_NEW
                                                                                    (
                                                                                        (AST_VAR)
                                                                                        (AST_VAR)
                                                                                        (AST_VAR)
                                                                                        (AST_VAR)
                                                                                        (SCALAR)
                                                                                        (AST_CONST)
                                                                                        (AST_CONST)
                                                                                        (AST_CONST))))))
                                                                    (AST_IF_ELEM
                                                                        (NULL)
                                                                        (
                                                                            (AST_IF
                                                                                (AST_IF_ELEM
                                                                                    (AST_BINARY_OP
                                                                                        (AST_VAR)
                                                                                        (SCALAR))
                                                                                    (
                                                                                        (AST_IF
                                                                                            (AST_IF_ELEM
                                                                                                (AST_BINARY_OP
                                                                                                    (AST_UNARY_OP
                                                                                                        (AST_CALL
                                                                                                            (
                                                                                                                (SCALAR)
                                                                                                                (AST_VAR))))
                                                                                                    (AST_UNARY_OP
                                                                                                        (AST_CALL
                                                                                                            (
                                                                                                                (SCALAR)
                                                                                                                (AST_VAR)))))
                                                                                                (
                                                                                                    (AST_RETURN
                                                                                                        (AST_CONST)))))
                                                                                        (AST_ASSIGN
                                                                                            (AST_VAR)
                                                                                            (AST_BINARY_OP
                                                                                                (AST_PROP
                                                                                                    (AST_VAR))
                                                                                                (SCALAR)))
                                                                                        (AST_IF
                                                                                            (AST_IF_ELEM
                                                                                                (AST_UNARY_OP
                                                                                                    (AST_ASSIGN
                                                                                                        (AST_VAR)
                                                                                                        (AST_METHOD_CALL
                                                                                                            (AST_VAR)
                                                                                                            (
                                                                                                                (AST_PROP
                                                                                                                    (AST_VAR))
                                                                                                                (AST_VAR)
                                                                                                                (SCALAR)
                                                                                                                (AST_VAR)
                                                                                                                (AST_VAR)))))
                                                                                                (
                                                                                                    (AST_IF
                                                                                                        (AST_IF_ELEM
                                                                                                            (AST_BINARY_OP
                                                                                                                (AST_BINARY_OP
                                                                                                                    (AST_VAR)
                                                                                                                    (SCALAR))
                                                                                                                (AST_BINARY_OP
                                                                                                                    (AST_VAR)
                                                                                                                    (SCALAR)))
                                                                                                            (
                                                                                                                (AST_ASSIGN
                                                                                                                    (AST_VAR)
                                                                                                                    (AST_METHOD_CALL
                                                                                                                        (AST_VAR)
                                                                                                                        (
                                                                                                                            (AST_PROP
                                                                                                                                (AST_VAR))
                                                                                                                            (AST_VAR)
                                                                                                                            (SCALAR)
                                                                                                                            (AST_VAR))))))
                                                                                                        (AST_IF_ELEM
                                                                                                            (NULL)
                                                                                                            (
                                                                                                                (AST_RETURN
                                                                                                                    (AST_CONST))))))))
                                                                                        (AST_ASSIGN
                                                                                            (AST_VAR)
                                                                                            (AST_CALL
                                                                                                (
                                                                                                    (SCALAR)
                                                                                                    (AST_VAR))))
                                                                                        (AST_ASSIGN
                                                                                            (AST_VAR)
                                                                                            (AST_CALL
                                                                                                (
                                                                                                    (SCALAR)
                                                                                                    (AST_VAR))))
                                                                                        (AST_RETURN
                                                                                            (AST_NEW
                                                                                                (
                                                                                                    (AST_VAR)
                                                                                                    (AST_VAR)
                                                                                                    (AST_VAR)
                                                                                                    (AST_VAR)
                                                                                                    (SCALAR)
                                                                                                    (AST_CONST)
                                                                                                    (AST_VAR)
                                                                                                    (AST_VAR))))))
                                                                                (AST_IF_ELEM
                                                                                    (NULL)
                                                                                    (
                                                                                        (AST_IF
                                                                                            (AST_IF_ELEM
                                                                                                (AST_BINARY_OP
                                                                                                    (AST_VAR)
                                                                                                    (SCALAR))
                                                                                                (
                                                                                                    (AST_IF
                                                                                                        (AST_IF_ELEM
                                                                                                            (AST_UNARY_OP
                                                                                                                (AST_CALL
                                                                                                                    (
                                                                                                                        (SCALAR)
                                                                                                                        (AST_VAR))))
                                                                                                            (
                                                                                                                (AST_RETURN
                                                                                                                    (AST_CONST)))))
                                                                                                    (AST_IF
                                                                                                        (AST_IF_ELEM
                                                                                                            (AST_UNARY_OP
                                                                                                                (AST_ASSIGN
                                                                                                                    (AST_VAR)
                                                                                                                    (AST_METHOD_CALL
                                                                                                                        (AST_VAR)
                                                                                                                        (
                                                                                                                            (AST_PROP
                                                                                                                                (AST_VAR))
                                                                                                                            (AST_VAR)
                                                                                                                            (SCALAR)
                                                                                                                            (AST_VAR)
                                                                                                                            (AST_VAR)))))
                                                                                                            (
                                                                                                                (AST_IF
                                                                                                                    (AST_IF_ELEM
                                                                                                                        (AST_BINARY_OP
                                                                                                                            (AST_BINARY_OP
                                                                                                                                (AST_VAR)
                                                                                                                                (SCALAR))
                                                                                                                            (AST_BINARY_OP
                                                                                                                                (AST_VAR)
                                                                                                                                (SCALAR)))
                                                                                                                        (
                                                                                                                            (AST_ASSIGN
                                                                                                                                (AST_VAR)
                                                                                                                                (AST_METHOD_CALL
                                                                                                                                    (AST_VAR)
                                                                                                                                    (
                                                                                                                                        (AST_PROP
                                                                                                                                            (AST_VAR))
                                                                                                                                        (AST_VAR)
                                                                                                                                        (SCALAR)
                                                                                                                                        (AST_VAR))))))
                                                                                                                    (AST_IF_ELEM
                                                                                                                        (NULL)
                                                                                                                        (
                                                                                                                            (AST_RETURN
                                                                                                                                (AST_CONST))))))))
                                                                                                    (AST_RETURN
                                                                                                        (AST_NEW
                                                                                                            (
                                                                                                                (AST_VAR)
                                                                                                                (AST_VAR)
                                                                                                                (AST_VAR))))))))))))))))))
                                            (AST_IF_ELEM
                                                (NULL)
                                                (
                                                    (AST_IF
                                                        (AST_IF_ELEM
                                                            (AST_BINARY_OP
                                                                (AST_PROP
                                                                    (AST_VAR))
                                                                (AST_CONST))))))))))))))))
    (AST_RETURN
        (AST_CONST)))