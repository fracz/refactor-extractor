||||||||    public function test_manager_scan_file_virus() {
        // Run mock scanning without deleting infected file.
        $this->assertFileExists($this->tempfile);
        try {
            \core\antivirus\manager::scan_file($this->tempfile, 'FOUND', false);
        } catch (\moodle_exception $e) {
            $this->assertInstanceOf('\core\antivirus\scanner_exception', $e);
        }
        // File expected to remain in place.
        $this->assertFileExists($this->tempfile);

        // Run mock scanning with deleting infected file.
        try {
            \core\antivirus\manager::scan_file($this->tempfile, 'FOUND', true);
        } catch (\moodle_exception $e) {
            $this->assertInstanceOf('\core\antivirus\scanner_exception', $e);
        }
        // File expected to be deleted.
        $this->assertFileNotExists($this->tempfile);
    }
}||||||||||||||||NO_DOC_COMMENTNO_RETURN_TYPE
(
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (AST_PROP
                (AST_VAR))))
    (AST_TRY
        (
            (AST_STATIC_CALL
                (
                    (AST_PROP
                        (AST_VAR))
                    (SCALAR)
                    (AST_CONST))))
        (AST_CATCH_LIST
            (AST_CATCH
                (AST_NAME_LIST)
                (AST_VAR)
                (
                    (AST_METHOD_CALL
                        (AST_VAR)
                        (
                            (SCALAR)
                            (AST_VAR))))))
        (NULL))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (AST_PROP
                (AST_VAR))))
    (AST_TRY
        (
            (AST_STATIC_CALL
                (
                    (AST_PROP
                        (AST_VAR))
                    (SCALAR)
                    (AST_CONST))))
        (AST_CATCH_LIST
            (AST_CATCH
                (AST_NAME_LIST)
                (AST_VAR)
                (
                    (AST_METHOD_CALL
                        (AST_VAR)
                        (
                            (SCALAR)
                            (AST_VAR))))))
        (NULL))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (AST_PROP
                (AST_VAR)))))