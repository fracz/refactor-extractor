commit a1445c2a81d95fd861ded96a1a2c79b626c2ef1f
Author: Antonio Vilar <tonivilar@gmail.com>
Date:   Tue Aug 5 19:51:19 2014 +0200

    CS fixes and a bit of refactoring to improve readability