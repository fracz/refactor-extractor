commit a39656d536055532bd6d49634cf0b9f65318191f
Author: Andy Miller <rhuk@mac.com>
Date:   Sat Sep 20 15:33:41 2014 -0600

    refactored to make more reliable