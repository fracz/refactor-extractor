	private function getSelectedFilters()
	{
		$id_parent = (int)Tools::getValue('id_category', Tools::getValue('id_category_layered', 1));
		if ($id_parent == 1)
			return;

		// Force attributes selection (by url '.../2-mycategory/color-blue' or by get parameter 'selected_filters')
		if (strpos($_SERVER['SCRIPT_FILENAME'], 'blocklayered-ajax.php') === false || Tools::getValue('selected_filters') !== false)
		{
			if (Tools::getValue('selected_filters'))
				$url = Tools::getValue('selected_filters');
			else
				$url = preg_replace('/\/(?:\w*)\/(?:[0-9]+[-\w]*)([^\?]*)\??.*/', '$1', Tools::safeOutput($_SERVER['REQUEST_URI'], true));

			$url_attributes = explode('/', ltrim($url, '/'));
			$selected_filters = array('category' => array());
			if (!empty($url_attributes))
			{
				foreach ($url_attributes as $url_attribute)
				{
					$url_parameters = explode('-', $url_attribute);
					$attribute_name  = array_shift($url_parameters);
					if ($attribute_name == 'page')
						$this->page = (int)$url_parameters[0];
					else if (in_array($attribute_name, array('price', 'weight')))
						$selected_filters[$attribute_name] = array($url_parameters[0], $url_parameters[1]);
					else
					{
						foreach ($url_parameters as $url_parameter)
						{
							$data = Db::getInstance()->getValue('SELECT data FROM `'._DB_PREFIX_.'layered_friendly_url` WHERE `url_key` = \''.md5('/'.$attribute_name.'-'.$url_parameter).'\'');
							if ($data)
								foreach (Tools::unSerialize($data) as $key_params => $params)
								{
									if (!isset($selected_filters[$key_params]))
										$selected_filters[$key_params] = array();
									foreach ($params as $key_param => $param)
									{
										if (!isset($selected_filters[$key_params][$key_param]))
											$selected_filters[$key_params][$key_param] = array();
										$selected_filters[$key_params][$key_param] = $param;
									}
								}
						}
					}
				}
				return $selected_filters;
			}
		}

		/* Analyze all the filters selected by the user and store them into a tab */
		$selected_filters = array('category' => array(), 'manufacturer' => array(), 'quantity' => array(), 'condition' => array());
		foreach ($_GET as $key => $value)
			if (substr($key, 0, 8) == 'layered_')
			{
				preg_match('/^(.*)_([0-9]+|new|used|refurbished|slider)$/', substr($key, 8, strlen($key) - 8), $res);
				if (isset($res[1]))
				{
					$tmp_tab = explode('_', $value);
					$value = $tmp_tab[0];
					$id_key = false;
					if (isset($tmp_tab[1]))
						$id_key = $tmp_tab[1];
					if ($res[1] == 'condition' && in_array($value, array('new', 'used', 'refurbished')))
						$selected_filters['condition'][] = $value;
					else if ($res[1] == 'quantity' && (!$value || $value == 1))
						$selected_filters['quantity'][] = $value;
					else if (in_array($res[1], array('category', 'manufacturer')))
					{
						if (!isset($selected_filters[$res[1].($id_key ? '_'.$id_key : '')]))
							$selected_filters[$res[1].($id_key ? '_'.$id_key : '')] = array();
						$selected_filters[$res[1].($id_key ? '_'.$id_key : '')][] = (int)$value;
					}
					else if (in_array($res[1], array('id_attribute_group', 'id_feature')))
					{
						if (!isset($selected_filters[$res[1]]))
							$selected_filters[$res[1]] = array();
						$selected_filters[$res[1]][(int)$value] = $id_key.'_'.(int)$value;
					}
					else if ($res[1] == 'weight')
						$selected_filters[$res[1]] = $tmp_tab;
					else if ($res[1] == 'price')
						$selected_filters[$res[1]] = $tmp_tab;
				}
			}
		return $selected_filters;
	}

||||||||	private function getSelectedFilters()
	{
		$id_parent = (int)Tools::getValue('id_category', Tools::getValue('id_category_layered', 1));
		if ($id_parent == 1)
			return;

		// Force attributes selection (by url '.../2-mycategory/color-blue' or by get parameter 'selected_filters')
		if (strpos($_SERVER['SCRIPT_FILENAME'], 'blocklayered-ajax.php') === false || Tools::getValue('selected_filters') !== false)
		{
			if (Tools::getValue('selected_filters'))
				$url = Tools::getValue('selected_filters');
			else
				$url = preg_replace('/\/(?:\w*)\/(?:[0-9]+[-\w]*)([^\?]*)\??.*/', '$1', Tools::safeOutput($_SERVER['REQUEST_URI'], true));

			$url_attributes = explode('/', ltrim($url, '/'));
			$selected_filters = array('category' => array());
			if (!empty($url_attributes))
			{
				foreach ($url_attributes as $url_attribute)
				{
					$url_parameters = explode(Configuration::get('PS_ATTRIBUTE_ANCHOR_SEPARATOR'), $url_attribute);
					$attribute_name  = array_shift($url_parameters);
					if ($attribute_name == 'page')
						$this->page = (int)$url_parameters[0];
					else if (in_array($attribute_name, array('price', 'weight')))
						$selected_filters[$attribute_name] = array($url_parameters[0], $url_parameters[1]);
					else
					{
						foreach ($url_parameters as $url_parameter)
						{
							$data = Db::getInstance()->getValue('SELECT data FROM `'._DB_PREFIX_.'layered_friendly_url` WHERE `url_key` = \''.md5('/'.$attribute_name.Configuration::get('PS_ATTRIBUTE_ANCHOR_SEPARATOR').$url_parameter).'\'');
							if ($data)
								foreach (Tools::unSerialize($data) as $key_params => $params)
								{
									if (!isset($selected_filters[$key_params]))
										$selected_filters[$key_params] = array();
									foreach ($params as $key_param => $param)
									{
										if (!isset($selected_filters[$key_params][$key_param]))
											$selected_filters[$key_params][$key_param] = array();
										$selected_filters[$key_params][$key_param] = $param;
									}
								}
						}
					}
				}
				return $selected_filters;
			}
		}

		/* Analyze all the filters selected by the user and store them into a tab */
		$selected_filters = array('category' => array(), 'manufacturer' => array(), 'quantity' => array(), 'condition' => array());
		foreach ($_GET as $key => $value)
			if (substr($key, 0, 8) == 'layered_')
			{
				preg_match('/^(.*)_([0-9]+|new|used|refurbished|slider)$/', substr($key, 8, strlen($key) - 8), $res);
				if (isset($res[1]))
				{
					$tmp_tab = explode('_', $value);
					$value = $tmp_tab[0];
					$id_key = false;
					if (isset($tmp_tab[1]))
						$id_key = $tmp_tab[1];
					if ($res[1] == 'condition' && in_array($value, array('new', 'used', 'refurbished')))
						$selected_filters['condition'][] = $value;
					else if ($res[1] == 'quantity' && (!$value || $value == 1))
						$selected_filters['quantity'][] = $value;
					else if (in_array($res[1], array('category', 'manufacturer')))
					{
						if (!isset($selected_filters[$res[1].($id_key ? '_'.$id_key : '')]))
							$selected_filters[$res[1].($id_key ? '_'.$id_key : '')] = array();
						$selected_filters[$res[1].($id_key ? '_'.$id_key : '')][] = (int)$value;
					}
					else if (in_array($res[1], array('id_attribute_group', 'id_feature')))
					{
						if (!isset($selected_filters[$res[1]]))
							$selected_filters[$res[1]] = array();
						$selected_filters[$res[1]][(int)$value] = $id_key.'_'.(int)$value;
					}
					else if ($res[1] == 'weight')
						$selected_filters[$res[1]] = $tmp_tab;
					else if ($res[1] == 'price')
						$selected_filters[$res[1]] = $tmp_tab;
				}
			}
		return $selected_filters;
	}

||||||||NO_DOC_COMMENTNO_RETURN_TYPE
(
    (AST_ASSIGN
        (AST_VAR)
        (AST_CAST
            (AST_STATIC_CALL
                (
                    (SCALAR)
                    (AST_STATIC_CALL
                        (
                            (SCALAR)
                            (SCALAR)))))))
    (AST_IF
        (AST_IF_ELEM
            (AST_BINARY_OP
                (AST_VAR)
                (SCALAR))
            (
                (AST_RETURN
                    (NULL)))))
    (AST_IF
        (AST_IF_ELEM
            (AST_BINARY_OP
                (AST_BINARY_OP
                    (AST_CALL
                        (
                            (AST_DIM
                                (AST_VAR)
                                (SCALAR))
                            (SCALAR)))
                    (AST_CONST))
                (AST_BINARY_OP
                    (AST_STATIC_CALL
                        (
                            (SCALAR)))
                    (AST_CONST)))
            (
                (AST_IF
                    (AST_IF_ELEM
                        (AST_STATIC_CALL
                            (
                                (SCALAR)))
                        (
                            (AST_ASSIGN
                                (AST_VAR)
                                (AST_STATIC_CALL
                                    (
                                        (SCALAR))))))
                    (AST_IF_ELEM
                        (NULL)
                        (
                            (AST_ASSIGN
                                (AST_VAR)
                                (AST_CALL
                                    (
                                        (SCALAR)
                                        (SCALAR)
                                        (AST_STATIC_CALL
                                            (
                                                (AST_DIM
                                                    (AST_VAR)
                                                    (SCALAR))
                                                (AST_CONST)))))))))
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_CALL
                        (
                            (SCALAR)
                            (AST_CALL
                                (
                                    (AST_VAR)
                                    (SCALAR))))))
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_ARRAY
                        (AST_ARRAY_ELEM
                            (AST_ARRAY)
                            (SCALAR))))
                (AST_IF
                    (AST_IF_ELEM
                        (AST_UNARY_OP
                            (AST_EMPTY
                                (AST_VAR)))
                        (
                            (AST_FOREACH
                                (AST_VAR)
                                (AST_VAR)
                                (NULL)
                                (
                                    (AST_ASSIGN
                                        (AST_VAR)
                                        (AST_CALL
                                            (
                                                (SCALAR)
                                                (AST_VAR))))
                                    (AST_ASSIGN
                                        (AST_VAR)
                                        (AST_CALL
                                            (
                                                (AST_VAR))))
                                    (AST_IF
                                        (AST_IF_ELEM
                                            (AST_BINARY_OP
                                                (AST_VAR)
                                                (SCALAR))
                                            (
                                                (AST_ASSIGN
                                                    (AST_PROP
                                                        (AST_VAR))
                                                    (AST_CAST
                                                        (AST_DIM
                                                            (AST_VAR)
                                                            (SCALAR))))))
                                        (AST_IF_ELEM
                                            (NULL)
                                            (
                                                (AST_IF
                                                    (AST_IF_ELEM
                                                        (AST_CALL
                                                            (
                                                                (AST_VAR)
                                                                (AST_ARRAY
                                                                    (AST_ARRAY_ELEM
                                                                        (SCALAR)
                                                                        (NULL))
                                                                    (AST_ARRAY_ELEM
                                                                        (SCALAR)
                                                                        (NULL)))))
                                                        (
                                                            (AST_ASSIGN
                                                                (AST_DIM
                                                                    (AST_VAR)
                                                                    (AST_VAR))
                                                                (AST_ARRAY
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_DIM
                                                                            (AST_VAR)
                                                                            (SCALAR))
                                                                        (NULL))
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_DIM
                                                                            (AST_VAR)
                                                                            (SCALAR))
                                                                        (NULL))))))
                                                    (AST_IF_ELEM
                                                        (NULL)
                                                        (
                                                            (AST_FOREACH
                                                                (AST_VAR)
                                                                (AST_VAR)
                                                                (NULL)
                                                                (
                                                                    (AST_ASSIGN
                                                                        (AST_VAR)
                                                                        (AST_METHOD_CALL
                                                                            (AST_STATIC_CALL)
                                                                            (
                                                                                (AST_BINARY_OP
                                                                                    (AST_BINARY_OP
                                                                                        (AST_BINARY_OP
                                                                                            (AST_BINARY_OP
                                                                                                (SCALAR)
                                                                                                (AST_CONST))
                                                                                            (SCALAR))
                                                                                        (AST_CALL
                                                                                            (
                                                                                                (AST_BINARY_OP
                                                                                                    (AST_BINARY_OP
                                                                                                        (AST_BINARY_OP
                                                                                                            (SCALAR)
                                                                                                            (AST_VAR))
                                                                                                        (SCALAR))
                                                                                                    (AST_VAR)))))
                                                                                    (SCALAR)))))
                                                                    (AST_IF
                                                                        (AST_IF_ELEM
                                                                            (AST_VAR)
                                                                            (
                                                                                (AST_FOREACH
                                                                                    (AST_STATIC_CALL
                                                                                        (
                                                                                            (AST_VAR)))
                                                                                    (AST_VAR)
                                                                                    (AST_VAR)
                                                                                    (
                                                                                        (AST_IF
                                                                                            (AST_IF_ELEM
                                                                                                (AST_UNARY_OP
                                                                                                    (AST_ISSET
                                                                                                        (AST_DIM
                                                                                                            (AST_VAR)
                                                                                                            (AST_VAR))))
                                                                                                (
                                                                                                    (AST_ASSIGN
                                                                                                        (AST_DIM
                                                                                                            (AST_VAR)
                                                                                                            (AST_VAR))
                                                                                                        (AST_ARRAY)))))
                                                                                        (AST_FOREACH
                                                                                            (AST_VAR)
                                                                                            (AST_VAR)
                                                                                            (AST_VAR)
                                                                                            (
                                                                                                (AST_IF
                                                                                                    (AST_IF_ELEM
                                                                                                        (AST_UNARY_OP
                                                                                                            (AST_ISSET
                                                                                                                (AST_DIM
                                                                                                                    (AST_DIM
                                                                                                                        (AST_VAR)
                                                                                                                        (AST_VAR))
                                                                                                                    (AST_VAR))))
                                                                                                        (
                                                                                                            (AST_ASSIGN
                                                                                                                (AST_DIM
                                                                                                                    (AST_DIM
                                                                                                                        (AST_VAR)
                                                                                                                        (AST_VAR))
                                                                                                                    (AST_VAR))
                                                                                                                (AST_ARRAY)))))
                                                                                                (AST_ASSIGN
                                                                                                    (AST_DIM
                                                                                                        (AST_DIM
                                                                                                            (AST_VAR)
                                                                                                            (AST_VAR))
                                                                                                        (AST_VAR))
                                                                                                    (AST_VAR)))))))))))))))))))
                            (AST_RETURN
                                (AST_VAR))))))))
    (AST_ASSIGN
        (AST_VAR)
        (AST_ARRAY
            (AST_ARRAY_ELEM
                (AST_ARRAY)
                (SCALAR))
            (AST_ARRAY_ELEM
                (AST_ARRAY)
                (SCALAR))
            (AST_ARRAY_ELEM
                (AST_ARRAY)
                (SCALAR))
            (AST_ARRAY_ELEM
                (AST_ARRAY)
                (SCALAR))))
    (AST_FOREACH
        (AST_VAR)
        (AST_VAR)
        (AST_VAR)
        (
            (AST_IF
                (AST_IF_ELEM
                    (AST_BINARY_OP
                        (AST_CALL
                            (
                                (AST_VAR)
                                (SCALAR)
                                (SCALAR)))
                        (SCALAR))
                    (
                        (AST_CALL
                            (
                                (SCALAR)
                                (AST_CALL
                                    (
                                        (AST_VAR)
                                        (SCALAR)
                                        (AST_BINARY_OP
                                            (AST_CALL
                                                (
                                                    (AST_VAR)))
                                            (SCALAR))))
                                (AST_VAR)))
                        (AST_IF
                            (AST_IF_ELEM
                                (AST_ISSET
                                    (AST_DIM
                                        (AST_VAR)
                                        (SCALAR)))
                                (
                                    (AST_ASSIGN
                                        (AST_VAR)
                                        (AST_CALL
                                            (
                                                (SCALAR)
                                                (AST_VAR))))
                                    (AST_ASSIGN
                                        (AST_VAR)
                                        (AST_DIM
                                            (AST_VAR)
                                            (SCALAR)))
                                    (AST_ASSIGN
                                        (AST_VAR)
                                        (AST_CONST))
                                    (AST_IF
                                        (AST_IF_ELEM
                                            (AST_ISSET
                                                (AST_DIM
                                                    (AST_VAR)
                                                    (SCALAR)))
                                            (
                                                (AST_ASSIGN
                                                    (AST_VAR)
                                                    (AST_DIM
                                                        (AST_VAR)
                                                        (SCALAR))))))
                                    (AST_IF
                                        (AST_IF_ELEM
                                            (AST_BINARY_OP
                                                (AST_BINARY_OP
                                                    (AST_DIM
                                                        (AST_VAR)
                                                        (SCALAR))
                                                    (SCALAR))
                                                (AST_CALL
                                                    (
                                                        (AST_VAR)
                                                        (AST_ARRAY
                                                            (AST_ARRAY_ELEM
                                                                (SCALAR)
                                                                (NULL))
                                                            (AST_ARRAY_ELEM
                                                                (SCALAR)
                                                                (NULL))
                                                            (AST_ARRAY_ELEM
                                                                (SCALAR)
                                                                (NULL))))))
                                            (
                                                (AST_ASSIGN
                                                    (AST_DIM
                                                        (AST_DIM
                                                            (AST_VAR)
                                                            (SCALAR))
                                                        (NULL))
                                                    (AST_VAR))))
                                        (AST_IF_ELEM
                                            (NULL)
                                            (
                                                (AST_IF
                                                    (AST_IF_ELEM
                                                        (AST_BINARY_OP
                                                            (AST_BINARY_OP
                                                                (AST_DIM
                                                                    (AST_VAR)
                                                                    (SCALAR))
                                                                (SCALAR))
                                                            (AST_BINARY_OP
                                                                (AST_UNARY_OP
                                                                    (AST_VAR))
                                                                (AST_BINARY_OP
                                                                    (AST_VAR)
                                                                    (SCALAR))))
                                                        (
                                                            (AST_ASSIGN
                                                                (AST_DIM
                                                                    (AST_DIM
                                                                        (AST_VAR)
                                                                        (SCALAR))
                                                                    (NULL))
                                                                (AST_VAR))))
                                                    (AST_IF_ELEM
                                                        (NULL)
                                                        (
                                                            (AST_IF
                                                                (AST_IF_ELEM
                                                                    (AST_CALL
                                                                        (
                                                                            (AST_DIM
                                                                                (AST_VAR)
                                                                                (SCALAR))
                                                                            (AST_ARRAY
                                                                                (AST_ARRAY_ELEM
                                                                                    (SCALAR)
                                                                                    (NULL))
                                                                                (AST_ARRAY_ELEM
                                                                                    (SCALAR)
                                                                                    (NULL)))))
                                                                    (
                                                                        (AST_IF
                                                                            (AST_IF_ELEM
                                                                                (AST_UNARY_OP
                                                                                    (AST_ISSET
                                                                                        (AST_DIM
                                                                                            (AST_VAR)
                                                                                            (AST_BINARY_OP
                                                                                                (AST_DIM
                                                                                                    (AST_VAR)
                                                                                                    (SCALAR))
                                                                                                (AST_CONDITIONAL
                                                                                                    (AST_VAR)
                                                                                                    (AST_BINARY_OP
                                                                                                        (SCALAR)
                                                                                                        (AST_VAR))
                                                                                                    (SCALAR))))))
                                                                                (
                                                                                    (AST_ASSIGN
                                                                                        (AST_DIM
                                                                                            (AST_VAR)
                                                                                            (AST_BINARY_OP
                                                                                                (AST_DIM
                                                                                                    (AST_VAR)
                                                                                                    (SCALAR))
                                                                                                (AST_CONDITIONAL
                                                                                                    (AST_VAR)
                                                                                                    (AST_BINARY_OP
                                                                                                        (SCALAR)
                                                                                                        (AST_VAR))
                                                                                                    (SCALAR))))
                                                                                        (AST_ARRAY)))))
                                                                        (AST_ASSIGN
                                                                            (AST_DIM
                                                                                (AST_DIM
                                                                                    (AST_VAR)
                                                                                    (AST_BINARY_OP
                                                                                        (AST_DIM
                                                                                            (AST_VAR)
                                                                                            (SCALAR))
                                                                                        (AST_CONDITIONAL
                                                                                            (AST_VAR)
                                                                                            (AST_BINARY_OP
                                                                                                (SCALAR)
                                                                                                (AST_VAR))
                                                                                            (SCALAR))))
                                                                                (NULL))
                                                                            (AST_CAST
                                                                                (AST_VAR)))))
                                                                (AST_IF_ELEM
                                                                    (NULL)
                                                                    (
                                                                        (AST_IF
                                                                            (AST_IF_ELEM
                                                                                (AST_CALL
                                                                                    (
                                                                                        (AST_DIM
                                                                                            (AST_VAR)
                                                                                            (SCALAR))
                                                                                        (AST_ARRAY
                                                                                            (AST_ARRAY_ELEM
                                                                                                (SCALAR)
                                                                                                (NULL))
                                                                                            (AST_ARRAY_ELEM
                                                                                                (SCALAR)
                                                                                                (NULL)))))
                                                                                (
                                                                                    (AST_IF
                                                                                        (AST_IF_ELEM
                                                                                            (AST_UNARY_OP
                                                                                                (AST_ISSET
                                                                                                    (AST_DIM
                                                                                                        (AST_VAR)
                                                                                                        (AST_DIM
                                                                                                            (AST_VAR)
                                                                                                            (SCALAR)))))
                                                                                            (
                                                                                                (AST_ASSIGN
                                                                                                    (AST_DIM
                                                                                                        (AST_VAR)
                                                                                                        (AST_DIM
                                                                                                            (AST_VAR)
                                                                                                            (SCALAR)))
                                                                                                    (AST_ARRAY)))))
                                                                                    (AST_ASSIGN
                                                                                        (AST_DIM
                                                                                            (AST_DIM
                                                                                                (AST_VAR)
                                                                                                (AST_DIM
                                                                                                    (AST_VAR)
                                                                                                    (SCALAR)))
                                                                                            (AST_CAST
                                                                                                (AST_VAR)))
                                                                                        (AST_BINARY_OP
                                                                                            (AST_BINARY_OP
                                                                                                (AST_VAR)
                                                                                                (SCALAR))
                                                                                            (AST_CAST
                                                                                                (AST_VAR))))))
                                                                            (AST_IF_ELEM
                                                                                (NULL)
                                                                                (
                                                                                    (AST_IF
                                                                                        (AST_IF_ELEM
                                                                                            (AST_BINARY_OP
                                                                                                (AST_DIM
                                                                                                    (AST_VAR)
                                                                                                    (SCALAR))
                                                                                                (SCALAR))
                                                                                            (
                                                                                                (AST_ASSIGN
                                                                                                    (AST_DIM
                                                                                                        (AST_VAR)
                                                                                                        (AST_DIM
                                                                                                            (AST_VAR)
                                                                                                            (SCALAR)))
                                                                                                    (AST_VAR))))
                                                                                        (AST_IF_ELEM
                                                                                            (NULL)
                                                                                            (
                                                                                                (AST_IF
                                                                                                    (AST_IF_ELEM
                                                                                                        (AST_BINARY_OP
                                                                                                            (AST_DIM
                                                                                                                (AST_VAR)
                                                                                                                (SCALAR))
                                                                                                            (SCALAR))
                                                                                                        (
                                                                                                            (AST_ASSIGN
                                                                                                                (AST_DIM
                                                                                                                    (AST_VAR)
                                                                                                                    (AST_DIM
                                                                                                                        (AST_VAR)
                                                                                                                        (SCALAR)))
                                                                                                                (AST_VAR))))))))))))))))))))))))))))
    (AST_RETURN
        (AST_VAR)))||||||||NO_DOC_COMMENTNO_RETURN_TYPE
(
    (AST_ASSIGN
        (AST_VAR)
        (AST_CAST
            (AST_STATIC_CALL
                (
                    (SCALAR)
                    (AST_STATIC_CALL
                        (
                            (SCALAR)
                            (SCALAR)))))))
    (AST_IF
        (AST_IF_ELEM
            (AST_BINARY_OP
                (AST_VAR)
                (SCALAR))
            (
                (AST_RETURN
                    (NULL)))))
    (AST_IF
        (AST_IF_ELEM
            (AST_BINARY_OP
                (AST_BINARY_OP
                    (AST_CALL
                        (
                            (AST_DIM
                                (AST_VAR)
                                (SCALAR))
                            (SCALAR)))
                    (AST_CONST))
                (AST_BINARY_OP
                    (AST_STATIC_CALL
                        (
                            (SCALAR)))
                    (AST_CONST)))
            (
                (AST_IF
                    (AST_IF_ELEM
                        (AST_STATIC_CALL
                            (
                                (SCALAR)))
                        (
                            (AST_ASSIGN
                                (AST_VAR)
                                (AST_STATIC_CALL
                                    (
                                        (SCALAR))))))
                    (AST_IF_ELEM
                        (NULL)
                        (
                            (AST_ASSIGN
                                (AST_VAR)
                                (AST_CALL
                                    (
                                        (SCALAR)
                                        (SCALAR)
                                        (AST_STATIC_CALL
                                            (
                                                (AST_DIM
                                                    (AST_VAR)
                                                    (SCALAR))
                                                (AST_CONST)))))))))
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_CALL
                        (
                            (SCALAR)
                            (AST_CALL
                                (
                                    (AST_VAR)
                                    (SCALAR))))))
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_ARRAY
                        (AST_ARRAY_ELEM
                            (AST_ARRAY)
                            (SCALAR))))
                (AST_IF
                    (AST_IF_ELEM
                        (AST_UNARY_OP
                            (AST_EMPTY
                                (AST_VAR)))
                        (
                            (AST_FOREACH
                                (AST_VAR)
                                (AST_VAR)
                                (NULL)
                                (
                                    (AST_ASSIGN
                                        (AST_VAR)
                                        (AST_CALL
                                            (
                                                (AST_STATIC_CALL
                                                    (
                                                        (SCALAR)))
                                                (AST_VAR))))
                                    (AST_ASSIGN
                                        (AST_VAR)
                                        (AST_CALL
                                            (
                                                (AST_VAR))))
                                    (AST_IF
                                        (AST_IF_ELEM
                                            (AST_BINARY_OP
                                                (AST_VAR)
                                                (SCALAR))
                                            (
                                                (AST_ASSIGN
                                                    (AST_PROP
                                                        (AST_VAR))
                                                    (AST_CAST
                                                        (AST_DIM
                                                            (AST_VAR)
                                                            (SCALAR))))))
                                        (AST_IF_ELEM
                                            (NULL)
                                            (
                                                (AST_IF
                                                    (AST_IF_ELEM
                                                        (AST_CALL
                                                            (
                                                                (AST_VAR)
                                                                (AST_ARRAY
                                                                    (AST_ARRAY_ELEM
                                                                        (SCALAR)
                                                                        (NULL))
                                                                    (AST_ARRAY_ELEM
                                                                        (SCALAR)
                                                                        (NULL)))))
                                                        (
                                                            (AST_ASSIGN
                                                                (AST_DIM
                                                                    (AST_VAR)
                                                                    (AST_VAR))
                                                                (AST_ARRAY
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_DIM
                                                                            (AST_VAR)
                                                                            (SCALAR))
                                                                        (NULL))
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_DIM
                                                                            (AST_VAR)
                                                                            (SCALAR))
                                                                        (NULL))))))
                                                    (AST_IF_ELEM
                                                        (NULL)
                                                        (
                                                            (AST_FOREACH
                                                                (AST_VAR)
                                                                (AST_VAR)
                                                                (NULL)
                                                                (
                                                                    (AST_ASSIGN
                                                                        (AST_VAR)
                                                                        (AST_METHOD_CALL
                                                                            (AST_STATIC_CALL)
                                                                            (
                                                                                (AST_BINARY_OP
                                                                                    (AST_BINARY_OP
                                                                                        (AST_BINARY_OP
                                                                                            (AST_BINARY_OP
                                                                                                (SCALAR)
                                                                                                (AST_CONST))
                                                                                            (SCALAR))
                                                                                        (AST_CALL
                                                                                            (
                                                                                                (AST_BINARY_OP
                                                                                                    (AST_BINARY_OP
                                                                                                        (AST_BINARY_OP
                                                                                                            (SCALAR)
                                                                                                            (AST_VAR))
                                                                                                        (AST_STATIC_CALL
                                                                                                            (
                                                                                                                (SCALAR))))
                                                                                                    (AST_VAR)))))
                                                                                    (SCALAR)))))
                                                                    (AST_IF
                                                                        (AST_IF_ELEM
                                                                            (AST_VAR)
                                                                            (
                                                                                (AST_FOREACH
                                                                                    (AST_STATIC_CALL
                                                                                        (
                                                                                            (AST_VAR)))
                                                                                    (AST_VAR)
                                                                                    (AST_VAR)
                                                                                    (
                                                                                        (AST_IF
                                                                                            (AST_IF_ELEM
                                                                                                (AST_UNARY_OP
                                                                                                    (AST_ISSET
                                                                                                        (AST_DIM
                                                                                                            (AST_VAR)
                                                                                                            (AST_VAR))))
                                                                                                (
                                                                                                    (AST_ASSIGN
                                                                                                        (AST_DIM
                                                                                                            (AST_VAR)
                                                                                                            (AST_VAR))
                                                                                                        (AST_ARRAY)))))
                                                                                        (AST_FOREACH
                                                                                            (AST_VAR)
                                                                                            (AST_VAR)
                                                                                            (AST_VAR)
                                                                                            (
                                                                                                (AST_IF
                                                                                                    (AST_IF_ELEM
                                                                                                        (AST_UNARY_OP
                                                                                                            (AST_ISSET
                                                                                                                (AST_DIM
                                                                                                                    (AST_DIM
                                                                                                                        (AST_VAR)
                                                                                                                        (AST_VAR))
                                                                                                                    (AST_VAR))))
                                                                                                        (
                                                                                                            (AST_ASSIGN
                                                                                                                (AST_DIM
                                                                                                                    (AST_DIM
                                                                                                                        (AST_VAR)
                                                                                                                        (AST_VAR))
                                                                                                                    (AST_VAR))
                                                                                                                (AST_ARRAY)))))
                                                                                                (AST_ASSIGN
                                                                                                    (AST_DIM
                                                                                                        (AST_DIM
                                                                                                            (AST_VAR)
                                                                                                            (AST_VAR))
                                                                                                        (AST_VAR))
                                                                                                    (AST_VAR)))))))))))))))))))
                            (AST_RETURN
                                (AST_VAR))))))))
    (AST_ASSIGN
        (AST_VAR)
        (AST_ARRAY
            (AST_ARRAY_ELEM
                (AST_ARRAY)
                (SCALAR))
            (AST_ARRAY_ELEM
                (AST_ARRAY)
                (SCALAR))
            (AST_ARRAY_ELEM
                (AST_ARRAY)
                (SCALAR))
            (AST_ARRAY_ELEM
                (AST_ARRAY)
                (SCALAR))))
    (AST_FOREACH
        (AST_VAR)
        (AST_VAR)
        (AST_VAR)
        (
            (AST_IF
                (AST_IF_ELEM
                    (AST_BINARY_OP
                        (AST_CALL
                            (
                                (AST_VAR)
                                (SCALAR)
                                (SCALAR)))
                        (SCALAR))
                    (
                        (AST_CALL
                            (
                                (SCALAR)
                                (AST_CALL
                                    (
                                        (AST_VAR)
                                        (SCALAR)
                                        (AST_BINARY_OP
                                            (AST_CALL
                                                (
                                                    (AST_VAR)))
                                            (SCALAR))))
                                (AST_VAR)))
                        (AST_IF
                            (AST_IF_ELEM
                                (AST_ISSET
                                    (AST_DIM
                                        (AST_VAR)
                                        (SCALAR)))
                                (
                                    (AST_ASSIGN
                                        (AST_VAR)
                                        (AST_CALL
                                            (
                                                (SCALAR)
                                                (AST_VAR))))
                                    (AST_ASSIGN
                                        (AST_VAR)
                                        (AST_DIM
                                            (AST_VAR)
                                            (SCALAR)))
                                    (AST_ASSIGN
                                        (AST_VAR)
                                        (AST_CONST))
                                    (AST_IF
                                        (AST_IF_ELEM
                                            (AST_ISSET
                                                (AST_DIM
                                                    (AST_VAR)
                                                    (SCALAR)))
                                            (
                                                (AST_ASSIGN
                                                    (AST_VAR)
                                                    (AST_DIM
                                                        (AST_VAR)
                                                        (SCALAR))))))
                                    (AST_IF
                                        (AST_IF_ELEM
                                            (AST_BINARY_OP
                                                (AST_BINARY_OP
                                                    (AST_DIM
                                                        (AST_VAR)
                                                        (SCALAR))
                                                    (SCALAR))
                                                (AST_CALL
                                                    (
                                                        (AST_VAR)
                                                        (AST_ARRAY
                                                            (AST_ARRAY_ELEM
                                                                (SCALAR)
                                                                (NULL))
                                                            (AST_ARRAY_ELEM
                                                                (SCALAR)
                                                                (NULL))
                                                            (AST_ARRAY_ELEM
                                                                (SCALAR)
                                                                (NULL))))))
                                            (
                                                (AST_ASSIGN
                                                    (AST_DIM
                                                        (AST_DIM
                                                            (AST_VAR)
                                                            (SCALAR))
                                                        (NULL))
                                                    (AST_VAR))))
                                        (AST_IF_ELEM
                                            (NULL)
                                            (
                                                (AST_IF
                                                    (AST_IF_ELEM
                                                        (AST_BINARY_OP
                                                            (AST_BINARY_OP
                                                                (AST_DIM
                                                                    (AST_VAR)
                                                                    (SCALAR))
                                                                (SCALAR))
                                                            (AST_BINARY_OP
                                                                (AST_UNARY_OP
                                                                    (AST_VAR))
                                                                (AST_BINARY_OP
                                                                    (AST_VAR)
                                                                    (SCALAR))))
                                                        (
                                                            (AST_ASSIGN
                                                                (AST_DIM
                                                                    (AST_DIM
                                                                        (AST_VAR)
                                                                        (SCALAR))
                                                                    (NULL))
                                                                (AST_VAR))))
                                                    (AST_IF_ELEM
                                                        (NULL)
                                                        (
                                                            (AST_IF
                                                                (AST_IF_ELEM
                                                                    (AST_CALL
                                                                        (
                                                                            (AST_DIM
                                                                                (AST_VAR)
                                                                                (SCALAR))
                                                                            (AST_ARRAY
                                                                                (AST_ARRAY_ELEM
                                                                                    (SCALAR)
                                                                                    (NULL))
                                                                                (AST_ARRAY_ELEM
                                                                                    (SCALAR)
                                                                                    (NULL)))))
                                                                    (
                                                                        (AST_IF
                                                                            (AST_IF_ELEM
                                                                                (AST_UNARY_OP
                                                                                    (AST_ISSET
                                                                                        (AST_DIM
                                                                                            (AST_VAR)
                                                                                            (AST_BINARY_OP
                                                                                                (AST_DIM
                                                                                                    (AST_VAR)
                                                                                                    (SCALAR))
                                                                                                (AST_CONDITIONAL
                                                                                                    (AST_VAR)
                                                                                                    (AST_BINARY_OP
                                                                                                        (SCALAR)
                                                                                                        (AST_VAR))
                                                                                                    (SCALAR))))))
                                                                                (
                                                                                    (AST_ASSIGN
                                                                                        (AST_DIM
                                                                                            (AST_VAR)
                                                                                            (AST_BINARY_OP
                                                                                                (AST_DIM
                                                                                                    (AST_VAR)
                                                                                                    (SCALAR))
                                                                                                (AST_CONDITIONAL
                                                                                                    (AST_VAR)
                                                                                                    (AST_BINARY_OP
                                                                                                        (SCALAR)
                                                                                                        (AST_VAR))
                                                                                                    (SCALAR))))
                                                                                        (AST_ARRAY)))))
                                                                        (AST_ASSIGN
                                                                            (AST_DIM
                                                                                (AST_DIM
                                                                                    (AST_VAR)
                                                                                    (AST_BINARY_OP
                                                                                        (AST_DIM
                                                                                            (AST_VAR)
                                                                                            (SCALAR))
                                                                                        (AST_CONDITIONAL
                                                                                            (AST_VAR)
                                                                                            (AST_BINARY_OP
                                                                                                (SCALAR)
                                                                                                (AST_VAR))
                                                                                            (SCALAR))))
                                                                                (NULL))
                                                                            (AST_CAST
                                                                                (AST_VAR)))))
                                                                (AST_IF_ELEM
                                                                    (NULL)
                                                                    (
                                                                        (AST_IF
                                                                            (AST_IF_ELEM
                                                                                (AST_CALL
                                                                                    (
                                                                                        (AST_DIM
                                                                                            (AST_VAR)
                                                                                            (SCALAR))
                                                                                        (AST_ARRAY
                                                                                            (AST_ARRAY_ELEM
                                                                                                (SCALAR)
                                                                                                (NULL))
                                                                                            (AST_ARRAY_ELEM
                                                                                                (SCALAR)
                                                                                                (NULL)))))
                                                                                (
                                                                                    (AST_IF
                                                                                        (AST_IF_ELEM
                                                                                            (AST_UNARY_OP
                                                                                                (AST_ISSET
                                                                                                    (AST_DIM
                                                                                                        (AST_VAR)
                                                                                                        (AST_DIM
                                                                                                            (AST_VAR)
                                                                                                            (SCALAR)))))
                                                                                            (
                                                                                                (AST_ASSIGN
                                                                                                    (AST_DIM
                                                                                                        (AST_VAR)
                                                                                                        (AST_DIM
                                                                                                            (AST_VAR)
                                                                                                            (SCALAR)))
                                                                                                    (AST_ARRAY)))))
                                                                                    (AST_ASSIGN
                                                                                        (AST_DIM
                                                                                            (AST_DIM
                                                                                                (AST_VAR)
                                                                                                (AST_DIM
                                                                                                    (AST_VAR)
                                                                                                    (SCALAR)))
                                                                                            (AST_CAST
                                                                                                (AST_VAR)))
                                                                                        (AST_BINARY_OP
                                                                                            (AST_BINARY_OP
                                                                                                (AST_VAR)
                                                                                                (SCALAR))
                                                                                            (AST_CAST
                                                                                                (AST_VAR))))))
                                                                            (AST_IF_ELEM
                                                                                (NULL)
                                                                                (
                                                                                    (AST_IF
                                                                                        (AST_IF_ELEM
                                                                                            (AST_BINARY_OP
                                                                                                (AST_DIM
                                                                                                    (AST_VAR)
                                                                                                    (SCALAR))
                                                                                                (SCALAR))
                                                                                            (
                                                                                                (AST_ASSIGN
                                                                                                    (AST_DIM
                                                                                                        (AST_VAR)
                                                                                                        (AST_DIM
                                                                                                            (AST_VAR)
                                                                                                            (SCALAR)))
                                                                                                    (AST_VAR))))
                                                                                        (AST_IF_ELEM
                                                                                            (NULL)
                                                                                            (
                                                                                                (AST_IF
                                                                                                    (AST_IF_ELEM
                                                                                                        (AST_BINARY_OP
                                                                                                            (AST_DIM
                                                                                                                (AST_VAR)
                                                                                                                (SCALAR))
                                                                                                            (SCALAR))
                                                                                                        (
                                                                                                            (AST_ASSIGN
                                                                                                                (AST_DIM
                                                                                                                    (AST_VAR)
                                                                                                                    (AST_DIM
                                                                                                                        (AST_VAR)
                                                                                                                        (SCALAR)))
                                                                                                                (AST_VAR))))))))))))))))))))))))))))
    (AST_RETURN
        (AST_VAR)))