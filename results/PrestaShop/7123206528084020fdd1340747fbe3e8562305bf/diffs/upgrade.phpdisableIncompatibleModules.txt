||||||||        private function disableIncompatibleModules()
        {
            $disableModules = function () {
                $moduleManagerBuilder = ModuleManagerBuilder::getInstance();
                $moduleManagerRepository = $moduleManagerBuilder->buildRepository();
                $moduleManagerRepository->clearCache();

                $filter = new AddonListFilter();
                $filter->setStatus(AddonListFilterStatus::ON_DISK|AddonListFilterStatus::INSTALLED);

                $list = $moduleManagerRepository->getFilteredList($filter, true);
                /**
                 * @var $module \PrestaShop\PrestaShop\Adapter\Module\Module
                 */
                foreach ($list as $moduleName => $module) {
                    if (in_array($moduleName, self::$incompatibleModules)) {
                        $this->logInfo("Uninstalling module $moduleName, not supported in this prestashop version.");
                        $module->onUninstall();
                    } else {
                        $moduleInfo = $moduleManagerRepository->getModule($moduleName, true);
                        /** @var \Symfony\Component\HttpFoundation\ParameterBag $attributes */
                        $attributes = $module->attributes;
                        if ($attributes->get('compatibility')) {
                            $maxVersion = $attributes->get('compatibility')->to;
                            if (version_compare($maxVersion, _PS_INSTALL_VERSION_) == -1 && Module::isEnabled($moduleName)) {
                                $this->logInfo("Disabling module $moduleName. Max supported version : ".$maxVersion);
                                Module::disableAllByName($moduleName);
                            }
                        }
                    }
                }
            };
            $disableModules();
        }

||||||||||||||||NO_DOC_COMMENTNO_RETURN_TYPE
(
    (AST_ASSIGN
        (AST_VAR)
        (AST_CLOSURE
            (NULL)
            (
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_STATIC_CALL))
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_METHOD_CALL
                        (AST_VAR)))
                (AST_METHOD_CALL
                    (AST_VAR))
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_NEW))
                (AST_METHOD_CALL
                    (AST_VAR)
                    (
                        (AST_BINARY_OP
                            (AST_CLASS_CONST
                                (SCALAR))
                            (AST_CLASS_CONST
                                (SCALAR)))))
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_METHOD_CALL
                        (AST_VAR)
                        (
                            (AST_VAR)
                            (AST_CONST))))
                (AST_FOREACH
                    (AST_VAR)
                    (AST_VAR)
                    (AST_VAR)
                    (
                        (AST_IF
                            (AST_IF_ELEM
                                (AST_CALL
                                    (
                                        (AST_VAR)
                                        (AST_STATIC_PROP)))
                                (
                                    (AST_METHOD_CALL
                                        (AST_VAR)
                                        (
                                            (AST_ENCAPS_LIST
                                                (SCALAR)
                                                (AST_VAR)
                                                (SCALAR))))
                                    (AST_METHOD_CALL
                                        (AST_VAR))))
                            (AST_IF_ELEM
                                (NULL)
                                (
                                    (AST_ASSIGN
                                        (AST_VAR)
                                        (AST_METHOD_CALL
                                            (AST_VAR)
                                            (
                                                (AST_VAR)
                                                (AST_CONST))))
                                    (AST_ASSIGN
                                        (AST_VAR)
                                        (AST_PROP
                                            (AST_VAR)))
                                    (AST_IF
                                        (AST_IF_ELEM
                                            (AST_METHOD_CALL
                                                (AST_VAR)
                                                (
                                                    (SCALAR)))
                                            (
                                                (AST_ASSIGN
                                                    (AST_VAR)
                                                    (AST_PROP
                                                        (AST_METHOD_CALL
                                                            (AST_VAR)
                                                            (
                                                                (SCALAR)))))
                                                (AST_IF
                                                    (AST_IF_ELEM
                                                        (AST_BINARY_OP
                                                            (AST_BINARY_OP
                                                                (AST_CALL
                                                                    (
                                                                        (AST_VAR)
                                                                        (AST_CONST)))
                                                                (AST_UNARY_OP
                                                                    (SCALAR)))
                                                            (AST_STATIC_CALL
                                                                (
                                                                    (AST_VAR))))
                                                        (
                                                            (AST_METHOD_CALL
                                                                (AST_VAR)
                                                                (
                                                                    (AST_BINARY_OP
                                                                        (AST_ENCAPS_LIST
                                                                            (SCALAR)
                                                                            (AST_VAR)
                                                                            (SCALAR))
                                                                        (AST_VAR))))
                                                            (AST_STATIC_CALL
                                                                (
                                                                    (AST_VAR)))))))))))))))))
    (AST_CALL
        (AST_VAR)))