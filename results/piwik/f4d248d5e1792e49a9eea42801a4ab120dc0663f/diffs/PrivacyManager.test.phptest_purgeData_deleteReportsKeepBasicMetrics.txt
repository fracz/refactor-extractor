||||||||	public function test_purgeData_deleteReportsKeepBasicMetrics()
	{
		Piwik_PrivacyManager::savePurgeDataSettings(array(
			'delete_reports_keep_basic_metrics' => 1
		));

		$this->addLogData();
		$this->addReportData();

		// get purge data prediction
		$prediction = Piwik_PrivacyManager::getPurgeEstimate();

		// perform checks on prediction
		$expectedPrediction = array(
			Piwik_Common::prefixTable('log_conversion') => 6,
			Piwik_Common::prefixTable('log_link_visit_action') => 6,
			Piwik_Common::prefixTable('log_visit') => 3,
			Piwik_Common::prefixTable('log_conversion_item') => 3,
			Piwik_Common::prefixTable('archive_blob_2012_01') => -1
		);
		$this->assertEqual($expectedPrediction, $prediction);

		// purge data
		$this->setTimeToRun();
		$this->instance->deleteLogData();
		$this->instance->deleteReportData();

		// perform checks
		$this->checkLogDataPurged();

		$archiveTables = $this->getArchiveTableNames();

		// all numeric metrics should be saved (5 metrics per period w/ visits + 1 'done' archive for every period)
		$janRowCount = self::JAN_METRIC_ARCHIVE_COUNT * 5 + self::TOTAL_JAN_ARCHIVE_COUNT;
		$this->assertEqual($janRowCount, $this->getTableCount($archiveTables['numeric'][0])); // January

		// check february numerics not deleted (5 metrics per period w/ visits + 1 'done' archive for every period)
		$febRowCount = self::FEB_METRIC_ARCHIVE_COUNT * 5 + self::TOTAL_FEB_ARCHIVE_COUNT;
		$this->assertEqual($febRowCount, $this->getTableCount($archiveTables['numeric'][1])); // February

		// check that the january blob table was dropped
		$this->assertFalse($this->tableExists($archiveTables['blob'][0])); // January

		// check for no changes in the february blob table
		$this->assertEqual(self::FEB_METRIC_ARCHIVE_COUNT, $this->getTableCount($archiveTables['blob'][1])); // February
	}

	/** Test that purgeData works correctly when the 'keep daily reports' setting is set to true. */
||||||||||||||||HAS_DOC_COMMENTNO_RETURN_TYPE
(
    (AST_STATIC_CALL
        (
            (AST_ARRAY
                (AST_ARRAY_ELEM
                    (SCALAR)
                    (SCALAR)))))
    (AST_METHOD_CALL
        (AST_VAR))
    (AST_METHOD_CALL
        (AST_VAR))
    (AST_ASSIGN
        (AST_VAR)
        (AST_STATIC_CALL))
    (AST_ASSIGN
        (AST_VAR)
        (AST_ARRAY
            (AST_ARRAY_ELEM
                (SCALAR)
                (AST_STATIC_CALL
                    (
                        (SCALAR))))
            (AST_ARRAY_ELEM
                (SCALAR)
                (AST_STATIC_CALL
                    (
                        (SCALAR))))
            (AST_ARRAY_ELEM
                (SCALAR)
                (AST_STATIC_CALL
                    (
                        (SCALAR))))
            (AST_ARRAY_ELEM
                (SCALAR)
                (AST_STATIC_CALL
                    (
                        (SCALAR))))
            (AST_ARRAY_ELEM
                (AST_UNARY_OP
                    (SCALAR))
                (AST_STATIC_CALL
                    (
                        (SCALAR))))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (AST_VAR)
            (AST_VAR)))
    (AST_METHOD_CALL
        (AST_VAR))
    (AST_METHOD_CALL
        (AST_PROP
            (AST_VAR)))
    (AST_METHOD_CALL
        (AST_PROP
            (AST_VAR)))
    (AST_METHOD_CALL
        (AST_VAR))
    (AST_ASSIGN
        (AST_VAR)
        (AST_METHOD_CALL
            (AST_VAR)))
    (AST_ASSIGN
        (AST_VAR)
        (AST_BINARY_OP
            (AST_BINARY_OP
                (AST_CLASS_CONST
                    (SCALAR))
                (SCALAR))
            (AST_CLASS_CONST
                (SCALAR))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (AST_VAR)
            (AST_METHOD_CALL
                (AST_VAR)
                (
                    (AST_DIM
                        (AST_DIM
                            (AST_VAR)
                            (SCALAR))
                        (SCALAR))))))
    (AST_ASSIGN
        (AST_VAR)
        (AST_BINARY_OP
            (AST_BINARY_OP
                (AST_CLASS_CONST
                    (SCALAR))
                (SCALAR))
            (AST_CLASS_CONST
                (SCALAR))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (AST_VAR)
            (AST_METHOD_CALL
                (AST_VAR)
                (
                    (AST_DIM
                        (AST_DIM
                            (AST_VAR)
                            (SCALAR))
                        (SCALAR))))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (AST_METHOD_CALL
                (AST_VAR)
                (
                    (AST_DIM
                        (AST_DIM
                            (AST_VAR)
                            (SCALAR))
                        (SCALAR))))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (AST_CLASS_CONST
                (SCALAR))
            (AST_METHOD_CALL
                (AST_VAR)
                (
                    (AST_DIM
                        (AST_DIM
                            (AST_VAR)
                            (SCALAR))
                        (SCALAR)))))))