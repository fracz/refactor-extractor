commit 96382454b104e3a33278f5230a7021d837cfd7a6
Author: Alexander Makarov <sam@rmcreative.ru>
Date:   Wed May 10 13:08:07 2017 +0300

    Additional refactoring as suggested by @dynasource