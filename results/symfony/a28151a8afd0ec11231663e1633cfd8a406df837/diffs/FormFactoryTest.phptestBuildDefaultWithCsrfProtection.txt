    public function testBuildDefaultWithCsrfProtection()
    {
        $factory = FormFactory::buildDefault($this->validator, 'secret');

        $context = new FormContext();
        $context->validator($this->validator);
        $context->csrfProtection(true);
        $context->csrfProvider(new DefaultCsrfProvider('secret'));

        $this->assertEquals(new FormFactory($context), $factory);
    }

||||||||||||||||NO_DOC_COMMENTNO_RETURN_TYPE
(
    (AST_ASSIGN
        (AST_VAR)
        (AST_STATIC_CALL
            (
                (AST_PROP
                    (AST_VAR))
                (SCALAR))))
    (AST_ASSIGN
        (AST_VAR)
        (AST_NEW))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (AST_PROP
                (AST_VAR))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (AST_CONST)))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (AST_NEW
                (
                    (SCALAR)))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (AST_NEW
                (
                    (AST_VAR)))
            (AST_VAR))))||||||||