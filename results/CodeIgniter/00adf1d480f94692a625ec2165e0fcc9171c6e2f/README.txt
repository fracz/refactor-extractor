commit 00adf1d480f94692a625ec2165e0fcc9171c6e2f
Author: Andrey Andreev <narf@bofh.bg>
Date:   Tue Apr 3 12:30:50 2012 +0300

    Some improvements to the additions from pull #1234