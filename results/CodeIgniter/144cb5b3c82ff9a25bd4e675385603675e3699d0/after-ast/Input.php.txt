AST_STMT_LIST
    0: AST_IF
        0: AST_IF_ELEM
            cond: AST_UNARY_OP
                flags: UNARY_BOOL_NOT (13)
                expr: AST_CALL
                    expr: AST_NAME
                        flags: NAME_NOT_FQ (1)
                        name: "defined"
                    args: AST_ARG_LIST
                        0: "BASEPATH"
            stmts: AST_STMT_LIST
                0: AST_EXIT
                    expr: "No direct script access allowed"
    1: AST_CLASS
        flags: 0
        name: "CI_Input"
        docComment: "/**
         * Input Class
         *
         * Pre-processes global input data for security
         *
         * @package		CodeIgniter
         * @subpackage	Libraries
         * @category	Input
         * @author		ExpressionEngine Dev Team
         * @link		http://codeigniter.com/user_guide/libraries/input.html
         */"
        extends: null
        implements: null
        stmts: AST_STMT_LIST
            0: AST_PROP_DECL
                flags: MODIFIER_PUBLIC (256)
                0: AST_PROP_ELEM
                    name: "use_xss_clean"
                    default: AST_CONST
                        name: AST_NAME
                            flags: NAME_NOT_FQ (1)
                            name: "FALSE"
                    docComment: null
            1: AST_PROP_DECL
                flags: MODIFIER_PUBLIC (256)
                0: AST_PROP_ELEM
                    name: "xss_hash"
                    default: ""
                    docComment: null
            2: AST_PROP_DECL
                flags: MODIFIER_PUBLIC (256)
                0: AST_PROP_ELEM
                    name: "ip_address"
                    default: AST_CONST
                        name: AST_NAME
                            flags: NAME_NOT_FQ (1)
                            name: "FALSE"
                    docComment: null
            3: AST_PROP_DECL
                flags: MODIFIER_PUBLIC (256)
                0: AST_PROP_ELEM
                    name: "user_agent"
                    default: AST_CONST
                        name: AST_NAME
                            flags: NAME_NOT_FQ (1)
                            name: "FALSE"
                    docComment: null
            4: AST_PROP_DECL
                flags: MODIFIER_PUBLIC (256)
                0: AST_PROP_ELEM
                    name: "allow_get_array"
                    default: AST_CONST
                        name: AST_NAME
                            flags: NAME_NOT_FQ (1)
                            name: "FALSE"
                    docComment: null
            5: AST_PROP_DECL
                flags: MODIFIER_PUBLIC (256)
                0: AST_PROP_ELEM
                    name: "never_allowed_str"
                    default: AST_ARRAY
                        flags: ARRAY_SYNTAX_LONG (2)
                        0: AST_ARRAY_ELEM
                            flags: 0
                            value: "[removed]"
                            key: "document.cookie"
                        1: AST_ARRAY_ELEM
                            flags: 0
                            value: "[removed]"
                            key: "document.write"
                        2: AST_ARRAY_ELEM
                            flags: 0
                            value: "[removed]"
                            key: ".parentNode"
                        3: AST_ARRAY_ELEM
                            flags: 0
                            value: "[removed]"
                            key: ".innerHTML"
                        4: AST_ARRAY_ELEM
                            flags: 0
                            value: "[removed]"
                            key: "window.location"
                        5: AST_ARRAY_ELEM
                            flags: 0
                            value: "[removed]"
                            key: "-moz-binding"
                        6: AST_ARRAY_ELEM
                            flags: 0
                            value: "&lt;!--"
                            key: "<!--"
                        7: AST_ARRAY_ELEM
                            flags: 0
                            value: "--&gt;"
                            key: "-->"
                        8: AST_ARRAY_ELEM
                            flags: 0
                            value: "&lt;![CDATA["
                            key: "<![CDATA["
                    docComment: null
            6: AST_PROP_DECL
                flags: MODIFIER_PUBLIC (256)
                0: AST_PROP_ELEM
                    name: "never_allowed_regex"
                    default: AST_ARRAY
                        flags: ARRAY_SYNTAX_LONG (2)
                        0: AST_ARRAY_ELEM
                            flags: 0
                            value: "[removed]"
                            key: "javascript\s*:"
                        1: AST_ARRAY_ELEM
                            flags: 0
                            value: "[removed]"
                            key: "expression\s*\("
                        2: AST_ARRAY_ELEM
                            flags: 0
                            value: "[removed]"
                            key: "Redirect\s+302"
                    docComment: null
            7: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "CI_Input"
                docComment: "/**
                	 * Constructor
                	 *
                	 * Sets whether to globally enable the XSS processing
                	 * and whether to allow the $_GET array
                	 *
                	 * @access	public
                	 */"
                params: AST_PARAM_LIST
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_CALL
                        expr: AST_NAME
                            flags: NAME_NOT_FQ (1)
                            name: "log_message"
                        args: AST_ARG_LIST
                            0: "debug"
                            1: "Input Class Initialized"
                    1: AST_ASSIGN_REF
                        var: AST_VAR
                            name: "CFG"
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "load_class"
                            args: AST_ARG_LIST
                                0: "Config"
                    2: AST_ASSIGN
                        var: AST_PROP
                            expr: AST_VAR
                                name: "this"
                            prop: "use_xss_clean"
                        expr: AST_CONDITIONAL
                            cond: AST_BINARY_OP
                                flags: BINARY_IS_IDENTICAL (15)
                                left: AST_METHOD_CALL
                                    expr: AST_VAR
                                        name: "CFG"
                                    method: "item"
                                    args: AST_ARG_LIST
                                        0: "global_xss_filtering"
                                right: AST_CONST
                                    name: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "TRUE"
                            true: AST_CONST
                                name: AST_NAME
                                    flags: NAME_NOT_FQ (1)
                                    name: "TRUE"
                            false: AST_CONST
                                name: AST_NAME
                                    flags: NAME_NOT_FQ (1)
                                    name: "FALSE"
                    3: AST_ASSIGN
                        var: AST_PROP
                            expr: AST_VAR
                                name: "this"
                            prop: "allow_get_array"
                        expr: AST_CONDITIONAL
                            cond: AST_BINARY_OP
                                flags: BINARY_IS_IDENTICAL (15)
                                left: AST_METHOD_CALL
                                    expr: AST_VAR
                                        name: "CFG"
                                    method: "item"
                                    args: AST_ARG_LIST
                                        0: "enable_query_strings"
                                right: AST_CONST
                                    name: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "TRUE"
                            true: AST_CONST
                                name: AST_NAME
                                    flags: NAME_NOT_FQ (1)
                                    name: "TRUE"
                            false: AST_CONST
                                name: AST_NAME
                                    flags: NAME_NOT_FQ (1)
                                    name: "FALSE"
                    4: AST_METHOD_CALL
                        expr: AST_VAR
                            name: "this"
                        method: "_sanitize_globals"
                        args: AST_ARG_LIST
                returnType: null
                __declId: 0
            8: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "_sanitize_globals"
                docComment: "/**
                	 * Sanitize Globals
                	 *
                	 * This function does the following:
                	 *
                	 * Unsets $_GET data (if query strings are not enabled)
                	 *
                	 * Unsets all globals if register_globals is enabled
                	 *
                	 * Standardizes newline characters to \n
                	 *
                	 * @access	private
                	 * @return	void
                	 */"
                params: AST_PARAM_LIST
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_ASSIGN
                        var: AST_VAR
                            name: "protected"
                        expr: AST_ARRAY
                            flags: ARRAY_SYNTAX_LONG (2)
                            0: AST_ARRAY_ELEM
                                flags: 0
                                value: "_SERVER"
                                key: null
                            1: AST_ARRAY_ELEM
                                flags: 0
                                value: "_GET"
                                key: null
                            2: AST_ARRAY_ELEM
                                flags: 0
                                value: "_POST"
                                key: null
                            3: AST_ARRAY_ELEM
                                flags: 0
                                value: "_FILES"
                                key: null
                            4: AST_ARRAY_ELEM
                                flags: 0
                                value: "_REQUEST"
                                key: null
                            5: AST_ARRAY_ELEM
                                flags: 0
                                value: "_SESSION"
                                key: null
                            6: AST_ARRAY_ELEM
                                flags: 0
                                value: "_ENV"
                                key: null
                            7: AST_ARRAY_ELEM
                                flags: 0
                                value: "GLOBALS"
                                key: null
                            8: AST_ARRAY_ELEM
                                flags: 0
                                value: "HTTP_RAW_POST_DATA"
                                key: null
                            9: AST_ARRAY_ELEM
                                flags: 0
                                value: "system_folder"
                                key: null
                            10: AST_ARRAY_ELEM
                                flags: 0
                                value: "application_folder"
                                key: null
                            11: AST_ARRAY_ELEM
                                flags: 0
                                value: "BM"
                                key: null
                            12: AST_ARRAY_ELEM
                                flags: 0
                                value: "EXT"
                                key: null
                            13: AST_ARRAY_ELEM
                                flags: 0
                                value: "CFG"
                                key: null
                            14: AST_ARRAY_ELEM
                                flags: 0
                                value: "URI"
                                key: null
                            15: AST_ARRAY_ELEM
                                flags: 0
                                value: "RTR"
                                key: null
                            16: AST_ARRAY_ELEM
                                flags: 0
                                value: "OUT"
                                key: null
                            17: AST_ARRAY_ELEM
                                flags: 0
                                value: "IN"
                                key: null
                    1: AST_FOREACH
                        expr: AST_ARRAY
                            flags: ARRAY_SYNTAX_LONG (2)
                            0: AST_ARRAY_ELEM
                                flags: 0
                                value: AST_VAR
                                    name: "_GET"
                                key: null
                            1: AST_ARRAY_ELEM
                                flags: 0
                                value: AST_VAR
                                    name: "_POST"
                                key: null
                            2: AST_ARRAY_ELEM
                                flags: 0
                                value: AST_VAR
                                    name: "_COOKIE"
                                key: null
                            3: AST_ARRAY_ELEM
                                flags: 0
                                value: AST_VAR
                                    name: "_SERVER"
                                key: null
                            4: AST_ARRAY_ELEM
                                flags: 0
                                value: AST_VAR
                                    name: "_FILES"
                                key: null
                            5: AST_ARRAY_ELEM
                                flags: 0
                                value: AST_VAR
                                    name: "_ENV"
                                key: null
                            6: AST_ARRAY_ELEM
                                flags: 0
                                value: AST_CONDITIONAL
                                    cond: AST_BINARY_OP
                                        flags: BINARY_BOOL_AND (259)
                                        left: AST_ISSET
                                            var: AST_VAR
                                                name: "_SESSION"
                                        right: AST_CALL
                                            expr: AST_NAME
                                                flags: NAME_NOT_FQ (1)
                                                name: "is_array"
                                            args: AST_ARG_LIST
                                                0: AST_VAR
                                                    name: "_SESSION"
                                    true: AST_VAR
                                        name: "_SESSION"
                                    false: AST_ARRAY
                                        flags: ARRAY_SYNTAX_LONG (2)
                                key: null
                        value: AST_VAR
                            name: "global"
                        key: null
                        stmts: AST_STMT_LIST
                            0: AST_IF
                                0: AST_IF_ELEM
                                    cond: AST_UNARY_OP
                                        flags: UNARY_BOOL_NOT (13)
                                        expr: AST_CALL
                                            expr: AST_NAME
                                                flags: NAME_NOT_FQ (1)
                                                name: "is_array"
                                            args: AST_ARG_LIST
                                                0: AST_VAR
                                                    name: "global"
                                    stmts: AST_STMT_LIST
                                        0: AST_IF
                                            0: AST_IF_ELEM
                                                cond: AST_UNARY_OP
                                                    flags: UNARY_BOOL_NOT (13)
                                                    expr: AST_CALL
                                                        expr: AST_NAME
                                                            flags: NAME_NOT_FQ (1)
                                                            name: "in_array"
                                                        args: AST_ARG_LIST
                                                            0: AST_VAR
                                                                name: "global"
                                                            1: AST_VAR
                                                                name: "protected"
                                                stmts: AST_STMT_LIST
                                                    0: AST_UNSET
                                                        var: AST_DIM
                                                            expr: AST_VAR
                                                                name: "GLOBALS"
                                                            dim: AST_VAR
                                                                name: "global"
                                1: AST_IF_ELEM
                                    cond: null
                                    stmts: AST_STMT_LIST
                                        0: AST_FOREACH
                                            expr: AST_VAR
                                                name: "global"
                                            value: AST_VAR
                                                name: "val"
                                            key: AST_VAR
                                                name: "key"
                                            stmts: AST_STMT_LIST
                                                0: AST_IF
                                                    0: AST_IF_ELEM
                                                        cond: AST_UNARY_OP
                                                            flags: UNARY_BOOL_NOT (13)
                                                            expr: AST_CALL
                                                                expr: AST_NAME
                                                                    flags: NAME_NOT_FQ (1)
                                                                    name: "in_array"
                                                                args: AST_ARG_LIST
                                                                    0: AST_VAR
                                                                        name: "key"
                                                                    1: AST_VAR
                                                                        name: "protected"
                                                        stmts: AST_STMT_LIST
                                                            0: AST_UNSET
                                                                var: AST_DIM
                                                                    expr: AST_VAR
                                                                        name: "GLOBALS"
                                                                    dim: AST_VAR
                                                                        name: "key"
                                                1: AST_IF
                                                    0: AST_IF_ELEM
                                                        cond: AST_CALL
                                                            expr: AST_NAME
                                                                flags: NAME_NOT_FQ (1)
                                                                name: "is_array"
                                                            args: AST_ARG_LIST
                                                                0: AST_VAR
                                                                    name: "val"
                                                        stmts: AST_STMT_LIST
                                                            0: AST_FOREACH
                                                                expr: AST_VAR
                                                                    name: "val"
                                                                value: AST_VAR
                                                                    name: "v"
                                                                key: AST_VAR
                                                                    name: "k"
                                                                stmts: AST_STMT_LIST
                                                                    0: AST_IF
                                                                        0: AST_IF_ELEM
                                                                            cond: AST_UNARY_OP
                                                                                flags: UNARY_BOOL_NOT (13)
                                                                                expr: AST_CALL
                                                                                    expr: AST_NAME
                                                                                        flags: NAME_NOT_FQ (1)
                                                                                        name: "in_array"
                                                                                    args: AST_ARG_LIST
                                                                                        0: AST_VAR
                                                                                            name: "k"
                                                                                        1: AST_VAR
                                                                                            name: "protected"
                                                                            stmts: AST_STMT_LIST
                                                                                0: AST_UNSET
                                                                                    var: AST_DIM
                                                                                        expr: AST_VAR
                                                                                            name: "GLOBALS"
                                                                                        dim: AST_VAR
                                                                                            name: "k"
                    2: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_IS_EQUAL (17)
                                left: AST_PROP
                                    expr: AST_VAR
                                        name: "this"
                                    prop: "allow_get_array"
                                right: AST_CONST
                                    name: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "FALSE"
                            stmts: AST_STMT_LIST
                                0: AST_ASSIGN
                                    var: AST_VAR
                                        name: "_GET"
                                    expr: AST_ARRAY
                                        flags: ARRAY_SYNTAX_LONG (2)
                        1: AST_IF_ELEM
                            cond: null
                            stmts: AST_STMT_LIST
                                0: AST_ASSIGN
                                    var: AST_VAR
                                        name: "_GET"
                                    expr: AST_METHOD_CALL
                                        expr: AST_VAR
                                            name: "this"
                                        method: "_clean_input_data"
                                        args: AST_ARG_LIST
                                            0: AST_VAR
                                                name: "_GET"
                    3: AST_ASSIGN
                        var: AST_VAR
                            name: "_POST"
                        expr: AST_METHOD_CALL
                            expr: AST_VAR
                                name: "this"
                            method: "_clean_input_data"
                            args: AST_ARG_LIST
                                0: AST_VAR
                                    name: "_POST"
                    4: AST_ASSIGN
                        var: AST_VAR
                            name: "_COOKIE"
                        expr: AST_METHOD_CALL
                            expr: AST_VAR
                                name: "this"
                            method: "_clean_input_data"
                            args: AST_ARG_LIST
                                0: AST_VAR
                                    name: "_COOKIE"
                    5: AST_CALL
                        expr: AST_NAME
                            flags: NAME_NOT_FQ (1)
                            name: "log_message"
                        args: AST_ARG_LIST
                            0: "debug"
                            1: "Global POST and COOKIE data sanitized"
                returnType: null
                __declId: 1
            9: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "_clean_input_data"
                docComment: "/**
                	 * Clean Input Data
                	 *
                	 * This is a helper function. It escapes data and
                	 * standardizes newline characters to \n
                	 *
                	 * @access	private
                	 * @param	string
                	 * @return	string
                	 */"
                params: AST_PARAM_LIST
                    0: AST_PARAM
                        flags: 0
                        type: null
                        name: "str"
                        default: null
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_CALL
                                expr: AST_NAME
                                    flags: NAME_NOT_FQ (1)
                                    name: "is_array"
                                args: AST_ARG_LIST
                                    0: AST_VAR
                                        name: "str"
                            stmts: AST_STMT_LIST
                                0: AST_ASSIGN
                                    var: AST_VAR
                                        name: "new_array"
                                    expr: AST_ARRAY
                                        flags: ARRAY_SYNTAX_LONG (2)
                                1: AST_FOREACH
                                    expr: AST_VAR
                                        name: "str"
                                    value: AST_VAR
                                        name: "val"
                                    key: AST_VAR
                                        name: "key"
                                    stmts: AST_STMT_LIST
                                        0: AST_ASSIGN
                                            var: AST_DIM
                                                expr: AST_VAR
                                                    name: "new_array"
                                                dim: AST_METHOD_CALL
                                                    expr: AST_VAR
                                                        name: "this"
                                                    method: "_clean_input_keys"
                                                    args: AST_ARG_LIST
                                                        0: AST_VAR
                                                            name: "key"
                                            expr: AST_METHOD_CALL
                                                expr: AST_VAR
                                                    name: "this"
                                                method: "_clean_input_data"
                                                args: AST_ARG_LIST
                                                    0: AST_VAR
                                                        name: "val"
                                2: AST_RETURN
                                    expr: AST_VAR
                                        name: "new_array"
                    1: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_CALL
                                expr: AST_NAME
                                    flags: NAME_NOT_FQ (1)
                                    name: "get_magic_quotes_gpc"
                                args: AST_ARG_LIST
                            stmts: AST_STMT_LIST
                                0: AST_ASSIGN
                                    var: AST_VAR
                                        name: "str"
                                    expr: AST_CALL
                                        expr: AST_NAME
                                            flags: NAME_NOT_FQ (1)
                                            name: "stripslashes"
                                        args: AST_ARG_LIST
                                            0: AST_VAR
                                                name: "str"
                    2: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_IS_IDENTICAL (15)
                                left: AST_PROP
                                    expr: AST_VAR
                                        name: "this"
                                    prop: "use_xss_clean"
                                right: AST_CONST
                                    name: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "TRUE"
                            stmts: AST_STMT_LIST
                                0: AST_ASSIGN
                                    var: AST_VAR
                                        name: "str"
                                    expr: AST_METHOD_CALL
                                        expr: AST_VAR
                                            name: "this"
                                        method: "xss_clean"
                                        args: AST_ARG_LIST
                                            0: AST_VAR
                                                name: "str"
                    3: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_IS_NOT_IDENTICAL (16)
                                left: AST_CALL
                                    expr: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "strpos"
                                    args: AST_ARG_LIST
                                        0: AST_VAR
                                            name: "str"
                                        1: ""
                                right: AST_CONST
                                    name: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "FALSE"
                            stmts: AST_STMT_LIST
                                0: AST_ASSIGN
                                    var: AST_VAR
                                        name: "str"
                                    expr: AST_CALL
                                        expr: AST_NAME
                                            flags: NAME_NOT_FQ (1)
                                            name: "str_replace"
                                        args: AST_ARG_LIST
                                            0: AST_ARRAY
                                                flags: ARRAY_SYNTAX_LONG (2)
                                                0: AST_ARRAY_ELEM
                                                    flags: 0
                                                    value: "
                                                    "
                                                    key: null
                                                1: AST_ARRAY_ELEM
                                                    flags: 0
                                                    value: ""
                                                    key: null
                                            1: "
                                            "
                                            2: AST_VAR
                                                name: "str"
                    4: AST_RETURN
                        expr: AST_VAR
                            name: "str"
                returnType: null
                __declId: 2
            10: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "_clean_input_keys"
                docComment: "/**
                	 * Clean Keys
                	 *
                	 * This is a helper function. To prevent malicious users
                	 * from trying to exploit keys we make sure that keys are
                	 * only named with alpha-numeric text and a few other items.
                	 *
                	 * @access	private
                	 * @param	string
                	 * @return	string
                	 */"
                params: AST_PARAM_LIST
                    0: AST_PARAM
                        flags: 0
                        type: null
                        name: "str"
                        default: null
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_UNARY_OP
                                flags: UNARY_BOOL_NOT (13)
                                expr: AST_CALL
                                    expr: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "preg_match"
                                    args: AST_ARG_LIST
                                        0: "/^[a-z0-9:_\/-]+$/i"
                                        1: AST_VAR
                                            name: "str"
                            stmts: AST_STMT_LIST
                                0: AST_EXIT
                                    expr: "Disallowed Key Characters."
                    1: AST_RETURN
                        expr: AST_VAR
                            name: "str"
                returnType: null
                __declId: 3
            11: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "_fetch_from_array"
                docComment: "/**
                	 * Fetch from array
                	 *
                	 * This is a helper function to retrieve values from global arrays
                	 *
                	 * @access	private
                	 * @param	array
                	 * @param	string
                	 * @param	bool
                	 * @return	string
                	 */"
                params: AST_PARAM_LIST
                    0: AST_PARAM
                        flags: PARAM_REF (1)
                        type: null
                        name: "array"
                        default: null
                    1: AST_PARAM
                        flags: 0
                        type: null
                        name: "index"
                        default: ""
                    2: AST_PARAM
                        flags: 0
                        type: null
                        name: "xss_clean"
                        default: AST_CONST
                            name: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "FALSE"
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_UNARY_OP
                                flags: UNARY_BOOL_NOT (13)
                                expr: AST_ISSET
                                    var: AST_DIM
                                        expr: AST_VAR
                                            name: "array"
                                        dim: AST_VAR
                                            name: "index"
                            stmts: AST_STMT_LIST
                                0: AST_RETURN
                                    expr: AST_CONST
                                        name: AST_NAME
                                            flags: NAME_NOT_FQ (1)
                                            name: "FALSE"
                    1: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_IS_IDENTICAL (15)
                                left: AST_VAR
                                    name: "xss_clean"
                                right: AST_CONST
                                    name: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "TRUE"
                            stmts: AST_STMT_LIST
                                0: AST_RETURN
                                    expr: AST_METHOD_CALL
                                        expr: AST_VAR
                                            name: "this"
                                        method: "xss_clean"
                                        args: AST_ARG_LIST
                                            0: AST_DIM
                                                expr: AST_VAR
                                                    name: "array"
                                                dim: AST_VAR
                                                    name: "index"
                    2: AST_RETURN
                        expr: AST_DIM
                            expr: AST_VAR
                                name: "array"
                            dim: AST_VAR
                                name: "index"
                returnType: null
                __declId: 4
            12: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "get"
                docComment: "/**
                	 * Fetch an item from the GET array
                	 *
                	 * @access	public
                	 * @param	string
                	 * @param	bool
                	 * @return	string
                	 */"
                params: AST_PARAM_LIST
                    0: AST_PARAM
                        flags: 0
                        type: null
                        name: "index"
                        default: ""
                    1: AST_PARAM
                        flags: 0
                        type: null
                        name: "xss_clean"
                        default: AST_CONST
                            name: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "FALSE"
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_RETURN
                        expr: AST_METHOD_CALL
                            expr: AST_VAR
                                name: "this"
                            method: "_fetch_from_array"
                            args: AST_ARG_LIST
                                0: AST_VAR
                                    name: "_GET"
                                1: AST_VAR
                                    name: "index"
                                2: AST_VAR
                                    name: "xss_clean"
                returnType: null
                __declId: 5
            13: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "post"
                docComment: "/**
                	 * Fetch an item from the POST array
                	 *
                	 * @access	public
                	 * @param	string
                	 * @param	bool
                	 * @return	string
                	 */"
                params: AST_PARAM_LIST
                    0: AST_PARAM
                        flags: 0
                        type: null
                        name: "index"
                        default: ""
                    1: AST_PARAM
                        flags: 0
                        type: null
                        name: "xss_clean"
                        default: AST_CONST
                            name: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "FALSE"
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_RETURN
                        expr: AST_METHOD_CALL
                            expr: AST_VAR
                                name: "this"
                            method: "_fetch_from_array"
                            args: AST_ARG_LIST
                                0: AST_VAR
                                    name: "_POST"
                                1: AST_VAR
                                    name: "index"
                                2: AST_VAR
                                    name: "xss_clean"
                returnType: null
                __declId: 6
            14: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "cookie"
                docComment: "/**
                	 * Fetch an item from the COOKIE array
                	 *
                	 * @access	public
                	 * @param	string
                	 * @param	bool
                	 * @return	string
                	 */"
                params: AST_PARAM_LIST
                    0: AST_PARAM
                        flags: 0
                        type: null
                        name: "index"
                        default: ""
                    1: AST_PARAM
                        flags: 0
                        type: null
                        name: "xss_clean"
                        default: AST_CONST
                            name: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "FALSE"
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_RETURN
                        expr: AST_METHOD_CALL
                            expr: AST_VAR
                                name: "this"
                            method: "_fetch_from_array"
                            args: AST_ARG_LIST
                                0: AST_VAR
                                    name: "_COOKIE"
                                1: AST_VAR
                                    name: "index"
                                2: AST_VAR
                                    name: "xss_clean"
                returnType: null
                __declId: 7
            15: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "server"
                docComment: "/**
                	 * Fetch an item from the SERVER array
                	 *
                	 * @access	public
                	 * @param	string
                	 * @param	bool
                	 * @return	string
                	 */"
                params: AST_PARAM_LIST
                    0: AST_PARAM
                        flags: 0
                        type: null
                        name: "index"
                        default: ""
                    1: AST_PARAM
                        flags: 0
                        type: null
                        name: "xss_clean"
                        default: AST_CONST
                            name: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "FALSE"
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_RETURN
                        expr: AST_METHOD_CALL
                            expr: AST_VAR
                                name: "this"
                            method: "_fetch_from_array"
                            args: AST_ARG_LIST
                                0: AST_VAR
                                    name: "_SERVER"
                                1: AST_VAR
                                    name: "index"
                                2: AST_VAR
                                    name: "xss_clean"
                returnType: null
                __declId: 8
            16: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "ip_address"
                docComment: "/**
                	 * Fetch the IP Address
                	 *
                	 * @access	public
                	 * @return	string
                	 */"
                params: AST_PARAM_LIST
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_IS_NOT_IDENTICAL (16)
                                left: AST_PROP
                                    expr: AST_VAR
                                        name: "this"
                                    prop: "ip_address"
                                right: AST_CONST
                                    name: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "FALSE"
                            stmts: AST_STMT_LIST
                                0: AST_RETURN
                                    expr: AST_PROP
                                        expr: AST_VAR
                                            name: "this"
                                        prop: "ip_address"
                    1: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_BOOL_AND (259)
                                left: AST_METHOD_CALL
                                    expr: AST_VAR
                                        name: "this"
                                    method: "server"
                                    args: AST_ARG_LIST
                                        0: "REMOTE_ADDR"
                                right: AST_METHOD_CALL
                                    expr: AST_VAR
                                        name: "this"
                                    method: "server"
                                    args: AST_ARG_LIST
                                        0: "HTTP_CLIENT_IP"
                            stmts: AST_STMT_LIST
                                0: AST_ASSIGN
                                    var: AST_PROP
                                        expr: AST_VAR
                                            name: "this"
                                        prop: "ip_address"
                                    expr: AST_DIM
                                        expr: AST_VAR
                                            name: "_SERVER"
                                        dim: "HTTP_CLIENT_IP"
                        1: AST_IF_ELEM
                            cond: AST_METHOD_CALL
                                expr: AST_VAR
                                    name: "this"
                                method: "server"
                                args: AST_ARG_LIST
                                    0: "REMOTE_ADDR"
                            stmts: AST_STMT_LIST
                                0: AST_ASSIGN
                                    var: AST_PROP
                                        expr: AST_VAR
                                            name: "this"
                                        prop: "ip_address"
                                    expr: AST_DIM
                                        expr: AST_VAR
                                            name: "_SERVER"
                                        dim: "REMOTE_ADDR"
                        2: AST_IF_ELEM
                            cond: AST_METHOD_CALL
                                expr: AST_VAR
                                    name: "this"
                                method: "server"
                                args: AST_ARG_LIST
                                    0: "HTTP_CLIENT_IP"
                            stmts: AST_STMT_LIST
                                0: AST_ASSIGN
                                    var: AST_PROP
                                        expr: AST_VAR
                                            name: "this"
                                        prop: "ip_address"
                                    expr: AST_DIM
                                        expr: AST_VAR
                                            name: "_SERVER"
                                        dim: "HTTP_CLIENT_IP"
                        3: AST_IF_ELEM
                            cond: AST_METHOD_CALL
                                expr: AST_VAR
                                    name: "this"
                                method: "server"
                                args: AST_ARG_LIST
                                    0: "HTTP_X_FORWARDED_FOR"
                            stmts: AST_STMT_LIST
                                0: AST_ASSIGN
                                    var: AST_PROP
                                        expr: AST_VAR
                                            name: "this"
                                        prop: "ip_address"
                                    expr: AST_DIM
                                        expr: AST_VAR
                                            name: "_SERVER"
                                        dim: "HTTP_X_FORWARDED_FOR"
                    2: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_IS_IDENTICAL (15)
                                left: AST_PROP
                                    expr: AST_VAR
                                        name: "this"
                                    prop: "ip_address"
                                right: AST_CONST
                                    name: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "FALSE"
                            stmts: AST_STMT_LIST
                                0: AST_ASSIGN
                                    var: AST_PROP
                                        expr: AST_VAR
                                            name: "this"
                                        prop: "ip_address"
                                    expr: "0.0.0.0"
                                1: AST_RETURN
                                    expr: AST_PROP
                                        expr: AST_VAR
                                            name: "this"
                                        prop: "ip_address"
                    3: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_CALL
                                expr: AST_NAME
                                    flags: NAME_NOT_FQ (1)
                                    name: "strstr"
                                args: AST_ARG_LIST
                                    0: AST_PROP
                                        expr: AST_VAR
                                            name: "this"
                                        prop: "ip_address"
                                    1: ","
                            stmts: AST_STMT_LIST
                                0: AST_ASSIGN
                                    var: AST_VAR
                                        name: "x"
                                    expr: AST_CALL
                                        expr: AST_NAME
                                            flags: NAME_NOT_FQ (1)
                                            name: "explode"
                                        args: AST_ARG_LIST
                                            0: ","
                                            1: AST_PROP
                                                expr: AST_VAR
                                                    name: "this"
                                                prop: "ip_address"
                                1: AST_ASSIGN
                                    var: AST_PROP
                                        expr: AST_VAR
                                            name: "this"
                                        prop: "ip_address"
                                    expr: AST_CALL
                                        expr: AST_NAME
                                            flags: NAME_NOT_FQ (1)
                                            name: "end"
                                        args: AST_ARG_LIST
                                            0: AST_VAR
                                                name: "x"
                    4: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_UNARY_OP
                                flags: UNARY_BOOL_NOT (13)
                                expr: AST_METHOD_CALL
                                    expr: AST_VAR
                                        name: "this"
                                    method: "valid_ip"
                                    args: AST_ARG_LIST
                                        0: AST_PROP
                                            expr: AST_VAR
                                                name: "this"
                                            prop: "ip_address"
                            stmts: AST_STMT_LIST
                                0: AST_ASSIGN
                                    var: AST_PROP
                                        expr: AST_VAR
                                            name: "this"
                                        prop: "ip_address"
                                    expr: "0.0.0.0"
                    5: AST_RETURN
                        expr: AST_PROP
                            expr: AST_VAR
                                name: "this"
                            prop: "ip_address"
                returnType: null
                __declId: 9
            17: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "valid_ip"
                docComment: "/**
                	 * Validate IP Address
                	 *
                	 * Updated version suggested by Geert De Deckere
                	 *
                	 * @access	public
                	 * @param	string
                	 * @return	string
                	 */"
                params: AST_PARAM_LIST
                    0: AST_PARAM
                        flags: 0
                        type: null
                        name: "ip"
                        default: null
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_ASSIGN
                        var: AST_VAR
                            name: "ip_segments"
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "explode"
                            args: AST_ARG_LIST
                                0: "."
                                1: AST_VAR
                                    name: "ip"
                    1: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_IS_NOT_EQUAL (18)
                                left: AST_CALL
                                    expr: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "count"
                                    args: AST_ARG_LIST
                                        0: AST_VAR
                                            name: "ip_segments"
                                right: 4
                            stmts: AST_STMT_LIST
                                0: AST_RETURN
                                    expr: AST_CONST
                                        name: AST_NAME
                                            flags: NAME_NOT_FQ (1)
                                            name: "FALSE"
                    2: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_IS_EQUAL (17)
                                left: AST_CALL
                                    expr: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "substr"
                                    args: AST_ARG_LIST
                                        0: AST_DIM
                                            expr: AST_VAR
                                                name: "ip_segments"
                                            dim: 0
                                        1: 0
                                        2: 1
                                right: "0"
                            stmts: AST_STMT_LIST
                                0: AST_RETURN
                                    expr: AST_CONST
                                        name: AST_NAME
                                            flags: NAME_NOT_FQ (1)
                                            name: "FALSE"
                    3: AST_FOREACH
                        expr: AST_VAR
                            name: "ip_segments"
                        value: AST_VAR
                            name: "segment"
                        key: null
                        stmts: AST_STMT_LIST
                            0: AST_IF
                                0: AST_IF_ELEM
                                    cond: AST_BINARY_OP
                                        flags: BINARY_BOOL_OR (258)
                                        left: AST_BINARY_OP
                                            flags: BINARY_BOOL_OR (258)
                                            left: AST_CALL
                                                expr: AST_NAME
                                                    flags: NAME_NOT_FQ (1)
                                                    name: "preg_match"
                                                args: AST_ARG_LIST
                                                    0: "/[^0-9]/"
                                                    1: AST_VAR
                                                        name: "segment"
                                            right: AST_BINARY_OP
                                                flags: BINARY_IS_GREATER (256)
                                                left: AST_VAR
                                                    name: "segment"
                                                right: 255
                                        right: AST_BINARY_OP
                                            flags: BINARY_IS_GREATER (256)
                                            left: AST_CALL
                                                expr: AST_NAME
                                                    flags: NAME_NOT_FQ (1)
                                                    name: "strlen"
                                                args: AST_ARG_LIST
                                                    0: AST_VAR
                                                        name: "segment"
                                            right: 3
                                    stmts: AST_STMT_LIST
                                        0: AST_RETURN
                                            expr: AST_CONST
                                                name: AST_NAME
                                                    flags: NAME_NOT_FQ (1)
                                                    name: "FALSE"
                    4: AST_RETURN
                        expr: AST_CONST
                            name: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "TRUE"
                returnType: null
                __declId: 10
            18: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "user_agent"
                docComment: "/**
                	 * User Agent
                	 *
                	 * @access	public
                	 * @return	string
                	 */"
                params: AST_PARAM_LIST
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_IS_NOT_IDENTICAL (16)
                                left: AST_PROP
                                    expr: AST_VAR
                                        name: "this"
                                    prop: "user_agent"
                                right: AST_CONST
                                    name: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "FALSE"
                            stmts: AST_STMT_LIST
                                0: AST_RETURN
                                    expr: AST_PROP
                                        expr: AST_VAR
                                            name: "this"
                                        prop: "user_agent"
                    1: AST_ASSIGN
                        var: AST_PROP
                            expr: AST_VAR
                                name: "this"
                            prop: "user_agent"
                        expr: AST_CONDITIONAL
                            cond: AST_UNARY_OP
                                flags: UNARY_BOOL_NOT (13)
                                expr: AST_ISSET
                                    var: AST_DIM
                                        expr: AST_VAR
                                            name: "_SERVER"
                                        dim: "HTTP_USER_AGENT"
                            true: AST_CONST
                                name: AST_NAME
                                    flags: NAME_NOT_FQ (1)
                                    name: "FALSE"
                            false: AST_DIM
                                expr: AST_VAR
                                    name: "_SERVER"
                                dim: "HTTP_USER_AGENT"
                    2: AST_RETURN
                        expr: AST_PROP
                            expr: AST_VAR
                                name: "this"
                            prop: "user_agent"
                returnType: null
                __declId: 11
            19: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "filename_security"
                docComment: "/**
                	 * Filename Security
                	 *
                	 * @access	public
                	 * @param	string
                	 * @return	string
                	 */"
                params: AST_PARAM_LIST
                    0: AST_PARAM
                        flags: 0
                        type: null
                        name: "str"
                        default: null
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_ASSIGN
                        var: AST_VAR
                            name: "bad"
                        expr: AST_ARRAY
                            flags: ARRAY_SYNTAX_LONG (2)
                            0: AST_ARRAY_ELEM
                                flags: 0
                                value: "../"
                                key: null
                            1: AST_ARRAY_ELEM
                                flags: 0
                                value: "./"
                                key: null
                            2: AST_ARRAY_ELEM
                                flags: 0
                                value: "<!--"
                                key: null
                            3: AST_ARRAY_ELEM
                                flags: 0
                                value: "-->"
                                key: null
                            4: AST_ARRAY_ELEM
                                flags: 0
                                value: "<"
                                key: null
                            5: AST_ARRAY_ELEM
                                flags: 0
                                value: ">"
                                key: null
                            6: AST_ARRAY_ELEM
                                flags: 0
                                value: "'"
                                key: null
                            7: AST_ARRAY_ELEM
                                flags: 0
                                value: """
                                key: null
                            8: AST_ARRAY_ELEM
                                flags: 0
                                value: "&"
                                key: null
                            9: AST_ARRAY_ELEM
                                flags: 0
                                value: "$"
                                key: null
                            10: AST_ARRAY_ELEM
                                flags: 0
                                value: "#"
                                key: null
                            11: AST_ARRAY_ELEM
                                flags: 0
                                value: "{"
                                key: null
                            12: AST_ARRAY_ELEM
                                flags: 0
                                value: "}"
                                key: null
                            13: AST_ARRAY_ELEM
                                flags: 0
                                value: "["
                                key: null
                            14: AST_ARRAY_ELEM
                                flags: 0
                                value: "]"
                                key: null
                            15: AST_ARRAY_ELEM
                                flags: 0
                                value: "="
                                key: null
                            16: AST_ARRAY_ELEM
                                flags: 0
                                value: ";"
                                key: null
                            17: AST_ARRAY_ELEM
                                flags: 0
                                value: "?"
                                key: null
                            18: AST_ARRAY_ELEM
                                flags: 0
                                value: "%20"
                                key: null
                            19: AST_ARRAY_ELEM
                                flags: 0
                                value: "%22"
                                key: null
                            20: AST_ARRAY_ELEM
                                flags: 0
                                value: "%3c"
                                key: null
                            21: AST_ARRAY_ELEM
                                flags: 0
                                value: "%253c"
                                key: null
                            22: AST_ARRAY_ELEM
                                flags: 0
                                value: "%3e"
                                key: null
                            23: AST_ARRAY_ELEM
                                flags: 0
                                value: "%0e"
                                key: null
                            24: AST_ARRAY_ELEM
                                flags: 0
                                value: "%28"
                                key: null
                            25: AST_ARRAY_ELEM
                                flags: 0
                                value: "%29"
                                key: null
                            26: AST_ARRAY_ELEM
                                flags: 0
                                value: "%2528"
                                key: null
                            27: AST_ARRAY_ELEM
                                flags: 0
                                value: "%26"
                                key: null
                            28: AST_ARRAY_ELEM
                                flags: 0
                                value: "%24"
                                key: null
                            29: AST_ARRAY_ELEM
                                flags: 0
                                value: "%3f"
                                key: null
                            30: AST_ARRAY_ELEM
                                flags: 0
                                value: "%3b"
                                key: null
                            31: AST_ARRAY_ELEM
                                flags: 0
                                value: "%3d"
                                key: null
                    1: AST_RETURN
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "stripslashes"
                            args: AST_ARG_LIST
                                0: AST_CALL
                                    expr: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "str_replace"
                                    args: AST_ARG_LIST
                                        0: AST_VAR
                                            name: "bad"
                                        1: ""
                                        2: AST_VAR
                                            name: "str"
                returnType: null
                __declId: 12
            20: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "xss_clean"
                docComment: "/**
                	 * XSS Clean
                	 *
                	 * Sanitizes data so that Cross Site Scripting Hacks can be
                	 * prevented.  This function does a fair amount of work but
                	 * it is extremely thorough, designed to prevent even the
                	 * most obscure XSS attempts.  Nothing is ever 100% foolproof,
                	 * of course, but I haven't been able to get anything passed
                	 * the filter.
                	 *
                	 * Note: This function should only be used to deal with data
                	 * upon submission.  It's not something that should
                	 * be used for general runtime processing.
                	 *
                	 * This function was based in part on some code and ideas I
                	 * got from Bitflux: http://blog.bitflux.ch/wiki/XSS_Prevention
                	 *
                	 * To help develop this script I used this great list of
                	 * vulnerabilities along with a few other hacks I've
                	 * harvested from examining vulnerabilities in other programs:
                	 * http://ha.ckers.org/xss.html
                	 *
                	 * @access	public
                	 * @param	string
                	 * @return	string
                	 */"
                params: AST_PARAM_LIST
                    0: AST_PARAM
                        flags: 0
                        type: null
                        name: "str"
                        default: null
                    1: AST_PARAM
                        flags: 0
                        type: null
                        name: "is_image"
                        default: AST_CONST
                            name: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "FALSE"
                    2: AST_PARAM
                        flags: 0
                        type: null
                        name: "loops"
                        default: 0
                    3: AST_PARAM
                        flags: 0
                        type: null
                        name: "looped_convert"
                        default: ""
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_CALL
                                expr: AST_NAME
                                    flags: NAME_NOT_FQ (1)
                                    name: "is_array"
                                args: AST_ARG_LIST
                                    0: AST_VAR
                                        name: "str"
                            stmts: AST_STMT_LIST
                                0: AST_WHILE
                                    cond: AST_ASSIGN
                                        var: AST_ARRAY
                                            flags: ARRAY_SYNTAX_LIST (1)
                                            0: AST_ARRAY_ELEM
                                                flags: 0
                                                value: AST_VAR
                                                    name: "key"
                                                key: null
                                        expr: AST_CALL
                                            expr: AST_NAME
                                                flags: NAME_NOT_FQ (1)
                                                name: "each"
                                            args: AST_ARG_LIST
                                                0: AST_VAR
                                                    name: "str"
                                    stmts: AST_STMT_LIST
                                        0: AST_ASSIGN
                                            var: AST_DIM
                                                expr: AST_VAR
                                                    name: "str"
                                                dim: AST_VAR
                                                    name: "key"
                                            expr: AST_METHOD_CALL
                                                expr: AST_VAR
                                                    name: "this"
                                                method: "xss_clean"
                                                args: AST_ARG_LIST
                                                    0: AST_DIM
                                                        expr: AST_VAR
                                                            name: "str"
                                                        dim: AST_VAR
                                                            name: "key"
                                1: AST_RETURN
                                    expr: AST_VAR
                                        name: "str"
                    1: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_IS_GREATER (256)
                                left: AST_VAR
                                    name: "loops"
                                right: 9
                            stmts: AST_STMT_LIST
                                0: AST_RETURN
                                    expr: ""
                    2: AST_ASSIGN
                        var: AST_VAR
                            name: "str"
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "preg_replace"
                            args: AST_ARG_LIST
                                0: "/\0+/"
                                1: ""
                                2: AST_VAR
                                    name: "str"
                    3: AST_ASSIGN
                        var: AST_VAR
                            name: "str"
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "preg_replace"
                            args: AST_ARG_LIST
                                0: "/(\\0)+/"
                                1: ""
                                2: AST_VAR
                                    name: "str"
                    4: AST_ASSIGN
                        var: AST_VAR
                            name: "str"
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "preg_replace"
                            args: AST_ARG_LIST
                                0: "|\&([a-z\_0-9]+)\=([a-z\_0-9]+)|i"
                                1: AST_BINARY_OP
                                    flags: BINARY_CONCAT (8)
                                    left: AST_METHOD_CALL
                                        expr: AST_VAR
                                            name: "this"
                                        method: "xss_hash"
                                        args: AST_ARG_LIST
                                    right: "\1=\2"
                                2: AST_VAR
                                    name: "str"
                    5: AST_ASSIGN
                        var: AST_VAR
                            name: "str"
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "preg_replace"
                            args: AST_ARG_LIST
                                0: "#(&\#?[0-9a-z]+)[\x00-\x20]*;?#i"
                                1: "\1;"
                                2: AST_VAR
                                    name: "str"
                    6: AST_ASSIGN
                        var: AST_VAR
                            name: "str"
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "preg_replace"
                            args: AST_ARG_LIST
                                0: "#(&\#x?)([0-9A-F]+);?#i"
                                1: "\1\2;"
                                2: AST_VAR
                                    name: "str"
                    7: AST_ASSIGN
                        var: AST_VAR
                            name: "str"
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "str_replace"
                            args: AST_ARG_LIST
                                0: AST_METHOD_CALL
                                    expr: AST_VAR
                                        name: "this"
                                    method: "xss_hash"
                                    args: AST_ARG_LIST
                                1: "&"
                                2: AST_VAR
                                    name: "str"
                    8: AST_ASSIGN
                        var: AST_VAR
                            name: "str"
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "rawurldecode"
                            args: AST_ARG_LIST
                                0: AST_VAR
                                    name: "str"
                    9: AST_ASSIGN
                        var: AST_VAR
                            name: "str"
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "preg_replace_callback"
                            args: AST_ARG_LIST
                                0: "/[a-z]+=([\'"]).*?\1/si"
                                1: AST_ARRAY
                                    flags: ARRAY_SYNTAX_LONG (2)
                                    0: AST_ARRAY_ELEM
                                        flags: 0
                                        value: AST_VAR
                                            name: "this"
                                        key: null
                                    1: AST_ARRAY_ELEM
                                        flags: 0
                                        value: "_convert_attribute"
                                        key: null
                                2: AST_VAR
                                    name: "str"
                    10: AST_ASSIGN
                        var: AST_VAR
                            name: "str"
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "preg_replace_callback"
                            args: AST_ARG_LIST
                                0: "/<\w+.*?(?=>|<|$)/si"
                                1: AST_ARRAY
                                    flags: ARRAY_SYNTAX_LONG (2)
                                    0: AST_ARRAY_ELEM
                                        flags: 0
                                        value: AST_VAR
                                            name: "this"
                                        key: null
                                    1: AST_ARRAY_ELEM
                                        flags: 0
                                        value: "_html_entity_decode_callback"
                                        key: null
                                2: AST_VAR
                                    name: "str"
                    11: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_IS_NOT_IDENTICAL (16)
                                left: AST_CALL
                                    expr: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "strpos"
                                    args: AST_ARG_LIST
                                        0: AST_VAR
                                            name: "str"
                                        1: "	"
                                right: AST_CONST
                                    name: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "FALSE"
                            stmts: AST_STMT_LIST
                                0: AST_ASSIGN
                                    var: AST_VAR
                                        name: "str"
                                    expr: AST_CALL
                                        expr: AST_NAME
                                            flags: NAME_NOT_FQ (1)
                                            name: "str_replace"
                                        args: AST_ARG_LIST
                                            0: "	"
                                            1: " "
                                            2: AST_VAR
                                                name: "str"
                    12: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_BOOL_AND (259)
                                left: AST_BINARY_OP
                                    flags: BINARY_IS_NOT_EQUAL (18)
                                    left: AST_VAR
                                        name: "looped_convert"
                                    right: ""
                                right: AST_BINARY_OP
                                    flags: BINARY_IS_EQUAL (17)
                                    left: AST_VAR
                                        name: "looped_convert"
                                    right: AST_VAR
                                        name: "str"
                            stmts: AST_STMT_LIST
                                0: AST_RETURN
                                    expr: ""
                        1: AST_IF_ELEM
                            cond: null
                            stmts: AST_STMT_LIST
                                0: AST_ASSIGN
                                    var: AST_VAR
                                        name: "converted_string"
                                    expr: AST_VAR
                                        name: "str"
                    13: AST_FOREACH
                        expr: AST_PROP
                            expr: AST_VAR
                                name: "this"
                            prop: "never_allowed_str"
                        value: AST_VAR
                            name: "val"
                        key: AST_VAR
                            name: "key"
                        stmts: AST_STMT_LIST
                            0: AST_ASSIGN
                                var: AST_VAR
                                    name: "str"
                                expr: AST_CALL
                                    expr: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "str_replace"
                                    args: AST_ARG_LIST
                                        0: AST_VAR
                                            name: "key"
                                        1: AST_VAR
                                            name: "val"
                                        2: AST_VAR
                                            name: "str"
                    14: AST_FOREACH
                        expr: AST_PROP
                            expr: AST_VAR
                                name: "this"
                            prop: "never_allowed_regex"
                        value: AST_VAR
                            name: "val"
                        key: AST_VAR
                            name: "key"
                        stmts: AST_STMT_LIST
                            0: AST_ASSIGN
                                var: AST_VAR
                                    name: "str"
                                expr: AST_CALL
                                    expr: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "preg_replace"
                                    args: AST_ARG_LIST
                                        0: AST_BINARY_OP
                                            flags: BINARY_CONCAT (8)
                                            left: AST_BINARY_OP
                                                flags: BINARY_CONCAT (8)
                                                left: "#"
                                                right: AST_VAR
                                                    name: "key"
                                            right: "#i"
                                        1: AST_VAR
                                            name: "val"
                                        2: AST_VAR
                                            name: "str"
                    15: AST_ASSIGN
                        var: AST_VAR
                            name: "str"
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "str_replace"
                            args: AST_ARG_LIST
                                0: AST_ARRAY
                                    flags: ARRAY_SYNTAX_LONG (2)
                                    0: AST_ARRAY_ELEM
                                        flags: 0
                                        value: "<?php"
                                        key: null
                                    1: AST_ARRAY_ELEM
                                        flags: 0
                                        value: "<?PHP"
                                        key: null
                                    2: AST_ARRAY_ELEM
                                        flags: 0
                                        value: "<?"
                                        key: null
                                    3: AST_ARRAY_ELEM
                                        flags: 0
                                        value: AST_BINARY_OP
                                            flags: BINARY_CONCAT (8)
                                            left: "?"
                                            right: ">"
                                        key: null
                                1: AST_ARRAY
                                    flags: ARRAY_SYNTAX_LONG (2)
                                    0: AST_ARRAY_ELEM
                                        flags: 0
                                        value: "&lt;?php"
                                        key: null
                                    1: AST_ARRAY_ELEM
                                        flags: 0
                                        value: "&lt;?PHP"
                                        key: null
                                    2: AST_ARRAY_ELEM
                                        flags: 0
                                        value: "&lt;?"
                                        key: null
                                    3: AST_ARRAY_ELEM
                                        flags: 0
                                        value: "?&gt;"
                                        key: null
                                2: AST_VAR
                                    name: "str"
                    16: AST_ASSIGN
                        var: AST_VAR
                            name: "words"
                        expr: AST_ARRAY
                            flags: ARRAY_SYNTAX_LONG (2)
                            0: AST_ARRAY_ELEM
                                flags: 0
                                value: "javascript"
                                key: null
                            1: AST_ARRAY_ELEM
                                flags: 0
                                value: "expression"
                                key: null
                            2: AST_ARRAY_ELEM
                                flags: 0
                                value: "vbscript"
                                key: null
                            3: AST_ARRAY_ELEM
                                flags: 0
                                value: "script"
                                key: null
                            4: AST_ARRAY_ELEM
                                flags: 0
                                value: "applet"
                                key: null
                            5: AST_ARRAY_ELEM
                                flags: 0
                                value: "alert"
                                key: null
                            6: AST_ARRAY_ELEM
                                flags: 0
                                value: "document"
                                key: null
                            7: AST_ARRAY_ELEM
                                flags: 0
                                value: "write"
                                key: null
                            8: AST_ARRAY_ELEM
                                flags: 0
                                value: "cookie"
                                key: null
                            9: AST_ARRAY_ELEM
                                flags: 0
                                value: "window"
                                key: null
                    17: AST_FOREACH
                        expr: AST_VAR
                            name: "words"
                        value: AST_VAR
                            name: "word"
                        key: null
                        stmts: AST_STMT_LIST
                            0: AST_ASSIGN
                                var: AST_VAR
                                    name: "temp"
                                expr: ""
                            1: AST_FOR
                                init: AST_EXPR_LIST
                                    0: AST_ASSIGN
                                        var: AST_VAR
                                            name: "i"
                                        expr: 0
                                cond: AST_EXPR_LIST
                                    0: AST_BINARY_OP
                                        flags: BINARY_IS_SMALLER (19)
                                        left: AST_VAR
                                            name: "i"
                                        right: AST_CALL
                                            expr: AST_NAME
                                                flags: NAME_NOT_FQ (1)
                                                name: "strlen"
                                            args: AST_ARG_LIST
                                                0: AST_VAR
                                                    name: "word"
                                loop: AST_EXPR_LIST
                                    0: AST_POST_INC
                                        var: AST_VAR
                                            name: "i"
                                stmts: AST_STMT_LIST
                                    0: AST_ASSIGN_OP
                                        flags: BINARY_CONCAT (8)
                                        var: AST_VAR
                                            name: "temp"
                                        expr: AST_BINARY_OP
                                            flags: BINARY_CONCAT (8)
                                            left: AST_CALL
                                                expr: AST_NAME
                                                    flags: NAME_NOT_FQ (1)
                                                    name: "substr"
                                                args: AST_ARG_LIST
                                                    0: AST_VAR
                                                        name: "word"
                                                    1: AST_VAR
                                                        name: "i"
                                                    2: 1
                                            right: "\s*"
                            2: AST_ASSIGN
                                var: AST_VAR
                                    name: "str"
                                expr: AST_CALL
                                    expr: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "preg_replace_callback"
                                    args: AST_ARG_LIST
                                        0: AST_BINARY_OP
                                            flags: BINARY_CONCAT (8)
                                            left: AST_BINARY_OP
                                                flags: BINARY_CONCAT (8)
                                                left: "#("
                                                right: AST_CALL
                                                    expr: AST_NAME
                                                        flags: NAME_NOT_FQ (1)
                                                        name: "substr"
                                                    args: AST_ARG_LIST
                                                        0: AST_VAR
                                                            name: "temp"
                                                        1: 0
                                                        2: AST_UNARY_OP
                                                            flags: UNARY_MINUS (262)
                                                            expr: 3
                                            right: ")(\W)#is"
                                        1: AST_ARRAY
                                            flags: ARRAY_SYNTAX_LONG (2)
                                            0: AST_ARRAY_ELEM
                                                flags: 0
                                                value: AST_VAR
                                                    name: "this"
                                                key: null
                                            1: AST_ARRAY_ELEM
                                                flags: 0
                                                value: "_compact_exploded_words"
                                                key: null
                                        2: AST_VAR
                                            name: "str"
                    18: AST_DO_WHILE
                        stmts: AST_STMT_LIST
                            0: AST_ASSIGN
                                var: AST_VAR
                                    name: "original"
                                expr: AST_VAR
                                    name: "str"
                            1: AST_IF
                                0: AST_IF_ELEM
                                    cond: AST_CALL
                                        expr: AST_NAME
                                            flags: NAME_NOT_FQ (1)
                                            name: "preg_match"
                                        args: AST_ARG_LIST
                                            0: "/<a/i"
                                            1: AST_VAR
                                                name: "str"
                                    stmts: AST_STMT_LIST
                                        0: AST_ASSIGN
                                            var: AST_VAR
                                                name: "str"
                                            expr: AST_CALL
                                                expr: AST_NAME
                                                    flags: NAME_NOT_FQ (1)
                                                    name: "preg_replace_callback"
                                                args: AST_ARG_LIST
                                                    0: "#<a.*(>|<|$)#si"
                                                    1: AST_ARRAY
                                                        flags: ARRAY_SYNTAX_LONG (2)
                                                        0: AST_ARRAY_ELEM
                                                            flags: 0
                                                            value: AST_VAR
                                                                name: "this"
                                                            key: null
                                                        1: AST_ARRAY_ELEM
                                                            flags: 0
                                                            value: "_js_link_removal"
                                                            key: null
                                                    2: AST_VAR
                                                        name: "str"
                            2: AST_IF
                                0: AST_IF_ELEM
                                    cond: AST_CALL
                                        expr: AST_NAME
                                            flags: NAME_NOT_FQ (1)
                                            name: "preg_match"
                                        args: AST_ARG_LIST
                                            0: "/<img/i"
                                            1: AST_VAR
                                                name: "str"
                                    stmts: AST_STMT_LIST
                                        0: AST_ASSIGN
                                            var: AST_VAR
                                                name: "str"
                                            expr: AST_CALL
                                                expr: AST_NAME
                                                    flags: NAME_NOT_FQ (1)
                                                    name: "preg_replace_callback"
                                                args: AST_ARG_LIST
                                                    0: "#<img.*(>|<|$)#si"
                                                    1: AST_ARRAY
                                                        flags: ARRAY_SYNTAX_LONG (2)
                                                        0: AST_ARRAY_ELEM
                                                            flags: 0
                                                            value: AST_VAR
                                                                name: "this"
                                                            key: null
                                                        1: AST_ARRAY_ELEM
                                                            flags: 0
                                                            value: "_js_img_removal"
                                                            key: null
                                                    2: AST_VAR
                                                        name: "str"
                            3: AST_IF
                                0: AST_IF_ELEM
                                    cond: AST_BINARY_OP
                                        flags: BINARY_BOOL_OR (258)
                                        left: AST_CALL
                                            expr: AST_NAME
                                                flags: NAME_NOT_FQ (1)
                                                name: "preg_match"
                                            args: AST_ARG_LIST
                                                0: "/script/i"
                                                1: AST_VAR
                                                    name: "str"
                                        right: AST_CALL
                                            expr: AST_NAME
                                                flags: NAME_NOT_FQ (1)
                                                name: "preg_match"
                                            args: AST_ARG_LIST
                                                0: "/xss/i"
                                                1: AST_VAR
                                                    name: "str"
                                    stmts: AST_STMT_LIST
                                        0: AST_ASSIGN
                                            var: AST_VAR
                                                name: "str"
                                            expr: AST_CALL
                                                expr: AST_NAME
                                                    flags: NAME_NOT_FQ (1)
                                                    name: "preg_replace"
                                                args: AST_ARG_LIST
                                                    0: "#</*(script|xss).*?\>#si"
                                                    1: ""
                                                    2: AST_VAR
                                                        name: "str"
                        cond: AST_BINARY_OP
                            flags: BINARY_IS_NOT_EQUAL (18)
                            left: AST_VAR
                                name: "original"
                            right: AST_VAR
                                name: "str"
                    19: AST_UNSET
                        var: AST_VAR
                            name: "original"
                    20: AST_ASSIGN
                        var: AST_VAR
                            name: "event_handlers"
                        expr: AST_ARRAY
                            flags: ARRAY_SYNTAX_LONG (2)
                            0: AST_ARRAY_ELEM
                                flags: 0
                                value: "on\w*"
                                key: null
                            1: AST_ARRAY_ELEM
                                flags: 0
                                value: "xmlns"
                                key: null
                    21: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_IS_IDENTICAL (15)
                                left: AST_VAR
                                    name: "is_image"
                                right: AST_CONST
                                    name: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "TRUE"
                            stmts: AST_STMT_LIST
                                0: AST_UNSET
                                    var: AST_DIM
                                        expr: AST_VAR
                                            name: "event_handlers"
                                        dim: AST_CALL
                                            expr: AST_NAME
                                                flags: NAME_NOT_FQ (1)
                                                name: "array_search"
                                            args: AST_ARG_LIST
                                                0: "xmlns"
                                                1: AST_VAR
                                                    name: "event_handlers"
                    22: AST_ASSIGN
                        var: AST_VAR
                            name: "str"
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "preg_replace"
                            args: AST_ARG_LIST
                                0: AST_BINARY_OP
                                    flags: BINARY_CONCAT (8)
                                    left: AST_BINARY_OP
                                        flags: BINARY_CONCAT (8)
                                        left: "#<([^><]+)("
                                        right: AST_CALL
                                            expr: AST_NAME
                                                flags: NAME_NOT_FQ (1)
                                                name: "implode"
                                            args: AST_ARG_LIST
                                                0: "|"
                                                1: AST_VAR
                                                    name: "event_handlers"
                                    right: ")(\s*=\s*[^><]*)([><]*)#i"
                                1: "<\1\4"
                                2: AST_VAR
                                    name: "str"
                    23: AST_ASSIGN
                        var: AST_VAR
                            name: "naughty"
                        expr: "alert|applet|audio|basefont|base|behavior|bgsound|blink|body|embed|expression|form|frameset|frame|head|html|ilayer|iframe|input|layer|link|meta|object|plaintext|style|script|textarea|title|video|xml|xss"
                    24: AST_ASSIGN
                        var: AST_VAR
                            name: "str"
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "preg_replace_callback"
                            args: AST_ARG_LIST
                                0: AST_BINARY_OP
                                    flags: BINARY_CONCAT (8)
                                    left: AST_BINARY_OP
                                        flags: BINARY_CONCAT (8)
                                        left: "#<(/*\s*)("
                                        right: AST_VAR
                                            name: "naughty"
                                    right: ")([^><]*)([><]*)#is"
                                1: AST_ARRAY
                                    flags: ARRAY_SYNTAX_LONG (2)
                                    0: AST_ARRAY_ELEM
                                        flags: 0
                                        value: AST_VAR
                                            name: "this"
                                        key: null
                                    1: AST_ARRAY_ELEM
                                        flags: 0
                                        value: "_sanitize_naughty_html"
                                        key: null
                                2: AST_VAR
                                    name: "str"
                    25: AST_ASSIGN
                        var: AST_VAR
                            name: "str"
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "preg_replace"
                            args: AST_ARG_LIST
                                0: "#(alert|cmd|passthru|eval|exec|expression|system|fopen|fsockopen|file|file_get_contents|readfile|unlink)(\s*)\((.*?)\)#si"
                                1: "\1\2&#40;\3&#41;"
                                2: AST_VAR
                                    name: "str"
                    26: AST_FOREACH
                        expr: AST_PROP
                            expr: AST_VAR
                                name: "this"
                            prop: "never_allowed_str"
                        value: AST_VAR
                            name: "val"
                        key: AST_VAR
                            name: "key"
                        stmts: AST_STMT_LIST
                            0: AST_ASSIGN
                                var: AST_VAR
                                    name: "str"
                                expr: AST_CALL
                                    expr: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "str_replace"
                                    args: AST_ARG_LIST
                                        0: AST_VAR
                                            name: "key"
                                        1: AST_VAR
                                            name: "val"
                                        2: AST_VAR
                                            name: "str"
                    27: AST_FOREACH
                        expr: AST_PROP
                            expr: AST_VAR
                                name: "this"
                            prop: "never_allowed_regex"
                        value: AST_VAR
                            name: "val"
                        key: AST_VAR
                            name: "key"
                        stmts: AST_STMT_LIST
                            0: AST_ASSIGN
                                var: AST_VAR
                                    name: "str"
                                expr: AST_CALL
                                    expr: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "preg_replace"
                                    args: AST_ARG_LIST
                                        0: AST_BINARY_OP
                                            flags: BINARY_CONCAT (8)
                                            left: AST_BINARY_OP
                                                flags: BINARY_CONCAT (8)
                                                left: "#"
                                                right: AST_VAR
                                                    name: "key"
                                            right: "#i"
                                        1: AST_VAR
                                            name: "val"
                                        2: AST_VAR
                                            name: "str"
                    28: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_IS_IDENTICAL (15)
                                left: AST_VAR
                                    name: "is_image"
                                right: AST_CONST
                                    name: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "TRUE"
                            stmts: AST_STMT_LIST
                                0: AST_IF
                                    0: AST_IF_ELEM
                                        cond: AST_BINARY_OP
                                            flags: BINARY_IS_EQUAL (17)
                                            left: AST_VAR
                                                name: "str"
                                            right: AST_VAR
                                                name: "converted_string"
                                        stmts: AST_STMT_LIST
                                            0: AST_RETURN
                                                expr: AST_CONST
                                                    name: AST_NAME
                                                        flags: NAME_NOT_FQ (1)
                                                        name: "TRUE"
                                    1: AST_IF_ELEM
                                        cond: null
                                        stmts: AST_STMT_LIST
                                            0: AST_RETURN
                                                expr: AST_CONST
                                                    name: AST_NAME
                                                        flags: NAME_NOT_FQ (1)
                                                        name: "FALSE"
                    29: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_IS_NOT_EQUAL (18)
                                left: AST_VAR
                                    name: "converted_string"
                                right: AST_VAR
                                    name: "str"
                            stmts: AST_STMT_LIST
                                0: AST_ASSIGN
                                    var: AST_VAR
                                        name: "str"
                                    expr: AST_METHOD_CALL
                                        expr: AST_VAR
                                            name: "this"
                                        method: "xss_clean"
                                        args: AST_ARG_LIST
                                            0: AST_VAR
                                                name: "str"
                                            1: AST_VAR
                                                name: "is_image"
                                            2: AST_PRE_INC
                                                var: AST_VAR
                                                    name: "loops"
                                            3: AST_VAR
                                                name: "converted_string"
                    30: AST_CALL
                        expr: AST_NAME
                            flags: NAME_NOT_FQ (1)
                            name: "log_message"
                        args: AST_ARG_LIST
                            0: "debug"
                            1: "XSS Filtering completed"
                    31: AST_RETURN
                        expr: AST_VAR
                            name: "str"
                returnType: null
                __declId: 13
            21: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "xss_hash"
                docComment: "/**
                	 * Random Hash for protecting URLs
                	 *
                	 * @access	public
                	 * @return	string
                	 */"
                params: AST_PARAM_LIST
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_IS_EQUAL (17)
                                left: AST_PROP
                                    expr: AST_VAR
                                        name: "this"
                                    prop: "xss_hash"
                                right: ""
                            stmts: AST_STMT_LIST
                                0: AST_IF
                                    0: AST_IF_ELEM
                                        cond: AST_BINARY_OP
                                            flags: BINARY_IS_GREATER_OR_EQUAL (257)
                                            left: AST_CALL
                                                expr: AST_NAME
                                                    flags: NAME_NOT_FQ (1)
                                                    name: "phpversion"
                                                args: AST_ARG_LIST
                                            right: 4.2
                                        stmts: AST_STMT_LIST
                                            0: AST_CALL
                                                expr: AST_NAME
                                                    flags: NAME_NOT_FQ (1)
                                                    name: "mt_srand"
                                                args: AST_ARG_LIST
                                    1: AST_IF_ELEM
                                        cond: null
                                        stmts: AST_STMT_LIST
                                            0: AST_CALL
                                                expr: AST_NAME
                                                    flags: NAME_NOT_FQ (1)
                                                    name: "mt_srand"
                                                args: AST_ARG_LIST
                                                    0: AST_BINARY_OP
                                                        flags: BINARY_BITWISE_AND (10)
                                                        left: AST_CALL
                                                            expr: AST_NAME
                                                                flags: NAME_NOT_FQ (1)
                                                                name: "hexdec"
                                                            args: AST_ARG_LIST
                                                                0: AST_CALL
                                                                    expr: AST_NAME
                                                                        flags: NAME_NOT_FQ (1)
                                                                        name: "substr"
                                                                    args: AST_ARG_LIST
                                                                        0: AST_CALL
                                                                            expr: AST_NAME
                                                                                flags: NAME_NOT_FQ (1)
                                                                                name: "md5"
                                                                            args: AST_ARG_LIST
                                                                                0: AST_CALL
                                                                                    expr: AST_NAME
                                                                                        flags: NAME_NOT_FQ (1)
                                                                                        name: "microtime"
                                                                                    args: AST_ARG_LIST
                                                                        1: AST_UNARY_OP
                                                                            flags: UNARY_MINUS (262)
                                                                            expr: 8
                                                        right: 2147483647
                                1: AST_ASSIGN
                                    var: AST_PROP
                                        expr: AST_VAR
                                            name: "this"
                                        prop: "xss_hash"
                                    expr: AST_CALL
                                        expr: AST_NAME
                                            flags: NAME_NOT_FQ (1)
                                            name: "md5"
                                        args: AST_ARG_LIST
                                            0: AST_BINARY_OP
                                                flags: BINARY_ADD (1)
                                                left: AST_CALL
                                                    expr: AST_NAME
                                                        flags: NAME_NOT_FQ (1)
                                                        name: "time"
                                                    args: AST_ARG_LIST
                                                right: AST_CALL
                                                    expr: AST_NAME
                                                        flags: NAME_NOT_FQ (1)
                                                        name: "mt_rand"
                                                    args: AST_ARG_LIST
                                                        0: 0
                                                        1: 1999999999
                    1: AST_RETURN
                        expr: AST_PROP
                            expr: AST_VAR
                                name: "this"
                            prop: "xss_hash"
                returnType: null
                __declId: 14
            22: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "_compact_exploded_words"
                docComment: "/**
                	 * Compact Exploded Words
                	 *
                	 * Callback function for xss_clean() to remove whitespace from
                	 * things like j a v a s c r i p t
                	 *
                	 * @access	public
                	 * @param	type
                	 * @return	type
                	 */"
                params: AST_PARAM_LIST
                    0: AST_PARAM
                        flags: 0
                        type: null
                        name: "matches"
                        default: null
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_RETURN
                        expr: AST_BINARY_OP
                            flags: BINARY_CONCAT (8)
                            left: AST_CALL
                                expr: AST_NAME
                                    flags: NAME_NOT_FQ (1)
                                    name: "preg_replace"
                                args: AST_ARG_LIST
                                    0: "/\s+/s"
                                    1: ""
                                    2: AST_DIM
                                        expr: AST_VAR
                                            name: "matches"
                                        dim: 1
                            right: AST_DIM
                                expr: AST_VAR
                                    name: "matches"
                                dim: 2
                returnType: null
                __declId: 15
            23: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "_sanitize_naughty_html"
                docComment: "/**
                	 * Sanitize Naughty HTML
                	 *
                	 * Callback function for xss_clean() to remove naughty HTML elements
                	 *
                	 * @access	private
                	 * @param	array
                	 * @return	string
                	 */"
                params: AST_PARAM_LIST
                    0: AST_PARAM
                        flags: 0
                        type: null
                        name: "matches"
                        default: null
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_ASSIGN
                        var: AST_VAR
                            name: "str"
                        expr: AST_BINARY_OP
                            flags: BINARY_CONCAT (8)
                            left: AST_BINARY_OP
                                flags: BINARY_CONCAT (8)
                                left: AST_BINARY_OP
                                    flags: BINARY_CONCAT (8)
                                    left: "&lt;"
                                    right: AST_DIM
                                        expr: AST_VAR
                                            name: "matches"
                                        dim: 1
                                right: AST_DIM
                                    expr: AST_VAR
                                        name: "matches"
                                    dim: 2
                            right: AST_DIM
                                expr: AST_VAR
                                    name: "matches"
                                dim: 3
                    1: AST_ASSIGN_OP
                        flags: BINARY_CONCAT (8)
                        var: AST_VAR
                            name: "str"
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "str_replace"
                            args: AST_ARG_LIST
                                0: AST_ARRAY
                                    flags: ARRAY_SYNTAX_LONG (2)
                                    0: AST_ARRAY_ELEM
                                        flags: 0
                                        value: ">"
                                        key: null
                                    1: AST_ARRAY_ELEM
                                        flags: 0
                                        value: "<"
                                        key: null
                                1: AST_ARRAY
                                    flags: ARRAY_SYNTAX_LONG (2)
                                    0: AST_ARRAY_ELEM
                                        flags: 0
                                        value: "&gt;"
                                        key: null
                                    1: AST_ARRAY_ELEM
                                        flags: 0
                                        value: "&lt;"
                                        key: null
                                2: AST_DIM
                                    expr: AST_VAR
                                        name: "matches"
                                    dim: 4
                    2: AST_RETURN
                        expr: AST_VAR
                            name: "str"
                returnType: null
                __declId: 16
            24: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "_js_link_removal"
                docComment: "/**
                	 * JS Link Removal
                	 *
                	 * Callback function for xss_clean() to sanitize links
                	 * This limits the PCRE backtracks, making it more performance friendly
                	 * and prevents PREG_BACKTRACK_LIMIT_ERROR from being triggered in
                	 * PHP 5.2+ on link-heavy strings
                	 *
                	 * @access	private
                	 * @param	array
                	 * @return	string
                	 */"
                params: AST_PARAM_LIST
                    0: AST_PARAM
                        flags: 0
                        type: null
                        name: "match"
                        default: null
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_RETURN
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "preg_replace"
                            args: AST_ARG_LIST
                                0: "#href=.*?(alert\(|alert&\#40;|javascript\:|charset\=|window\.|document\.|\.cookie|<script|<xss|base64\s*,)#si"
                                1: ""
                                2: AST_DIM
                                    expr: AST_VAR
                                        name: "match"
                                    dim: 0
                returnType: null
                __declId: 17
            25: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "_js_img_removal"
                docComment: "/**
                	 * JS Image Removal
                	 *
                	 * Callback function for xss_clean() to sanitize image tags
                	 * This limits the PCRE backtracks, making it more performance friendly
                	 * and prevents PREG_BACKTRACK_LIMIT_ERROR from being triggered in
                	 * PHP 5.2+ on image tag heavy strings
                	 *
                	 * @access	private
                	 * @param	array
                	 * @return	string
                	 */"
                params: AST_PARAM_LIST
                    0: AST_PARAM
                        flags: 0
                        type: null
                        name: "match"
                        default: null
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_RETURN
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "preg_replace"
                            args: AST_ARG_LIST
                                0: "#src=.*?(alert\(|alert&\#40;|javascript\:|charset\=|window\.|document\.|\.cookie|<script|<xss|base64\s*,)#si"
                                1: ""
                                2: AST_DIM
                                    expr: AST_VAR
                                        name: "match"
                                    dim: 0
                returnType: null
                __declId: 18
            26: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "_convert_attribute"
                docComment: "/**
                	 * Attribute Conversion
                	 *
                	 * Used as a callback for XSS Clean
                	 *
                	 * @access	public
                	 * @param	array
                	 * @return	string
                	 */"
                params: AST_PARAM_LIST
                    0: AST_PARAM
                        flags: 0
                        type: null
                        name: "match"
                        default: null
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_RETURN
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "str_replace"
                            args: AST_ARG_LIST
                                0: AST_ARRAY
                                    flags: ARRAY_SYNTAX_LONG (2)
                                    0: AST_ARRAY_ELEM
                                        flags: 0
                                        value: ">"
                                        key: null
                                    1: AST_ARRAY_ELEM
                                        flags: 0
                                        value: "<"
                                        key: null
                                1: AST_ARRAY
                                    flags: ARRAY_SYNTAX_LONG (2)
                                    0: AST_ARRAY_ELEM
                                        flags: 0
                                        value: "&gt;"
                                        key: null
                                    1: AST_ARRAY_ELEM
                                        flags: 0
                                        value: "&lt;"
                                        key: null
                                2: AST_DIM
                                    expr: AST_VAR
                                        name: "match"
                                    dim: 0
                returnType: null
                __declId: 19
            27: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "_html_entity_decode_callback"
                docComment: "/**
                	 * HTML Entity Decode Callback
                	 *
                	 * Used as a callback for XSS Clean
                	 *
                	 * @access	public
                	 * @param	array
                	 * @return	string
                	 */"
                params: AST_PARAM_LIST
                    0: AST_PARAM
                        flags: 0
                        type: null
                        name: "match"
                        default: null
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_GLOBAL
                        var: AST_VAR
                            name: "CFG"
                    1: AST_ASSIGN
                        var: AST_VAR
                            name: "charset"
                        expr: AST_METHOD_CALL
                            expr: AST_VAR
                                name: "CFG"
                            method: "item"
                            args: AST_ARG_LIST
                                0: "charset"
                    2: AST_RETURN
                        expr: AST_METHOD_CALL
                            expr: AST_VAR
                                name: "this"
                            method: "_html_entity_decode"
                            args: AST_ARG_LIST
                                0: AST_DIM
                                    expr: AST_VAR
                                        name: "match"
                                    dim: 0
                                1: AST_CALL
                                    expr: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "strtoupper"
                                    args: AST_ARG_LIST
                                        0: AST_VAR
                                            name: "charset"
                returnType: null
                __declId: 20
            28: AST_METHOD
                flags: MODIFIER_PUBLIC (256)
                name: "_html_entity_decode"
                docComment: "/**
                	 * HTML Entities Decode
                	 *
                	 * This function is a replacement for html_entity_decode()
                	 *
                	 * In some versions of PHP the native function does not work
                	 * when UTF-8 is the specified character set, so this gives us
                	 * a work-around.  More info here:
                	 * http://bugs.php.net/bug.php?id=25670
                	 *
                	 * @access	private
                	 * @param	string
                	 * @param	string
                	 * @return	string
                	 */"
                params: AST_PARAM_LIST
                    0: AST_PARAM
                        flags: 0
                        type: null
                        name: "str"
                        default: null
                    1: AST_PARAM
                        flags: 0
                        type: null
                        name: "charset"
                        default: "UTF-8"
                uses: null
                stmts: AST_STMT_LIST
                    0: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_IS_IDENTICAL (15)
                                left: AST_CALL
                                    expr: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "stristr"
                                    args: AST_ARG_LIST
                                        0: AST_VAR
                                            name: "str"
                                        1: "&"
                                right: AST_CONST
                                    name: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "FALSE"
                            stmts: AST_STMT_LIST
                                0: AST_RETURN
                                    expr: AST_VAR
                                        name: "str"
                    1: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_BOOL_AND (259)
                                left: AST_CALL
                                    expr: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "function_exists"
                                    args: AST_ARG_LIST
                                        0: "html_entity_decode"
                                right: AST_BINARY_OP
                                    flags: BINARY_BOOL_OR (258)
                                    left: AST_BINARY_OP
                                        flags: BINARY_IS_NOT_EQUAL (18)
                                        left: AST_CALL
                                            expr: AST_NAME
                                                flags: NAME_NOT_FQ (1)
                                                name: "strtolower"
                                            args: AST_ARG_LIST
                                                0: AST_VAR
                                                    name: "charset"
                                        right: "utf-8"
                                    right: AST_CALL
                                        expr: AST_NAME
                                            flags: NAME_NOT_FQ (1)
                                            name: "version_compare"
                                        args: AST_ARG_LIST
                                            0: AST_CALL
                                                expr: AST_NAME
                                                    flags: NAME_NOT_FQ (1)
                                                    name: "phpversion"
                                                args: AST_ARG_LIST
                                            1: "5.0.0"
                                            2: ">="
                            stmts: AST_STMT_LIST
                                0: AST_ASSIGN
                                    var: AST_VAR
                                        name: "str"
                                    expr: AST_CALL
                                        expr: AST_NAME
                                            flags: NAME_NOT_FQ (1)
                                            name: "html_entity_decode"
                                        args: AST_ARG_LIST
                                            0: AST_VAR
                                                name: "str"
                                            1: AST_CONST
                                                name: AST_NAME
                                                    flags: NAME_NOT_FQ (1)
                                                    name: "ENT_COMPAT"
                                            2: AST_VAR
                                                name: "charset"
                                1: AST_ASSIGN
                                    var: AST_VAR
                                        name: "str"
                                    expr: AST_CALL
                                        expr: AST_NAME
                                            flags: NAME_NOT_FQ (1)
                                            name: "preg_replace"
                                        args: AST_ARG_LIST
                                            0: "~&#x(0*[0-9a-f]{2,5})~ei"
                                            1: "chr(hexdec("\1"))"
                                            2: AST_VAR
                                                name: "str"
                                2: AST_RETURN
                                    expr: AST_CALL
                                        expr: AST_NAME
                                            flags: NAME_NOT_FQ (1)
                                            name: "preg_replace"
                                        args: AST_ARG_LIST
                                            0: "~&#([0-9]{2,4})~e"
                                            1: "chr(\1)"
                                            2: AST_VAR
                                                name: "str"
                    2: AST_ASSIGN
                        var: AST_VAR
                            name: "str"
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "preg_replace"
                            args: AST_ARG_LIST
                                0: "~&#x(0*[0-9a-f]{2,5});{0,1}~ei"
                                1: "chr(hexdec("\1"))"
                                2: AST_VAR
                                    name: "str"
                    3: AST_ASSIGN
                        var: AST_VAR
                            name: "str"
                        expr: AST_CALL
                            expr: AST_NAME
                                flags: NAME_NOT_FQ (1)
                                name: "preg_replace"
                            args: AST_ARG_LIST
                                0: "~&#([0-9]{2,4});{0,1}~e"
                                1: "chr(\1)"
                                2: AST_VAR
                                    name: "str"
                    4: AST_IF
                        0: AST_IF_ELEM
                            cond: AST_BINARY_OP
                                flags: BINARY_IS_IDENTICAL (15)
                                left: AST_CALL
                                    expr: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "stristr"
                                    args: AST_ARG_LIST
                                        0: AST_VAR
                                            name: "str"
                                        1: "&"
                                right: AST_CONST
                                    name: AST_NAME
                                        flags: NAME_NOT_FQ (1)
                                        name: "FALSE"
                            stmts: AST_STMT_LIST
                                0: AST_ASSIGN
                                    var: AST_VAR
                                        name: "str"
                                    expr: AST_CALL
                                        expr: AST_NAME
                                            flags: NAME_NOT_FQ (1)
                                            name: "strtr"
                                        args: AST_ARG_LIST
                                            0: AST_VAR
                                                name: "str"
                                            1: AST_CALL
                                                expr: AST_NAME
                                                    flags: NAME_NOT_FQ (1)
                                                    name: "array_flip"
                                                args: AST_ARG_LIST
                                                    0: AST_CALL
                                                        expr: AST_NAME
                                                            flags: NAME_NOT_FQ (1)
                                                            name: "get_html_translation_table"
                                                        args: AST_ARG_LIST
                                                            0: AST_CONST
                                                                name: AST_NAME
                                                                    flags: NAME_NOT_FQ (1)
                                                                    name: "HTML_ENTITIES"
                    5: AST_RETURN
                        expr: AST_VAR
                            name: "str"
                returnType: null
                __declId: 21
        __declId: 22