commit eeebd4e5ff3fb6bdce20f1251c038cde59916a3a
Author: Marco Pivetta <ocramius@gmail.com>
Date:   Thu Jan 1 19:37:53 2015 +0100

    #7046 - refactoring code to reduce duplication and improve factory return type checks