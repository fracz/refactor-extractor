    protected function check_security($code) {

        $tokens = token_get_all($code);
        $errors = array();

        foreach ($tokens as $index => $toc) {
            if(is_array($toc) && isset($toc[0])) {

                //var_dump($toc[0]);

                switch($toc[0]){

                    case T_STRING:

                        if(!in_array(strtolower($toc[1]), $this->allowed_calls)){

                            $prevtoc = $tokens[$index-1];

                            if(!isset($prevtoc[1]) || (isset($prevtoc[1]) &&$prevtoc[1]!='->')){
                                $errors[] = $toc[1];
                            }
                        }
                        break;

                    case T_REQUIRE_ONCE:
                    case T_REQUIRE:
                    case T_NEW:
                    case T_RETURN:
                    case T_BREAK:
                    case T_CATCH:
                    case T_CLONE:
                    case T_EXIT:
                    case T_PRINT:
                    case T_GLOBAL:
                    case T_INCLUDE_ONCE:
                    case T_INCLUDE:
                    case T_EVAL:
                    case T_FUNCTION:
                        if(!in_array(strtolower($toc[1]), $this->allowed_calls)){
                            $errors[] = 'illegal call: '.$toc[1];
                        }
                        break;
                }
            }
        }

        return count($errors) ? $errors:false;
    }

    /**
     * [check_syntax description]
     * @param  [type] $code [description]
     * @return [type]       [description]
     */
||||||||||||||||HAS_DOC_COMMENTNO_RETURN_TYPE
(NO_PARAM_TYPENO_PARAM_DEFAULT)
(
    (AST_ASSIGN
        (AST_VAR)
        (AST_CALL
            (
                (AST_VAR))))
    (AST_ASSIGN
        (AST_VAR)
        (AST_ARRAY))
    (AST_FOREACH
        (AST_VAR)
        (AST_VAR)
        (AST_VAR)
        (
            (AST_IF
                (AST_IF_ELEM
                    (AST_BINARY_OP
                        (AST_CALL
                            (
                                (AST_VAR)))
                        (AST_ISSET
                            (AST_DIM
                                (AST_VAR)
                                (SCALAR))))
                    (
                        (AST_SWITCH
                            (AST_DIM
                                (AST_VAR)
                                (SCALAR))
                            (AST_SWITCH_LIST
                                (AST_SWITCH_CASE
                                    (AST_CONST)
                                    (
                                        (AST_IF
                                            (AST_IF_ELEM
                                                (AST_UNARY_OP
                                                    (AST_CALL
                                                        (
                                                            (AST_CALL
                                                                (
                                                                    (AST_DIM
                                                                        (AST_VAR)
                                                                        (SCALAR))))
                                                            (AST_PROP
                                                                (AST_VAR)))))
                                                (
                                                    (AST_ASSIGN
                                                        (AST_VAR)
                                                        (AST_DIM
                                                            (AST_VAR)
                                                            (AST_BINARY_OP
                                                                (AST_VAR)
                                                                (SCALAR))))
                                                    (AST_IF
                                                        (AST_IF_ELEM
                                                            (AST_BINARY_OP
                                                                (AST_UNARY_OP
                                                                    (AST_ISSET
                                                                        (AST_DIM
                                                                            (AST_VAR)
                                                                            (SCALAR))))
                                                                (AST_BINARY_OP
                                                                    (AST_ISSET
                                                                        (AST_DIM
                                                                            (AST_VAR)
                                                                            (SCALAR)))
                                                                    (AST_BINARY_OP
                                                                        (AST_DIM
                                                                            (AST_VAR)
                                                                            (SCALAR))
                                                                        (SCALAR))))
                                                            (
                                                                (AST_ASSIGN
                                                                    (AST_DIM
                                                                        (AST_VAR)
                                                                        (NULL))
                                                                    (AST_DIM
                                                                        (AST_VAR)
                                                                        (SCALAR)))))))))
                                        (AST_BREAK
                                            (NULL))))
                                (AST_SWITCH_CASE
                                    (AST_CONST))
                                (AST_SWITCH_CASE
                                    (AST_CONST))
                                (AST_SWITCH_CASE
                                    (AST_CONST))
                                (AST_SWITCH_CASE
                                    (AST_CONST))
                                (AST_SWITCH_CASE
                                    (AST_CONST))
                                (AST_SWITCH_CASE
                                    (AST_CONST))
                                (AST_SWITCH_CASE
                                    (AST_CONST))
                                (AST_SWITCH_CASE
                                    (AST_CONST))
                                (AST_SWITCH_CASE
                                    (AST_CONST))
                                (AST_SWITCH_CASE
                                    (AST_CONST))
                                (AST_SWITCH_CASE
                                    (AST_CONST))
                                (AST_SWITCH_CASE
                                    (AST_CONST))
                                (AST_SWITCH_CASE
                                    (AST_CONST))
                                (AST_SWITCH_CASE
                                    (AST_CONST)
                                    (
                                        (AST_IF
                                            (AST_IF_ELEM
                                                (AST_UNARY_OP
                                                    (AST_CALL
                                                        (
                                                            (AST_CALL
                                                                (
                                                                    (AST_DIM
                                                                        (AST_VAR)
                                                                        (SCALAR))))
                                                            (AST_PROP
                                                                (AST_VAR)))))
                                                (
                                                    (AST_ASSIGN
                                                        (AST_DIM
                                                            (AST_VAR)
                                                            (NULL))
                                                        (AST_BINARY_OP
                                                            (SCALAR)
                                                            (AST_DIM
                                                                (AST_VAR)
                                                                (SCALAR)))))))
                                        (AST_BREAK
                                            (NULL)))))))))))
    (AST_RETURN
        (AST_CONDITIONAL
            (AST_CALL
                (
                    (AST_VAR)))
            (AST_VAR)
            (AST_CONST))))||||||||