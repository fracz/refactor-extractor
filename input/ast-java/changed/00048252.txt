@Test
public void shouldFetchAndIterateOverKeyRange() throws Exception {
    cachingStore.put("a", "0001", 0);
    cachingStore.put("aa", "0002", 0);
    cachingStore.put("a", "0003", 1);
    cachingStore.put("aa", "0004", 1);
    cachingStore.put("a", "0005", 60000);
    assertThat(toList(cachingStore.fetch("a", "a", 0, Long.MAX_VALUE)), equalTo(Utils.mkList(windowedPair("a", "0001", 0), windowedPair("a", "0003", 1), windowedPair("a", "0005", 60000L))));
    assertThat(toList(cachingStore.fetch("aa", "aa", 0, Long.MAX_VALUE)), equalTo(Utils.mkList(windowedPair("aa", "0002", 0), windowedPair("aa", "0004", 1))));
    assertThat(toList(cachingStore.fetch("a", "aa", 0, Long.MAX_VALUE)), equalTo(Utils.mkList(windowedPair("a", "0001", 0), windowedPair("a", "0003", 1), windowedPair("aa", "0002", 0), windowedPair("aa", "0004", 1), windowedPair("a", "0005", 60000L))));
}||||||||@Test
public void shouldFetchAndIterateOverKeyRange() throws Exception {
    cachingStore.put(bytesKey("a"), bytesValue("0001"), 0);
    cachingStore.put(bytesKey("aa"), bytesValue("0002"), 0);
    cachingStore.put(bytesKey("a"), bytesValue("0003"), 1);
    cachingStore.put(bytesKey("aa"), bytesValue("0004"), 1);
    cachingStore.put(bytesKey("a"), bytesValue("0005"), 60000);
    verifyKeyValueList(Utils.mkList(windowedPair("a", "0001", 0), windowedPair("a", "0003", 1), windowedPair("a", "0005", 60000L)), toList(cachingStore.fetch(bytesKey("a"), bytesKey("a"), 0, Long.MAX_VALUE)));
    verifyKeyValueList(Utils.mkList(windowedPair("aa", "0002", 0), windowedPair("aa", "0004", 1)), toList(cachingStore.fetch(bytesKey("aa"), bytesKey("aa"), 0, Long.MAX_VALUE)));
    verifyKeyValueList(Utils.mkList(windowedPair("a", "0001", 0), windowedPair("a", "0003", 1), windowedPair("aa", "0002", 0), windowedPair("aa", "0004", 1), windowedPair("a", "0005", 60000L)), toList(cachingStore.fetch(bytesKey("a"), bytesKey("aa"), 0, Long.MAX_VALUE)));
}||||||||(MethodDeclaration
	(BlockStmt
		(ExpressionStmt
			(MethodCallExpr
				StringLiteralExpr
				StringLiteralExpr
				(IntegerLiteralExpr
				)
				SimpleName
				NameExpr
					SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				StringLiteralExpr
				StringLiteralExpr
				(IntegerLiteralExpr
				)
				SimpleName
				NameExpr
					SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				StringLiteralExpr
				StringLiteralExpr
				(IntegerLiteralExpr
				)
				SimpleName
				NameExpr
					SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				StringLiteralExpr
				StringLiteralExpr
				(IntegerLiteralExpr
				)
				SimpleName
				NameExpr
					SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				StringLiteralExpr
				StringLiteralExpr
				(IntegerLiteralExpr
				)
				SimpleName
				NameExpr
					SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(MethodCallExpr
					(MethodCallExpr
						StringLiteralExpr
						StringLiteralExpr
						(IntegerLiteralExpr
						)
						(FieldAccessExpr
							SimpleName
							NameExpr
								SimpleName
						)
						SimpleName
						NameExpr
							SimpleName
					)
					SimpleName
				)
				(MethodCallExpr
					(MethodCallExpr
						(MethodCallExpr
							StringLiteralExpr
							StringLiteralExpr
							(IntegerLiteralExpr
							)
							SimpleName
						)
						(MethodCallExpr
							StringLiteralExpr
							StringLiteralExpr
							(IntegerLiteralExpr
							)
							SimpleName
						)
						(MethodCallExpr
							StringLiteralExpr
							StringLiteralExpr
							(LongLiteralExpr
							)
							SimpleName
						)
						SimpleName
						NameExpr
							SimpleName
					)
					SimpleName
				)
				SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(MethodCallExpr
					(MethodCallExpr
						StringLiteralExpr
						StringLiteralExpr
						(IntegerLiteralExpr
						)
						(FieldAccessExpr
							SimpleName
							NameExpr
								SimpleName
						)
						SimpleName
						NameExpr
							SimpleName
					)
					SimpleName
				)
				(MethodCallExpr
					(MethodCallExpr
						(MethodCallExpr
							StringLiteralExpr
							StringLiteralExpr
							(IntegerLiteralExpr
							)
							SimpleName
						)
						(MethodCallExpr
							StringLiteralExpr
							StringLiteralExpr
							(IntegerLiteralExpr
							)
							SimpleName
						)
						SimpleName
						NameExpr
							SimpleName
					)
					SimpleName
				)
				SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(MethodCallExpr
					(MethodCallExpr
						StringLiteralExpr
						StringLiteralExpr
						(IntegerLiteralExpr
						)
						(FieldAccessExpr
							SimpleName
							NameExpr
								SimpleName
						)
						SimpleName
						NameExpr
							SimpleName
					)
					SimpleName
				)
				(MethodCallExpr
					(MethodCallExpr
						(MethodCallExpr
							StringLiteralExpr
							StringLiteralExpr
							(IntegerLiteralExpr
							)
							SimpleName
						)
						(MethodCallExpr
							StringLiteralExpr
							StringLiteralExpr
							(IntegerLiteralExpr
							)
							SimpleName
						)
						(MethodCallExpr
							StringLiteralExpr
							StringLiteralExpr
							(IntegerLiteralExpr
							)
							SimpleName
						)
						(MethodCallExpr
							StringLiteralExpr
							StringLiteralExpr
							(IntegerLiteralExpr
							)
							SimpleName
						)
						(MethodCallExpr
							StringLiteralExpr
							StringLiteralExpr
							(LongLiteralExpr
							)
							SimpleName
						)
						SimpleName
						NameExpr
							SimpleName
					)
					SimpleName
				)
				SimpleName
			)
		)
	)
	(VoidType
	)
	SimpleName
	(ClassOrInterfaceType
		SimpleName
	)
	(MarkerAnnotationExpr
		Name
	)
)
||||||||(MethodDeclaration
	(BlockStmt
		(ExpressionStmt
			(MethodCallExpr
				(MethodCallExpr
					StringLiteralExpr
					SimpleName
				)
				(MethodCallExpr
					StringLiteralExpr
					SimpleName
				)
				(IntegerLiteralExpr
				)
				SimpleName
				NameExpr
					SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(MethodCallExpr
					StringLiteralExpr
					SimpleName
				)
				(MethodCallExpr
					StringLiteralExpr
					SimpleName
				)
				(IntegerLiteralExpr
				)
				SimpleName
				NameExpr
					SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(MethodCallExpr
					StringLiteralExpr
					SimpleName
				)
				(MethodCallExpr
					StringLiteralExpr
					SimpleName
				)
				(IntegerLiteralExpr
				)
				SimpleName
				NameExpr
					SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(MethodCallExpr
					StringLiteralExpr
					SimpleName
				)
				(MethodCallExpr
					StringLiteralExpr
					SimpleName
				)
				(IntegerLiteralExpr
				)
				SimpleName
				NameExpr
					SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(MethodCallExpr
					StringLiteralExpr
					SimpleName
				)
				(MethodCallExpr
					StringLiteralExpr
					SimpleName
				)
				(IntegerLiteralExpr
				)
				SimpleName
				NameExpr
					SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(MethodCallExpr
					(MethodCallExpr
						StringLiteralExpr
						StringLiteralExpr
						(IntegerLiteralExpr
						)
						SimpleName
					)
					(MethodCallExpr
						StringLiteralExpr
						StringLiteralExpr
						(IntegerLiteralExpr
						)
						SimpleName
					)
					(MethodCallExpr
						StringLiteralExpr
						StringLiteralExpr
						(LongLiteralExpr
						)
						SimpleName
					)
					SimpleName
					NameExpr
						SimpleName
				)
				(MethodCallExpr
					(MethodCallExpr
						(MethodCallExpr
							StringLiteralExpr
							SimpleName
						)
						(MethodCallExpr
							StringLiteralExpr
							SimpleName
						)
						(IntegerLiteralExpr
						)
						(FieldAccessExpr
							SimpleName
							NameExpr
								SimpleName
						)
						SimpleName
						NameExpr
							SimpleName
					)
					SimpleName
				)
				SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(MethodCallExpr
					(MethodCallExpr
						StringLiteralExpr
						StringLiteralExpr
						(IntegerLiteralExpr
						)
						SimpleName
					)
					(MethodCallExpr
						StringLiteralExpr
						StringLiteralExpr
						(IntegerLiteralExpr
						)
						SimpleName
					)
					SimpleName
					NameExpr
						SimpleName
				)
				(MethodCallExpr
					(MethodCallExpr
						(MethodCallExpr
							StringLiteralExpr
							SimpleName
						)
						(MethodCallExpr
							StringLiteralExpr
							SimpleName
						)
						(IntegerLiteralExpr
						)
						(FieldAccessExpr
							SimpleName
							NameExpr
								SimpleName
						)
						SimpleName
						NameExpr
							SimpleName
					)
					SimpleName
				)
				SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(MethodCallExpr
					(MethodCallExpr
						StringLiteralExpr
						StringLiteralExpr
						(IntegerLiteralExpr
						)
						SimpleName
					)
					(MethodCallExpr
						StringLiteralExpr
						StringLiteralExpr
						(IntegerLiteralExpr
						)
						SimpleName
					)
					(MethodCallExpr
						StringLiteralExpr
						StringLiteralExpr
						(IntegerLiteralExpr
						)
						SimpleName
					)
					(MethodCallExpr
						StringLiteralExpr
						StringLiteralExpr
						(IntegerLiteralExpr
						)
						SimpleName
					)
					(MethodCallExpr
						StringLiteralExpr
						StringLiteralExpr
						(LongLiteralExpr
						)
						SimpleName
					)
					SimpleName
					NameExpr
						SimpleName
				)
				(MethodCallExpr
					(MethodCallExpr
						(MethodCallExpr
							StringLiteralExpr
							SimpleName
						)
						(MethodCallExpr
							StringLiteralExpr
							SimpleName
						)
						(IntegerLiteralExpr
						)
						(FieldAccessExpr
							SimpleName
							NameExpr
								SimpleName
						)
						SimpleName
						NameExpr
							SimpleName
					)
					SimpleName
				)
				SimpleName
			)
		)
	)
	(VoidType
	)
	SimpleName
	(ClassOrInterfaceType
		SimpleName
	)
	(MarkerAnnotationExpr
		Name
	)
)

