/**
 * Refer to items created earlier in the same batch job.
 *
 * The batch operation API allows you to refer to the URI returned from a
 * created resource in subsequent job descriptions, within the same batch
 * call.
 *
 * Use the +{[JOB ID]}+ special syntax to inject URIs from created resources
 * into JSON strings in subsequent job descriptions.
 */
@Documented
@Test
public void shouldBeAbleToReferToCreatedResource() throws Exception {
    String jsonString = new PrettyJSON().array().object().key("method").value("POST").key("to").value("/node").key("id").value(0).key("body").object().key("age").value(1).endObject().endObject().object().key("method").value("POST").key("to").value("/node").key("id").value(1).key("body").object().key("age").value(12).endObject().endObject().object().key("method").value("POST").key("to").value("{0}/relationships").key("id").value(3).key("body").object().key("to").value("{1}").key("data").object().key("name").value("bob").endObject().key("type").value("KNOWS").endObject().endObject().object().key("method").value("POST").key("to").value("/index/relationship/my_rels/name/bob").key("id").value(4).key("body").value("{3}").endObject().endArray().toString();
    String uri = functionalTestHelper.dataUri() + "batch";
    JaxRsResponse response = RestRequest.req().post(uri, jsonString);
    assertEquals(200, response.getStatus());
    List<Map<String, Object>> results = JsonHelper.jsonToList(response.getEntity());
    assertEquals(4, results.size());
    assertEquals(1, helper.getIndexedRelationships("my_rels", "name", "bob").size());
    gen.get().payload(jsonString).expectedStatus(200).post(uri);
}||||||||/**
 * Refer to items created earlier in the same batch job.
 *
 * The batch operation API allows you to refer to the URI returned from a
 * created resource in subsequent job descriptions, within the same batch
 * call.
 *
 * Use the +{[JOB ID]}+ special syntax to inject URIs from created resources
 * into JSON strings in subsequent job descriptions.
 */
@Documented
@Test
public void shouldBeAbleToReferToCreatedResource() throws Exception {
    String jsonString = new PrettyJSON().array().object().key("method").value("POST").key("to").value("/node").key("id").value(0).key("body").object().key("age").value(1).endObject().endObject().object().key("method").value("POST").key("to").value("/node").key("id").value(1).key("body").object().key("age").value(12).endObject().endObject().object().key("method").value("POST").key("to").value("{0}/relationships").key("id").value(3).key("body").object().key("to").value("{1}").key("data").object().key("name").value("bob").endObject().key("type").value("KNOWS").endObject().endObject().object().key("method").value("POST").key("to").value("/index/relationship/my_rels/name/bob").key("id").value(4).key("body").value("{3}").endObject().endArray().toString();
    batchUri();
    JaxRsResponse response = RestRequest.req().post(batchUri(), jsonString);
    assertEquals(200, response.getStatus());
    List<Map<String, Object>> results = JsonHelper.jsonToList(response.getEntity());
    assertEquals(4, results.size());
    String rels = RestRequest.req().get(getRelationshipIndexUri("my_rels", "name", "bob")).getEntity(String.class);
    assertEquals(1, JsonHelper.jsonToList(rels).size());
    gen.get().payload(jsonString).expectedStatus(200).post(batchUri());
}||||||||(MethodDeclaration
	(BlockStmt
		(ExpressionStmt
			(VariableDeclarationExpr
				(VariableDeclarator
					(MethodCallExpr
						SimpleName
						(MethodCallExpr
							SimpleName
							(MethodCallExpr
								SimpleName
								(MethodCallExpr
									StringLiteralExpr
									SimpleName
									(MethodCallExpr
										StringLiteralExpr
										SimpleName
										(MethodCallExpr
											(IntegerLiteralExpr
											)
											SimpleName
											(MethodCallExpr
												StringLiteralExpr
												SimpleName
												(MethodCallExpr
													StringLiteralExpr
													SimpleName
													(MethodCallExpr
														StringLiteralExpr
														SimpleName
														(MethodCallExpr
															StringLiteralExpr
															SimpleName
															(MethodCallExpr
																StringLiteralExpr
																SimpleName
																(MethodCallExpr
																	SimpleName
																	(MethodCallExpr
																		SimpleName
																		(MethodCallExpr
																			SimpleName
																			(MethodCallExpr
																				StringLiteralExpr
																				SimpleName
																				(MethodCallExpr
																					StringLiteralExpr
																					SimpleName
																					(MethodCallExpr
																						SimpleName
																						(MethodCallExpr
																							StringLiteralExpr
																							SimpleName
																							(MethodCallExpr
																								StringLiteralExpr
																								SimpleName
																								(MethodCallExpr
																									SimpleName
																									(MethodCallExpr
																										StringLiteralExpr
																										SimpleName
																										(MethodCallExpr
																											StringLiteralExpr
																											SimpleName
																											(MethodCallExpr
																												StringLiteralExpr
																												SimpleName
																												(MethodCallExpr
																													SimpleName
																													(MethodCallExpr
																														StringLiteralExpr
																														SimpleName
																														(MethodCallExpr
																															(IntegerLiteralExpr
																															)
																															SimpleName
																															(MethodCallExpr
																																StringLiteralExpr
																																SimpleName
																																(MethodCallExpr
																																	StringLiteralExpr
																																	SimpleName
																																	(MethodCallExpr
																																		StringLiteralExpr
																																		SimpleName
																																		(MethodCallExpr
																																			StringLiteralExpr
																																			SimpleName
																																			(MethodCallExpr
																																				StringLiteralExpr
																																				SimpleName
																																				(MethodCallExpr
																																					SimpleName
																																					(MethodCallExpr
																																						SimpleName
																																						(MethodCallExpr
																																							SimpleName
																																							(MethodCallExpr
																																								(IntegerLiteralExpr
																																								)
																																								SimpleName
																																								(MethodCallExpr
																																									StringLiteralExpr
																																									SimpleName
																																									(MethodCallExpr
																																										SimpleName
																																										(MethodCallExpr
																																											StringLiteralExpr
																																											SimpleName
																																											(MethodCallExpr
																																												(IntegerLiteralExpr
																																												)
																																												SimpleName
																																												(MethodCallExpr
																																													StringLiteralExpr
																																													SimpleName
																																													(MethodCallExpr
																																														StringLiteralExpr
																																														SimpleName
																																														(MethodCallExpr
																																															StringLiteralExpr
																																															SimpleName
																																															(MethodCallExpr
																																																StringLiteralExpr
																																																SimpleName
																																																(MethodCallExpr
																																																	StringLiteralExpr
																																																	SimpleName
																																																	(MethodCallExpr
																																																		SimpleName
																																																		(MethodCallExpr
																																																			SimpleName
																																																			(MethodCallExpr
																																																				SimpleName
																																																				(MethodCallExpr
																																																					(IntegerLiteralExpr
																																																					)
																																																					SimpleName
																																																					(MethodCallExpr
																																																						StringLiteralExpr
																																																						SimpleName
																																																						(MethodCallExpr
																																																							SimpleName
																																																							(MethodCallExpr
																																																								StringLiteralExpr
																																																								SimpleName
																																																								(MethodCallExpr
																																																									(IntegerLiteralExpr
																																																									)
																																																									SimpleName
																																																									(MethodCallExpr
																																																										StringLiteralExpr
																																																										SimpleName
																																																										(MethodCallExpr
																																																											StringLiteralExpr
																																																											SimpleName
																																																											(MethodCallExpr
																																																												StringLiteralExpr
																																																												SimpleName
																																																												(MethodCallExpr
																																																													StringLiteralExpr
																																																													SimpleName
																																																													(MethodCallExpr
																																																														StringLiteralExpr
																																																														SimpleName
																																																														(MethodCallExpr
																																																															SimpleName
																																																															(MethodCallExpr
																																																																SimpleName
																																																																(ObjectCreationExpr
																																																																	(ClassOrInterfaceType
																																																																		SimpleName
																																																																	)
																																																																)
																																																															)
																																																														)
																																																													)
																																																												)
																																																											)
																																																										)
																																																									)
																																																								)
																																																							)
																																																						)
																																																					)
																																																				)
																																																			)
																																																		)
																																																	)
																																																)
																																															)
																																														)
																																													)
																																												)
																																											)
																																										)
																																									)
																																								)
																																							)
																																						)
																																					)
																																				)
																																			)
																																		)
																																	)
																																)
																															)
																														)
																													)
																												)
																											)
																										)
																									)
																								)
																							)
																						)
																					)
																				)
																			)
																		)
																	)
																)
															)
														)
													)
												)
											)
										)
									)
								)
							)
						)
					)
					SimpleName
					(ClassOrInterfaceType
						SimpleName
					)
				)
			)
		)
		(ExpressionStmt
			(VariableDeclarationExpr
				(VariableDeclarator
					(BinaryExpr
						(MethodCallExpr
							SimpleName
							NameExpr
								SimpleName
						)
						StringLiteralExpr
					)
					SimpleName
					(ClassOrInterfaceType
						SimpleName
					)
				)
			)
		)
		(ExpressionStmt
			(VariableDeclarationExpr
				(VariableDeclarator
					(MethodCallExpr
						NameExpr
							SimpleName
						NameExpr
							SimpleName
						SimpleName
						(MethodCallExpr
							SimpleName
							NameExpr
								SimpleName
						)
					)
					SimpleName
					(ClassOrInterfaceType
						SimpleName
					)
				)
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(IntegerLiteralExpr
				)
				(MethodCallExpr
					SimpleName
					NameExpr
						SimpleName
				)
				SimpleName
			)
		)
		(ExpressionStmt
			(VariableDeclarationExpr
				(VariableDeclarator
					(MethodCallExpr
						(MethodCallExpr
							SimpleName
							NameExpr
								SimpleName
						)
						SimpleName
						NameExpr
							SimpleName
					)
					SimpleName
					(ClassOrInterfaceType
						SimpleName
						(ClassOrInterfaceType
							SimpleName
							(ClassOrInterfaceType
								SimpleName
							)
							(ClassOrInterfaceType
								SimpleName
							)
						)
					)
				)
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(IntegerLiteralExpr
				)
				(MethodCallExpr
					SimpleName
					NameExpr
						SimpleName
				)
				SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(IntegerLiteralExpr
				)
				(MethodCallExpr
					SimpleName
					(MethodCallExpr
						StringLiteralExpr
						StringLiteralExpr
						StringLiteralExpr
						SimpleName
						NameExpr
							SimpleName
					)
				)
				SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				NameExpr
					SimpleName
				SimpleName
				(MethodCallExpr
					(IntegerLiteralExpr
					)
					SimpleName
					(MethodCallExpr
						NameExpr
							SimpleName
						SimpleName
						(MethodCallExpr
							SimpleName
							NameExpr
								SimpleName
						)
					)
				)
			)
		)
	)
	(VoidType
	)
	SimpleName
	(ClassOrInterfaceType
		SimpleName
	)
	(MarkerAnnotationExpr
		Name
	)
	(MarkerAnnotationExpr
		Name
	)
	(JavadocComment
	)
)
||||||||(MethodDeclaration
	(BlockStmt
		(ExpressionStmt
			(VariableDeclarationExpr
				(VariableDeclarator
					(MethodCallExpr
						SimpleName
						(MethodCallExpr
							SimpleName
							(MethodCallExpr
								SimpleName
								(MethodCallExpr
									StringLiteralExpr
									SimpleName
									(MethodCallExpr
										StringLiteralExpr
										SimpleName
										(MethodCallExpr
											(IntegerLiteralExpr
											)
											SimpleName
											(MethodCallExpr
												StringLiteralExpr
												SimpleName
												(MethodCallExpr
													StringLiteralExpr
													SimpleName
													(MethodCallExpr
														StringLiteralExpr
														SimpleName
														(MethodCallExpr
															StringLiteralExpr
															SimpleName
															(MethodCallExpr
																StringLiteralExpr
																SimpleName
																(MethodCallExpr
																	SimpleName
																	(MethodCallExpr
																		SimpleName
																		(MethodCallExpr
																			SimpleName
																			(MethodCallExpr
																				StringLiteralExpr
																				SimpleName
																				(MethodCallExpr
																					StringLiteralExpr
																					SimpleName
																					(MethodCallExpr
																						SimpleName
																						(MethodCallExpr
																							StringLiteralExpr
																							SimpleName
																							(MethodCallExpr
																								StringLiteralExpr
																								SimpleName
																								(MethodCallExpr
																									SimpleName
																									(MethodCallExpr
																										StringLiteralExpr
																										SimpleName
																										(MethodCallExpr
																											StringLiteralExpr
																											SimpleName
																											(MethodCallExpr
																												StringLiteralExpr
																												SimpleName
																												(MethodCallExpr
																													SimpleName
																													(MethodCallExpr
																														StringLiteralExpr
																														SimpleName
																														(MethodCallExpr
																															(IntegerLiteralExpr
																															)
																															SimpleName
																															(MethodCallExpr
																																StringLiteralExpr
																																SimpleName
																																(MethodCallExpr
																																	StringLiteralExpr
																																	SimpleName
																																	(MethodCallExpr
																																		StringLiteralExpr
																																		SimpleName
																																		(MethodCallExpr
																																			StringLiteralExpr
																																			SimpleName
																																			(MethodCallExpr
																																				StringLiteralExpr
																																				SimpleName
																																				(MethodCallExpr
																																					SimpleName
																																					(MethodCallExpr
																																						SimpleName
																																						(MethodCallExpr
																																							SimpleName
																																							(MethodCallExpr
																																								(IntegerLiteralExpr
																																								)
																																								SimpleName
																																								(MethodCallExpr
																																									StringLiteralExpr
																																									SimpleName
																																									(MethodCallExpr
																																										SimpleName
																																										(MethodCallExpr
																																											StringLiteralExpr
																																											SimpleName
																																											(MethodCallExpr
																																												(IntegerLiteralExpr
																																												)
																																												SimpleName
																																												(MethodCallExpr
																																													StringLiteralExpr
																																													SimpleName
																																													(MethodCallExpr
																																														StringLiteralExpr
																																														SimpleName
																																														(MethodCallExpr
																																															StringLiteralExpr
																																															SimpleName
																																															(MethodCallExpr
																																																StringLiteralExpr
																																																SimpleName
																																																(MethodCallExpr
																																																	StringLiteralExpr
																																																	SimpleName
																																																	(MethodCallExpr
																																																		SimpleName
																																																		(MethodCallExpr
																																																			SimpleName
																																																			(MethodCallExpr
																																																				SimpleName
																																																				(MethodCallExpr
																																																					(IntegerLiteralExpr
																																																					)
																																																					SimpleName
																																																					(MethodCallExpr
																																																						StringLiteralExpr
																																																						SimpleName
																																																						(MethodCallExpr
																																																							SimpleName
																																																							(MethodCallExpr
																																																								StringLiteralExpr
																																																								SimpleName
																																																								(MethodCallExpr
																																																									(IntegerLiteralExpr
																																																									)
																																																									SimpleName
																																																									(MethodCallExpr
																																																										StringLiteralExpr
																																																										SimpleName
																																																										(MethodCallExpr
																																																											StringLiteralExpr
																																																											SimpleName
																																																											(MethodCallExpr
																																																												StringLiteralExpr
																																																												SimpleName
																																																												(MethodCallExpr
																																																													StringLiteralExpr
																																																													SimpleName
																																																													(MethodCallExpr
																																																														StringLiteralExpr
																																																														SimpleName
																																																														(MethodCallExpr
																																																															SimpleName
																																																															(MethodCallExpr
																																																																SimpleName
																																																																(ObjectCreationExpr
																																																																	(ClassOrInterfaceType
																																																																		SimpleName
																																																																	)
																																																																)
																																																															)
																																																														)
																																																													)
																																																												)
																																																											)
																																																										)
																																																									)
																																																								)
																																																							)
																																																						)
																																																					)
																																																				)
																																																			)
																																																		)
																																																	)
																																																)
																																															)
																																														)
																																													)
																																												)
																																											)
																																										)
																																									)
																																								)
																																							)
																																						)
																																					)
																																				)
																																			)
																																		)
																																	)
																																)
																															)
																														)
																													)
																												)
																											)
																										)
																									)
																								)
																							)
																						)
																					)
																				)
																			)
																		)
																	)
																)
															)
														)
													)
												)
											)
										)
									)
								)
							)
						)
					)
					SimpleName
					(ClassOrInterfaceType
						SimpleName
					)
				)
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				SimpleName
			)
		)
		(ExpressionStmt
			(VariableDeclarationExpr
				(VariableDeclarator
					(MethodCallExpr
						(MethodCallExpr
							SimpleName
						)
						NameExpr
							SimpleName
						SimpleName
						(MethodCallExpr
							SimpleName
							NameExpr
								SimpleName
						)
					)
					SimpleName
					(ClassOrInterfaceType
						SimpleName
					)
				)
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(IntegerLiteralExpr
				)
				(MethodCallExpr
					SimpleName
					NameExpr
						SimpleName
				)
				SimpleName
			)
		)
		(ExpressionStmt
			(VariableDeclarationExpr
				(VariableDeclarator
					(MethodCallExpr
						(MethodCallExpr
							SimpleName
							NameExpr
								SimpleName
						)
						SimpleName
						NameExpr
							SimpleName
					)
					SimpleName
					(ClassOrInterfaceType
						SimpleName
						(ClassOrInterfaceType
							SimpleName
							(ClassOrInterfaceType
								SimpleName
							)
							(ClassOrInterfaceType
								SimpleName
							)
						)
					)
				)
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(IntegerLiteralExpr
				)
				(MethodCallExpr
					SimpleName
					NameExpr
						SimpleName
				)
				SimpleName
			)
		)
		(ExpressionStmt
			(VariableDeclarationExpr
				(VariableDeclarator
					(MethodCallExpr
						(ClassExpr
							(ClassOrInterfaceType
								SimpleName
							)
						)
						SimpleName
						(MethodCallExpr
							(MethodCallExpr
								StringLiteralExpr
								StringLiteralExpr
								StringLiteralExpr
								SimpleName
							)
							SimpleName
							(MethodCallExpr
								SimpleName
								NameExpr
									SimpleName
							)
						)
					)
					SimpleName
					(ClassOrInterfaceType
						SimpleName
					)
				)
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(IntegerLiteralExpr
				)
				(MethodCallExpr
					SimpleName
					(MethodCallExpr
						NameExpr
							SimpleName
						SimpleName
						NameExpr
							SimpleName
					)
				)
				SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(MethodCallExpr
					SimpleName
				)
				SimpleName
				(MethodCallExpr
					(IntegerLiteralExpr
					)
					SimpleName
					(MethodCallExpr
						NameExpr
							SimpleName
						SimpleName
						(MethodCallExpr
							SimpleName
							NameExpr
								SimpleName
						)
					)
				)
			)
		)
	)
	(VoidType
	)
	SimpleName
	(ClassOrInterfaceType
		SimpleName
	)
	(MarkerAnnotationExpr
		Name
	)
	(MarkerAnnotationExpr
		Name
	)
	(JavadocComment
	)
)

