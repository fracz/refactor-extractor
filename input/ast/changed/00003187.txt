	public function getRelatedAttributes($user, $id = null, $sgids) {
		if ($id == null) $id = $this->data['Event']['id'];
		if (!isset($sgids) || empty($sgids)) $sgids = array(-1);
		$this->Correlation = ClassRegistry::init('Correlation');
		// search the correlation table for the event ids of the related attributes
		if (!$user['Role']['perm_site_admin']) {
		    $conditionsCorrelation = array(
		    	'AND' => array(
		    		'Correlation.1_event_id' => $id,
					array(
						'OR' => array(
							'Correlation.org_id' => $user['org_id'],
							'AND' => array(
								array(
									'OR' => array(
										array(
											'AND' => array(
												'Correlation.distribution >' => 0,
												'Correlation.distribution <' => 4,
											),
										),
										array(
											'AND' => array(
												'Correlation.distribution' => 4,
												'Correlation.sharing_group_id' => $sgids
											),
										),
									),
								),
								array(
									'OR' => array(
										'Correlation.a_distribution' => 5,
										array(
											'AND' => array(
												'Correlation.a_distribution >' => 0,
												'Correlation.a_distribution <' => 4,
											),
										),
										array(
											'AND' => array(
												'Correlation.a_distribution' => 4,
												'Correlation.a_sharing_group_id' => $sgids
											),
										),
									),
								),
							),
						),
					),
		    	),
		    );
		} else {
		    $conditionsCorrelation = array('Correlation.1_event_id' => $id);
		}
		$correlations = $this->Correlation->find('all',array(
		        'fields' => 'Correlation.*',
		        'conditions' => $conditionsCorrelation,
		        'recursive' => 0,
		        'order' => array('Correlation.event_id DESC')));
		$relatedAttributes = array();
		foreach ($correlations as $correlation) {
			$current = array(
		            'id' => $correlation['Correlation']['event_id'],
		            'org_id' => $correlation['Correlation']['org_id'],
		    		'info' => $correlation['Correlation']['info'],
					'value' => $correlation['Correlation']['value'],
		    );
			if (empty($relatedAttributes[$correlation['Correlation']['1_attribute_id']]) || !in_array($current, $relatedAttributes[$correlation['Correlation']['1_attribute_id']])) {
		    	$relatedAttributes[$correlation['Correlation']['1_attribute_id']][] = $current;
			}
		}
		return $relatedAttributes;
	}

/**
 * Clean up an Event Array that was received by an XML request.
 * The structure needs to be changed a little bit to be compatible with what CakePHP expects
 *
 * This function receives the reference of the variable, so no return is required as it directly
 * modifies the original data.
 *
 * @param &$data The reference to the variable
 *
 * @throws InternalErrorException
 */
||||||||	public function getRelatedAttributes($user, $id = null, $sgids, $shadowAttribute = false) {
		$context = $shadowAttribute ? 'ShadowAttribute' : 'Attribute';
		$settings = array(
			'Attribute' => array('model' => 'Attribute', 'correlationModel' => 'Correlation', 'parentIdField' => '1_attribute_id'),
			'ShadowAttribute' => array('model' => 'ShadowAttribute', 'correlationModel' => 'ShadowAttributeCorrelation', 'parentIdField' => '1_shadow_attribute_id')
		);
		if ($id == null) $id = $this->data['Event']['id'];
		if (!isset($sgids) || empty($sgids)) $sgids = array(-1);
		$this->$settings[$context]['correlationModel'] = ClassRegistry::init($settings[$context]['correlationModel']);
		if (!$user['Role']['perm_site_admin']) {
			$conditionsCorrelation = array(
					'AND' => array(
							$settings[$context]['correlationModel'] . '.1_event_id' => $id,
							array(
									'OR' => array(
											$settings[$context]['correlationModel'] . '.org_id' => $user['org_id'],
											'AND' => array(
													array(
															'OR' => array(
																	array(
																			'AND' => array(
																					$settings[$context]['correlationModel'] . '.distribution >' => 0,
																					$settings[$context]['correlationModel'] . '.distribution <' => 4,
																			),
																	),
																	array(
																			'AND' => array(
																					$settings[$context]['correlationModel'] . '.distribution' => 4,
																					$settings[$context]['correlationModel'] . '.sharing_group_id' => $sgids
																			),
																	),
															),
													),
													array(
															'OR' => array(
																	$settings[$context]['correlationModel'] . '.a_distribution' => 5,
																	array(
																			'AND' => array(
																					$settings[$context]['correlationModel'] . '.a_distribution >' => 0,
																					$settings[$context]['correlationModel'] . '.a_distribution <' => 4,
																			),
																	),
																	array(
																			'AND' => array(
																					$settings[$context]['correlationModel'] . '.a_distribution' => 4,
																					$settings[$context]['correlationModel'] . '.a_sharing_group_id' => $sgids
																			),
																	),
															),
													),
											),
									)
							)

					)
			);
		} else {
			$conditionsCorrelation = array($settings[$context]['correlationModel'] . '.1_event_id' => $id);
		}
		$correlations = $this->$settings[$context]['correlationModel']->find('all',array(
				'fields' => $settings[$context]['correlationModel'] . '.*',
				'conditions' => $conditionsCorrelation,
				'recursive' => 0,
				'order' => array($settings[$context]['correlationModel'] . '.event_id DESC')));
		$relatedAttributes = array();
		foreach ($correlations as $correlation) {
			$current = array(
					'id' => $correlation[$settings[$context]['correlationModel']]['event_id'],
					'org_id' => $correlation[$settings[$context]['correlationModel']]['org_id'],
					'info' => $correlation[$settings[$context]['correlationModel']]['info'],
					'value' => $correlation[$settings[$context]['correlationModel']]['value'],
			);
			if (empty($relatedAttributes[$correlation[$settings[$context]['correlationModel']][$settings[$context]['parentIdField']]]) || !in_array($current, $relatedAttributes[$correlation[$settings[$context]['correlationModel']][$settings[$context]['parentIdField']]])) {
				$relatedAttributes[$correlation[$settings[$context]['correlationModel']][$settings[$context]['parentIdField']]][] = $current;
			}
		}
		return $relatedAttributes;
	}

/**
 * Clean up an Event Array that was received by an XML request.
 * The structure needs to be changed a little bit to be compatible with what CakePHP expects
 *
 * This function receives the reference of the variable, so no return is required as it directly
 * modifies the original data.
 *
 * @param &$data The reference to the variable
 *
 * @throws InternalErrorException
 */
||||||||NO_DOC_COMMENTNO_RETURN_TYPE
(NO_PARAM_TYPENO_PARAM_DEFAULTNO_PARAM_TYPEPARAM_DEFAULTNO_PARAM_TYPENO_PARAM_DEFAULT)
(
    (AST_IF
        (AST_IF_ELEM
            (AST_BINARY_OP
                (AST_VAR)
                (AST_CONST))
            (
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_DIM
                        (AST_DIM
                            (AST_PROP
                                (AST_VAR))
                            (SCALAR))
                        (SCALAR))))))
    (AST_IF
        (AST_IF_ELEM
            (AST_BINARY_OP
                (AST_UNARY_OP
                    (AST_ISSET
                        (AST_VAR)))
                (AST_EMPTY
                    (AST_VAR)))
            (
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_ARRAY
                        (AST_ARRAY_ELEM
                            (AST_UNARY_OP
                                (SCALAR))
                            (NULL)))))))
    (AST_ASSIGN
        (AST_PROP
            (AST_VAR))
        (AST_STATIC_CALL
            (
                (SCALAR))))
    (AST_IF
        (AST_IF_ELEM
            (AST_UNARY_OP
                (AST_DIM
                    (AST_DIM
                        (AST_VAR)
                        (SCALAR))
                    (SCALAR)))
            (
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_ARRAY
                        (AST_ARRAY_ELEM
                            (AST_ARRAY
                                (AST_ARRAY_ELEM
                                    (AST_VAR)
                                    (SCALAR))
                                (AST_ARRAY_ELEM
                                    (AST_ARRAY
                                        (AST_ARRAY_ELEM
                                            (AST_ARRAY
                                                (AST_ARRAY_ELEM
                                                    (AST_DIM
                                                        (AST_VAR)
                                                        (SCALAR))
                                                    (SCALAR))
                                                (AST_ARRAY_ELEM
                                                    (AST_ARRAY
                                                        (AST_ARRAY_ELEM
                                                            (AST_ARRAY
                                                                (AST_ARRAY_ELEM
                                                                    (AST_ARRAY
                                                                        (AST_ARRAY_ELEM
                                                                            (AST_ARRAY
                                                                                (AST_ARRAY_ELEM
                                                                                    (AST_ARRAY
                                                                                        (AST_ARRAY_ELEM
                                                                                            (SCALAR)
                                                                                            (SCALAR))
                                                                                        (AST_ARRAY_ELEM
                                                                                            (SCALAR)
                                                                                            (SCALAR)))
                                                                                    (SCALAR)))
                                                                            (NULL))
                                                                        (AST_ARRAY_ELEM
                                                                            (AST_ARRAY
                                                                                (AST_ARRAY_ELEM
                                                                                    (AST_ARRAY
                                                                                        (AST_ARRAY_ELEM
                                                                                            (SCALAR)
                                                                                            (SCALAR))
                                                                                        (AST_ARRAY_ELEM
                                                                                            (AST_VAR)
                                                                                            (SCALAR)))
                                                                                    (SCALAR)))
                                                                            (NULL)))
                                                                    (SCALAR)))
                                                            (NULL))
                                                        (AST_ARRAY_ELEM
                                                            (AST_ARRAY
                                                                (AST_ARRAY_ELEM
                                                                    (AST_ARRAY
                                                                        (AST_ARRAY_ELEM
                                                                            (SCALAR)
                                                                            (SCALAR))
                                                                        (AST_ARRAY_ELEM
                                                                            (AST_ARRAY
                                                                                (AST_ARRAY_ELEM
                                                                                    (AST_ARRAY
                                                                                        (AST_ARRAY_ELEM
                                                                                            (SCALAR)
                                                                                            (SCALAR))
                                                                                        (AST_ARRAY_ELEM
                                                                                            (SCALAR)
                                                                                            (SCALAR)))
                                                                                    (SCALAR)))
                                                                            (NULL))
                                                                        (AST_ARRAY_ELEM
                                                                            (AST_ARRAY
                                                                                (AST_ARRAY_ELEM
                                                                                    (AST_ARRAY
                                                                                        (AST_ARRAY_ELEM
                                                                                            (SCALAR)
                                                                                            (SCALAR))
                                                                                        (AST_ARRAY_ELEM
                                                                                            (AST_VAR)
                                                                                            (SCALAR)))
                                                                                    (SCALAR)))
                                                                            (NULL)))
                                                                    (SCALAR)))
                                                            (NULL)))
                                                    (SCALAR)))
                                            (SCALAR)))
                                    (NULL)))
                            (SCALAR))))))
        (AST_IF_ELEM
            (NULL)
            (
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_ARRAY
                        (AST_ARRAY_ELEM
                            (AST_VAR)
                            (SCALAR)))))))
    (AST_ASSIGN
        (AST_VAR)
        (AST_METHOD_CALL
            (AST_PROP
                (AST_VAR))
            (
                (SCALAR)
                (AST_ARRAY
                    (AST_ARRAY_ELEM
                        (SCALAR)
                        (SCALAR))
                    (AST_ARRAY_ELEM
                        (AST_VAR)
                        (SCALAR))
                    (AST_ARRAY_ELEM
                        (SCALAR)
                        (SCALAR))
                    (AST_ARRAY_ELEM
                        (AST_ARRAY
                            (AST_ARRAY_ELEM
                                (SCALAR)
                                (NULL)))
                        (SCALAR))))))
    (AST_ASSIGN
        (AST_VAR)
        (AST_ARRAY))
    (AST_FOREACH
        (AST_VAR)
        (AST_VAR)
        (NULL)
        (
            (AST_ASSIGN
                (AST_VAR)
                (AST_ARRAY
                    (AST_ARRAY_ELEM
                        (AST_DIM
                            (AST_DIM
                                (AST_VAR)
                                (SCALAR))
                            (SCALAR))
                        (SCALAR))
                    (AST_ARRAY_ELEM
                        (AST_DIM
                            (AST_DIM
                                (AST_VAR)
                                (SCALAR))
                            (SCALAR))
                        (SCALAR))
                    (AST_ARRAY_ELEM
                        (AST_DIM
                            (AST_DIM
                                (AST_VAR)
                                (SCALAR))
                            (SCALAR))
                        (SCALAR))
                    (AST_ARRAY_ELEM
                        (AST_DIM
                            (AST_DIM
                                (AST_VAR)
                                (SCALAR))
                            (SCALAR))
                        (SCALAR))))
            (AST_IF
                (AST_IF_ELEM
                    (AST_BINARY_OP
                        (AST_EMPTY
                            (AST_DIM
                                (AST_VAR)
                                (AST_DIM
                                    (AST_DIM
                                        (AST_VAR)
                                        (SCALAR))
                                    (SCALAR))))
                        (AST_UNARY_OP
                            (AST_CALL
                                (
                                    (AST_VAR)
                                    (AST_DIM
                                        (AST_VAR)
                                        (AST_DIM
                                            (AST_DIM
                                                (AST_VAR)
                                                (SCALAR))
                                            (SCALAR)))))))
                    (
                        (AST_ASSIGN
                            (AST_DIM
                                (AST_DIM
                                    (AST_VAR)
                                    (AST_DIM
                                        (AST_DIM
                                            (AST_VAR)
                                            (SCALAR))
                                        (SCALAR)))
                                (NULL))
                            (AST_VAR)))))))
    (AST_RETURN
        (AST_VAR)))||||||||NO_DOC_COMMENTNO_RETURN_TYPE
(NO_PARAM_TYPENO_PARAM_DEFAULTNO_PARAM_TYPEPARAM_DEFAULTNO_PARAM_TYPENO_PARAM_DEFAULTNO_PARAM_TYPEPARAM_DEFAULT)
(
    (AST_ASSIGN
        (AST_VAR)
        (AST_CONDITIONAL
            (AST_VAR)
            (SCALAR)
            (SCALAR)))
    (AST_ASSIGN
        (AST_VAR)
        (AST_ARRAY
            (AST_ARRAY_ELEM
                (AST_ARRAY
                    (AST_ARRAY_ELEM
                        (SCALAR)
                        (SCALAR))
                    (AST_ARRAY_ELEM
                        (SCALAR)
                        (SCALAR))
                    (AST_ARRAY_ELEM
                        (SCALAR)
                        (SCALAR)))
                (SCALAR))
            (AST_ARRAY_ELEM
                (AST_ARRAY
                    (AST_ARRAY_ELEM
                        (SCALAR)
                        (SCALAR))
                    (AST_ARRAY_ELEM
                        (SCALAR)
                        (SCALAR))
                    (AST_ARRAY_ELEM
                        (SCALAR)
                        (SCALAR)))
                (SCALAR))))
    (AST_IF
        (AST_IF_ELEM
            (AST_BINARY_OP
                (AST_VAR)
                (AST_CONST))
            (
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_DIM
                        (AST_DIM
                            (AST_PROP
                                (AST_VAR))
                            (SCALAR))
                        (SCALAR))))))
    (AST_IF
        (AST_IF_ELEM
            (AST_BINARY_OP
                (AST_UNARY_OP
                    (AST_ISSET
                        (AST_VAR)))
                (AST_EMPTY
                    (AST_VAR)))
            (
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_ARRAY
                        (AST_ARRAY_ELEM
                            (AST_UNARY_OP
                                (SCALAR))
                            (NULL)))))))
    (AST_ASSIGN
        (AST_DIM
            (AST_DIM
                (AST_PROP
                    (AST_VAR))
                (AST_VAR))
            (SCALAR))
        (AST_STATIC_CALL
            (
                (AST_DIM
                    (AST_DIM
                        (AST_VAR)
                        (AST_VAR))
                    (SCALAR)))))
    (AST_IF
        (AST_IF_ELEM
            (AST_UNARY_OP
                (AST_DIM
                    (AST_DIM
                        (AST_VAR)
                        (SCALAR))
                    (SCALAR)))
            (
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_ARRAY
                        (AST_ARRAY_ELEM
                            (AST_ARRAY
                                (AST_ARRAY_ELEM
                                    (AST_VAR)
                                    (AST_BINARY_OP
                                        (AST_DIM
                                            (AST_DIM
                                                (AST_VAR)
                                                (AST_VAR))
                                            (SCALAR))
                                        (SCALAR)))
                                (AST_ARRAY_ELEM
                                    (AST_ARRAY
                                        (AST_ARRAY_ELEM
                                            (AST_ARRAY
                                                (AST_ARRAY_ELEM
                                                    (AST_DIM
                                                        (AST_VAR)
                                                        (SCALAR))
                                                    (AST_BINARY_OP
                                                        (AST_DIM
                                                            (AST_DIM
                                                                (AST_VAR)
                                                                (AST_VAR))
                                                            (SCALAR))
                                                        (SCALAR)))
                                                (AST_ARRAY_ELEM
                                                    (AST_ARRAY
                                                        (AST_ARRAY_ELEM
                                                            (AST_ARRAY
                                                                (AST_ARRAY_ELEM
                                                                    (AST_ARRAY
                                                                        (AST_ARRAY_ELEM
                                                                            (AST_ARRAY
                                                                                (AST_ARRAY_ELEM
                                                                                    (AST_ARRAY
                                                                                        (AST_ARRAY_ELEM
                                                                                            (SCALAR)
                                                                                            (AST_BINARY_OP
                                                                                                (AST_DIM
                                                                                                    (AST_DIM
                                                                                                        (AST_VAR)
                                                                                                        (AST_VAR))
                                                                                                    (SCALAR))
                                                                                                (SCALAR)))
                                                                                        (AST_ARRAY_ELEM
                                                                                            (SCALAR)
                                                                                            (AST_BINARY_OP
                                                                                                (AST_DIM
                                                                                                    (AST_DIM
                                                                                                        (AST_VAR)
                                                                                                        (AST_VAR))
                                                                                                    (SCALAR))
                                                                                                (SCALAR))))
                                                                                    (SCALAR)))
                                                                            (NULL))
                                                                        (AST_ARRAY_ELEM
                                                                            (AST_ARRAY
                                                                                (AST_ARRAY_ELEM
                                                                                    (AST_ARRAY
                                                                                        (AST_ARRAY_ELEM
                                                                                            (SCALAR)
                                                                                            (AST_BINARY_OP
                                                                                                (AST_DIM
                                                                                                    (AST_DIM
                                                                                                        (AST_VAR)
                                                                                                        (AST_VAR))
                                                                                                    (SCALAR))
                                                                                                (SCALAR)))
                                                                                        (AST_ARRAY_ELEM
                                                                                            (AST_VAR)
                                                                                            (AST_BINARY_OP
                                                                                                (AST_DIM
                                                                                                    (AST_DIM
                                                                                                        (AST_VAR)
                                                                                                        (AST_VAR))
                                                                                                    (SCALAR))
                                                                                                (SCALAR))))
                                                                                    (SCALAR)))
                                                                            (NULL)))
                                                                    (SCALAR)))
                                                            (NULL))
                                                        (AST_ARRAY_ELEM
                                                            (AST_ARRAY
                                                                (AST_ARRAY_ELEM
                                                                    (AST_ARRAY
                                                                        (AST_ARRAY_ELEM
                                                                            (SCALAR)
                                                                            (AST_BINARY_OP
                                                                                (AST_DIM
                                                                                    (AST_DIM
                                                                                        (AST_VAR)
                                                                                        (AST_VAR))
                                                                                    (SCALAR))
                                                                                (SCALAR)))
                                                                        (AST_ARRAY_ELEM
                                                                            (AST_ARRAY
                                                                                (AST_ARRAY_ELEM
                                                                                    (AST_ARRAY
                                                                                        (AST_ARRAY_ELEM
                                                                                            (SCALAR)
                                                                                            (AST_BINARY_OP
                                                                                                (AST_DIM
                                                                                                    (AST_DIM
                                                                                                        (AST_VAR)
                                                                                                        (AST_VAR))
                                                                                                    (SCALAR))
                                                                                                (SCALAR)))
                                                                                        (AST_ARRAY_ELEM
                                                                                            (SCALAR)
                                                                                            (AST_BINARY_OP
                                                                                                (AST_DIM
                                                                                                    (AST_DIM
                                                                                                        (AST_VAR)
                                                                                                        (AST_VAR))
                                                                                                    (SCALAR))
                                                                                                (SCALAR))))
                                                                                    (SCALAR)))
                                                                            (NULL))
                                                                        (AST_ARRAY_ELEM
                                                                            (AST_ARRAY
                                                                                (AST_ARRAY_ELEM
                                                                                    (AST_ARRAY
                                                                                        (AST_ARRAY_ELEM
                                                                                            (SCALAR)
                                                                                            (AST_BINARY_OP
                                                                                                (AST_DIM
                                                                                                    (AST_DIM
                                                                                                        (AST_VAR)
                                                                                                        (AST_VAR))
                                                                                                    (SCALAR))
                                                                                                (SCALAR)))
                                                                                        (AST_ARRAY_ELEM
                                                                                            (AST_VAR)
                                                                                            (AST_BINARY_OP
                                                                                                (AST_DIM
                                                                                                    (AST_DIM
                                                                                                        (AST_VAR)
                                                                                                        (AST_VAR))
                                                                                                    (SCALAR))
                                                                                                (SCALAR))))
                                                                                    (SCALAR)))
                                                                            (NULL)))
                                                                    (SCALAR)))
                                                            (NULL)))
                                                    (SCALAR)))
                                            (SCALAR)))
                                    (NULL)))
                            (SCALAR))))))
        (AST_IF_ELEM
            (NULL)
            (
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_ARRAY
                        (AST_ARRAY_ELEM
                            (AST_VAR)
                            (AST_BINARY_OP
                                (AST_DIM
                                    (AST_DIM
                                        (AST_VAR)
                                        (AST_VAR))
                                    (SCALAR))
                                (SCALAR))))))))
    (AST_ASSIGN
        (AST_VAR)
        (AST_METHOD_CALL
            (AST_DIM
                (AST_DIM
                    (AST_PROP
                        (AST_VAR))
                    (AST_VAR))
                (SCALAR))
            (
                (SCALAR)
                (AST_ARRAY
                    (AST_ARRAY_ELEM
                        (AST_BINARY_OP
                            (AST_DIM
                                (AST_DIM
                                    (AST_VAR)
                                    (AST_VAR))
                                (SCALAR))
                            (SCALAR))
                        (SCALAR))
                    (AST_ARRAY_ELEM
                        (AST_VAR)
                        (SCALAR))
                    (AST_ARRAY_ELEM
                        (SCALAR)
                        (SCALAR))
                    (AST_ARRAY_ELEM
                        (AST_ARRAY
                            (AST_ARRAY_ELEM
                                (AST_BINARY_OP
                                    (AST_DIM
                                        (AST_DIM
                                            (AST_VAR)
                                            (AST_VAR))
                                        (SCALAR))
                                    (SCALAR))
                                (NULL)))
                        (SCALAR))))))
    (AST_ASSIGN
        (AST_VAR)
        (AST_ARRAY))
    (AST_FOREACH
        (AST_VAR)
        (AST_VAR)
        (NULL)
        (
            (AST_ASSIGN
                (AST_VAR)
                (AST_ARRAY
                    (AST_ARRAY_ELEM
                        (AST_DIM
                            (AST_DIM
                                (AST_VAR)
                                (AST_DIM
                                    (AST_DIM
                                        (AST_VAR)
                                        (AST_VAR))
                                    (SCALAR)))
                            (SCALAR))
                        (SCALAR))
                    (AST_ARRAY_ELEM
                        (AST_DIM
                            (AST_DIM
                                (AST_VAR)
                                (AST_DIM
                                    (AST_DIM
                                        (AST_VAR)
                                        (AST_VAR))
                                    (SCALAR)))
                            (SCALAR))
                        (SCALAR))
                    (AST_ARRAY_ELEM
                        (AST_DIM
                            (AST_DIM
                                (AST_VAR)
                                (AST_DIM
                                    (AST_DIM
                                        (AST_VAR)
                                        (AST_VAR))
                                    (SCALAR)))
                            (SCALAR))
                        (SCALAR))
                    (AST_ARRAY_ELEM
                        (AST_DIM
                            (AST_DIM
                                (AST_VAR)
                                (AST_DIM
                                    (AST_DIM
                                        (AST_VAR)
                                        (AST_VAR))
                                    (SCALAR)))
                            (SCALAR))
                        (SCALAR))))
            (AST_IF
                (AST_IF_ELEM
                    (AST_BINARY_OP
                        (AST_EMPTY
                            (AST_DIM
                                (AST_VAR)
                                (AST_DIM
                                    (AST_DIM
                                        (AST_VAR)
                                        (AST_DIM
                                            (AST_DIM
                                                (AST_VAR)
                                                (AST_VAR))
                                            (SCALAR)))
                                    (AST_DIM
                                        (AST_DIM
                                            (AST_VAR)
                                            (AST_VAR))
                                        (SCALAR)))))
                        (AST_UNARY_OP
                            (AST_CALL
                                (
                                    (AST_VAR)
                                    (AST_DIM
                                        (AST_VAR)
                                        (AST_DIM
                                            (AST_DIM
                                                (AST_VAR)
                                                (AST_DIM
                                                    (AST_DIM
                                                        (AST_VAR)
                                                        (AST_VAR))
                                                    (SCALAR)))
                                            (AST_DIM
                                                (AST_DIM
                                                    (AST_VAR)
                                                    (AST_VAR))
                                                (SCALAR))))))))
                    (
                        (AST_ASSIGN
                            (AST_DIM
                                (AST_DIM
                                    (AST_VAR)
                                    (AST_DIM
                                        (AST_DIM
                                            (AST_VAR)
                                            (AST_DIM
                                                (AST_DIM
                                                    (AST_VAR)
                                                    (AST_VAR))
                                                (SCALAR)))
                                        (AST_DIM
                                            (AST_DIM
                                                (AST_VAR)
                                                (AST_VAR))
                                            (SCALAR))))
                                (NULL))
                            (AST_VAR)))))))
    (AST_RETURN
        (AST_VAR)))