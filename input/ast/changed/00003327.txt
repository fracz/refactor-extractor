    public function pull($id = null, $full=false) {
        if (!$this->request->is('post')) {
            throw new MethodNotAllowedException();
        }
        $this->Server->id = $id;
        if (!$this->Server->exists()) {
            throw new NotFoundException(__('Invalid server'));
        }

        App::uses('HttpSocket', 'Network/Http');
        $this->Server->read(null, $id);

        if (false == $this->Server->data['Server']['pull']) {
            $this->Session->setFlash(__('Pull setting not enabled for this server.'));
            $this->redirect(array('action' => 'index'));
        }

        if ("full"==$full) {
            // get a list of the event_ids on the server
            $event_ids = $this->Event->getEventIdsFromServer($this->Server->data);

            $successes = array();
            $fails = array();
            // download each event
            if (null != $event_ids) {
                App::import('Controller', 'Events');
                $HttpSocket = new HttpSocket();
                foreach ($event_ids as $event_id) {
                    $event = $this->Event->downloadEventFromServer(
                            $event_id,
                            $this->Server->data);
                    if (null != $event) {
                        // we have an Event array
                        $event['Event']['private'] = true;
                        $event['Event']['info'] .= "\n Imported from ".$this->Server->data['Server']['url'];
                        $eventsController = new EventsController();
                        try {
                            $result = $eventsController->_add($event, $this->Auth, $fromXml=true);
                        } catch (MethodNotAllowedException $e) {
                            if ($e->getMessage() == 'Event already exists') {
                                $successes[] = $event_id;
                                continue;
                            }
                        }
                        //$result = $this->_importEvent($event);
                        // TODO error handling
                    } else {
                        // error
                        $fails[$event_id] = 'failed';
                    }

                }
                if (sizeof($fails) > 0) {
                    // there are fails, take the lowest fail
                    $lastpulledid = min(array_keys($fails));
                } else {
                    // no fails, take the highest success
                    $lastpulledid = max($successes);
                }
                // increment lastid based on the highest ID seen
                $this->Server->saveField('lastpulledid', $lastpulledid);

            }


        } else {
            // TODO incremental pull
            // lastpulledid
            throw new NotFoundException('Sorry, this is not yet implemented');

            // increment lastid based on the highest ID seen
        }

        $this->set('successes', $successes);
        $this->set('fails', $fails);
    }


||||||||    public function pull($id = null, $full=false) {
        if (!$this->request->is('post')) {
            throw new MethodNotAllowedException();
        }
        $this->Server->id = $id;
        if (!$this->Server->exists()) {
            throw new NotFoundException(__('Invalid server'));
        }

        App::uses('HttpSocket', 'Network/Http');
        $this->Server->read(null, $id);

        if (false == $this->Server->data['Server']['pull']) {
            $this->Session->setFlash(__('Pull setting not enabled for this server.'));
            $this->redirect(array('action' => 'index'));
        }

        if ("full"==$full) {
            // get a list of the event_ids on the server
            $event_ids = $this->Event->getEventIdsFromServer($this->Server->data);

            $successes = array();
            $fails = array();
            // download each event
            if (null != $event_ids) {
                App::import('Controller', 'Events');
                $HttpSocket = new HttpSocket();
                foreach ($event_ids as &$event_id) {
                    $event = $this->Event->downloadEventFromServer(
                            $event_id,
                            $this->Server->data);
                    if (null != $event) {
                        // we have an Event array
                        $event['Event']['private'] = true;
                        $event['Event']['info'] .= "\n Imported from ".$this->Server->data['Server']['url'];
                        $eventsController = new EventsController();
                        try {
                            $result = $eventsController->_add($event, $this->Auth, $fromXml=true);
                        } catch (MethodNotAllowedException $e) {
                            if ($e->getMessage() == 'Event already exists') {
                                $successes[] = $event_id;
                                continue;
                            }
                        }
                        //$result = $this->_importEvent($event);
                        // TODO error handling
                    } else {
                        // error
                        $fails[$event_id] = 'failed';
                    }

                }
                if (sizeof($fails) > 0) {
                    // there are fails, take the lowest fail
                    $lastpulledid = min(array_keys($fails));
                } else {
                    // no fails, take the highest success
                    $lastpulledid = max($successes);
                }
                // increment lastid based on the highest ID seen
                $this->Server->saveField('lastpulledid', $lastpulledid);

            }


        } else {
            // TODO incremental pull
            // lastpulledid
            throw new NotFoundException('Sorry, this is not yet implemented');

            // increment lastid based on the highest ID seen
        }

        $this->set('successes', $successes);
        $this->set('fails', $fails);
    }


||||||||NO_DOC_COMMENTNO_RETURN_TYPE
(NO_PARAM_TYPEPARAM_DEFAULTNO_PARAM_TYPEPARAM_DEFAULT)
(
    (AST_IF
        (AST_IF_ELEM
            (AST_UNARY_OP
                (AST_METHOD_CALL
                    (AST_PROP
                        (AST_VAR))
                    (
                        (SCALAR))))
            (
                (AST_THROW
                    (AST_NEW)))))
    (AST_ASSIGN
        (AST_PROP
            (AST_PROP
                (AST_VAR)))
        (AST_VAR))
    (AST_IF
        (AST_IF_ELEM
            (AST_UNARY_OP
                (AST_METHOD_CALL
                    (AST_PROP
                        (AST_VAR))))
            (
                (AST_THROW
                    (AST_NEW
                        (
                            (AST_CALL
                                (
                                    (SCALAR)))))))))
    (AST_STATIC_CALL
        (
            (SCALAR)
            (SCALAR)))
    (AST_METHOD_CALL
        (AST_PROP
            (AST_VAR))
        (
            (AST_CONST)
            (AST_VAR)))
    (AST_IF
        (AST_IF_ELEM
            (AST_BINARY_OP
                (AST_CONST)
                (AST_DIM
                    (AST_DIM
                        (AST_PROP
                            (AST_PROP
                                (AST_VAR)))
                        (SCALAR))
                    (SCALAR)))
            (
                (AST_METHOD_CALL
                    (AST_PROP
                        (AST_VAR))
                    (
                        (AST_CALL
                            (
                                (SCALAR)))))
                (AST_METHOD_CALL
                    (AST_VAR)
                    (
                        (AST_ARRAY
                            (AST_ARRAY_ELEM
                                (SCALAR)
                                (SCALAR))))))))
    (AST_IF
        (AST_IF_ELEM
            (AST_BINARY_OP
                (SCALAR)
                (AST_VAR))
            (
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_METHOD_CALL
                        (AST_PROP
                            (AST_VAR))
                        (
                            (AST_PROP
                                (AST_PROP
                                    (AST_VAR))))))
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_ARRAY))
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_ARRAY))
                (AST_IF
                    (AST_IF_ELEM
                        (AST_BINARY_OP
                            (AST_CONST)
                            (AST_VAR))
                        (
                            (AST_STATIC_CALL
                                (
                                    (SCALAR)
                                    (SCALAR)))
                            (AST_ASSIGN
                                (AST_VAR)
                                (AST_NEW))
                            (AST_FOREACH
                                (AST_VAR)
                                (AST_VAR)
                                (NULL)
                                (
                                    (AST_ASSIGN
                                        (AST_VAR)
                                        (AST_METHOD_CALL
                                            (AST_PROP
                                                (AST_VAR))
                                            (
                                                (AST_VAR)
                                                (AST_PROP
                                                    (AST_PROP
                                                        (AST_VAR))))))
                                    (AST_IF
                                        (AST_IF_ELEM
                                            (AST_BINARY_OP
                                                (AST_CONST)
                                                (AST_VAR))
                                            (
                                                (AST_ASSIGN
                                                    (AST_DIM
                                                        (AST_DIM
                                                            (AST_VAR)
                                                            (SCALAR))
                                                        (SCALAR))
                                                    (AST_CONST))
                                                (AST_ASSIGN_OP
                                                    (AST_DIM
                                                        (AST_DIM
                                                            (AST_VAR)
                                                            (SCALAR))
                                                        (SCALAR))
                                                    (AST_BINARY_OP
                                                        (SCALAR)
                                                        (AST_DIM
                                                            (AST_DIM
                                                                (AST_PROP
                                                                    (AST_PROP
                                                                        (AST_VAR)))
                                                                (SCALAR))
                                                            (SCALAR))))
                                                (AST_ASSIGN
                                                    (AST_VAR)
                                                    (AST_NEW))
                                                (AST_TRY
                                                    (
                                                        (AST_ASSIGN
                                                            (AST_VAR)
                                                            (AST_METHOD_CALL
                                                                (AST_VAR)
                                                                (
                                                                    (AST_VAR)
                                                                    (AST_PROP
                                                                        (AST_VAR))
                                                                    (AST_ASSIGN
                                                                        (AST_VAR)
                                                                        (AST_CONST))))))
                                                    (AST_CATCH_LIST
                                                        (AST_CATCH
                                                            (AST_NAME_LIST)
                                                            (AST_VAR)
                                                            (
                                                                (AST_IF
                                                                    (AST_IF_ELEM
                                                                        (AST_BINARY_OP
                                                                            (AST_METHOD_CALL
                                                                                (AST_VAR))
                                                                            (SCALAR))
                                                                        (
                                                                            (AST_ASSIGN
                                                                                (AST_DIM
                                                                                    (AST_VAR)
                                                                                    (NULL))
                                                                                (AST_VAR))
                                                                            (AST_CONTINUE
                                                                                (NULL))))))))
                                                    (NULL))))
                                        (AST_IF_ELEM
                                            (NULL)
                                            (
                                                (AST_ASSIGN
                                                    (AST_DIM
                                                        (AST_VAR)
                                                        (AST_VAR))
                                                    (SCALAR)))))))
                            (AST_IF
                                (AST_IF_ELEM
                                    (AST_BINARY_OP
                                        (AST_CALL
                                            (
                                                (AST_VAR)))
                                        (SCALAR))
                                    (
                                        (AST_ASSIGN
                                            (AST_VAR)
                                            (AST_CALL
                                                (
                                                    (AST_CALL
                                                        (
                                                            (AST_VAR))))))))
                                (AST_IF_ELEM
                                    (NULL)
                                    (
                                        (AST_ASSIGN
                                            (AST_VAR)
                                            (AST_CALL
                                                (
                                                    (AST_VAR)))))))
                            (AST_METHOD_CALL
                                (AST_PROP
                                    (AST_VAR))
                                (
                                    (SCALAR)
                                    (AST_VAR))))))))
        (AST_IF_ELEM
            (NULL)
            (
                (AST_THROW
                    (AST_NEW
                        (
                            (SCALAR)))))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_VAR)))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_VAR))))||||||||NO_DOC_COMMENTNO_RETURN_TYPE
(NO_PARAM_TYPEPARAM_DEFAULTNO_PARAM_TYPEPARAM_DEFAULT)
(
    (AST_IF
        (AST_IF_ELEM
            (AST_UNARY_OP
                (AST_METHOD_CALL
                    (AST_PROP
                        (AST_VAR))
                    (
                        (SCALAR))))
            (
                (AST_THROW
                    (AST_NEW)))))
    (AST_ASSIGN
        (AST_PROP
            (AST_PROP
                (AST_VAR)))
        (AST_VAR))
    (AST_IF
        (AST_IF_ELEM
            (AST_UNARY_OP
                (AST_METHOD_CALL
                    (AST_PROP
                        (AST_VAR))))
            (
                (AST_THROW
                    (AST_NEW
                        (
                            (AST_CALL
                                (
                                    (SCALAR)))))))))
    (AST_STATIC_CALL
        (
            (SCALAR)
            (SCALAR)))
    (AST_METHOD_CALL
        (AST_PROP
            (AST_VAR))
        (
            (AST_CONST)
            (AST_VAR)))
    (AST_IF
        (AST_IF_ELEM
            (AST_BINARY_OP
                (AST_CONST)
                (AST_DIM
                    (AST_DIM
                        (AST_PROP
                            (AST_PROP
                                (AST_VAR)))
                        (SCALAR))
                    (SCALAR)))
            (
                (AST_METHOD_CALL
                    (AST_PROP
                        (AST_VAR))
                    (
                        (AST_CALL
                            (
                                (SCALAR)))))
                (AST_METHOD_CALL
                    (AST_VAR)
                    (
                        (AST_ARRAY
                            (AST_ARRAY_ELEM
                                (SCALAR)
                                (SCALAR))))))))
    (AST_IF
        (AST_IF_ELEM
            (AST_BINARY_OP
                (SCALAR)
                (AST_VAR))
            (
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_METHOD_CALL
                        (AST_PROP
                            (AST_VAR))
                        (
                            (AST_PROP
                                (AST_PROP
                                    (AST_VAR))))))
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_ARRAY))
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_ARRAY))
                (AST_IF
                    (AST_IF_ELEM
                        (AST_BINARY_OP
                            (AST_CONST)
                            (AST_VAR))
                        (
                            (AST_STATIC_CALL
                                (
                                    (SCALAR)
                                    (SCALAR)))
                            (AST_ASSIGN
                                (AST_VAR)
                                (AST_NEW))
                            (AST_FOREACH
                                (AST_VAR)
                                (AST_REF
                                    (AST_VAR))
                                (NULL)
                                (
                                    (AST_ASSIGN
                                        (AST_VAR)
                                        (AST_METHOD_CALL
                                            (AST_PROP
                                                (AST_VAR))
                                            (
                                                (AST_VAR)
                                                (AST_PROP
                                                    (AST_PROP
                                                        (AST_VAR))))))
                                    (AST_IF
                                        (AST_IF_ELEM
                                            (AST_BINARY_OP
                                                (AST_CONST)
                                                (AST_VAR))
                                            (
                                                (AST_ASSIGN
                                                    (AST_DIM
                                                        (AST_DIM
                                                            (AST_VAR)
                                                            (SCALAR))
                                                        (SCALAR))
                                                    (AST_CONST))
                                                (AST_ASSIGN_OP
                                                    (AST_DIM
                                                        (AST_DIM
                                                            (AST_VAR)
                                                            (SCALAR))
                                                        (SCALAR))
                                                    (AST_BINARY_OP
                                                        (SCALAR)
                                                        (AST_DIM
                                                            (AST_DIM
                                                                (AST_PROP
                                                                    (AST_PROP
                                                                        (AST_VAR)))
                                                                (SCALAR))
                                                            (SCALAR))))
                                                (AST_ASSIGN
                                                    (AST_VAR)
                                                    (AST_NEW))
                                                (AST_TRY
                                                    (
                                                        (AST_ASSIGN
                                                            (AST_VAR)
                                                            (AST_METHOD_CALL
                                                                (AST_VAR)
                                                                (
                                                                    (AST_VAR)
                                                                    (AST_PROP
                                                                        (AST_VAR))
                                                                    (AST_ASSIGN
                                                                        (AST_VAR)
                                                                        (AST_CONST))))))
                                                    (AST_CATCH_LIST
                                                        (AST_CATCH
                                                            (AST_NAME_LIST)
                                                            (AST_VAR)
                                                            (
                                                                (AST_IF
                                                                    (AST_IF_ELEM
                                                                        (AST_BINARY_OP
                                                                            (AST_METHOD_CALL
                                                                                (AST_VAR))
                                                                            (SCALAR))
                                                                        (
                                                                            (AST_ASSIGN
                                                                                (AST_DIM
                                                                                    (AST_VAR)
                                                                                    (NULL))
                                                                                (AST_VAR))
                                                                            (AST_CONTINUE
                                                                                (NULL))))))))
                                                    (NULL))))
                                        (AST_IF_ELEM
                                            (NULL)
                                            (
                                                (AST_ASSIGN
                                                    (AST_DIM
                                                        (AST_VAR)
                                                        (AST_VAR))
                                                    (SCALAR)))))))
                            (AST_IF
                                (AST_IF_ELEM
                                    (AST_BINARY_OP
                                        (AST_CALL
                                            (
                                                (AST_VAR)))
                                        (SCALAR))
                                    (
                                        (AST_ASSIGN
                                            (AST_VAR)
                                            (AST_CALL
                                                (
                                                    (AST_CALL
                                                        (
                                                            (AST_VAR))))))))
                                (AST_IF_ELEM
                                    (NULL)
                                    (
                                        (AST_ASSIGN
                                            (AST_VAR)
                                            (AST_CALL
                                                (
                                                    (AST_VAR)))))))
                            (AST_METHOD_CALL
                                (AST_PROP
                                    (AST_VAR))
                                (
                                    (SCALAR)
                                    (AST_VAR))))))))
        (AST_IF_ELEM
            (NULL)
            (
                (AST_THROW
                    (AST_NEW
                        (
                            (SCALAR)))))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_VAR)))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_VAR))))