    public function getEmailSettings(Email $email, $includeVariants = true)
    {
        static $emailSettings = [];

        if (empty($emailSettings[$email->getId()])) {

            //used to house slots so they don't have to be fetched over and over for same template
            $slots = [];
            if ($template = $email->getTemplate()) {
                $slots[$template] = $this->themeHelper->getTheme($template)->getSlots('email');
            }

            //store the settings of all the variants in order to properly disperse the emails
            //set the parent's settings
            $emailSettings = [
                $email->getId() => [
                    'template'     => $email->getTemplate(),
                    'slots'        => $slots,
                    'sentCount'    => $email->getSentCount(),
                    'variantCount' => $email->getVariantSentCount(),
                    'isVariant'    => null !== $email->getVariantStartDate(),
                    'entity'       => $email,
                    'translations' => $email->getTranslations(true),
                    'languages'    => ['default' => $email->getId()]
                ],
            ];

            if ($emailSettings[$email->getId()]['translations']) {
                // Add in the sent counts for translations of this email
                /** @var Email $translation */
                foreach ($emailSettings[$email->getId()]['translations'] as $translation) {
                    if ($translation->isPublished()) {
                        $emailSettings[$email->getId()]['sentCount'] += $translation->getSentCount();
                        $emailSettings[$email->getId()]['variantCount'] += $translation->getVariantSentCount();

                        // Prevent empty key due to misconfiguration - pretty much ignored
                        if (!$language = $translation->getLanguage()) {
                            $language = 'unknown';
                        }
                        $core = $this->getTranslationLocaleCore($language);
                        if (!isset($emailSettings[$email->getId()]['languages'][$core])) {
                            $emailSettings[$email->getId()]['languages'][$core] = [];
                        }
                        $emailSettings[$email->getId()]['languages'][$core][$language] = $translation->getId();
                    }
                }
            }

            if ($includeVariants) {
                //get a list of variants for A/B testing
                $childrenVariant = $email->getVariantChildren();

                if (count($childrenVariant)) {
                    $variantWeight = 0;
                    $totalSent     = $emailSettings[$email->getId()]['variantCount'];

                    foreach ($childrenVariant as $id => $child) {
                        if ($child->isPublished()) {
                            $useSlots = [];
                            if ($template = $child->getTemplate()) {
                                if (isset($slots[$template])) {
                                    $useSlots = $slots[$template];
                                } else {
                                    $slots[$template] = $this->themeHelper->getTheme($template)->getSlots('email');
                                    $useSlots         = $slots[$template];
                                }
                            }
                            $variantSettings                = $child->getVariantSettings();
                            $emailSettings[$child->getId()] = [
                                'template'     => $child->getTemplate(),
                                'slots'        => $useSlots,
                                'sentCount'    => $child->getSentCount(),
                                'variantCount' => $child->getVariantSentCount(),
                                'isVariant'    => null !== $email->getVariantStartDate(),
                                'weight'       => ($variantSettings['weight'] / 100),
                                'entity'       => $child,
                                'translations' => $child->getTranslations(true),
                                'languages'    => ['default' => $child->getId()]
                            ];

                            $variantWeight += $variantSettings['weight'];

                            if ($emailSettings[$child->getId()]['translations']) {
                                // Add in the sent counts for translations of this email
                                /** @var Email $translation */
                                foreach ($emailSettings[$child->getId()]['translations'] as $translation) {
                                    if ($translation->isPublished()) {
                                        $emailSettings[$child->getId()]['sentCount'] += $translation->getSentCount();
                                        $emailSettings[$child->getId()]['variantCount'] += $translation->getVariantSentCount();

                                        // Prevent empty key due to misconfiguration - pretty much ignored
                                        if (!$language = $translation->getLanguage()) {
                                            $language = 'unknown';
                                        }
                                        $core = $this->getTranslationLocaleCore($language);
                                        if (!isset($emailSettings[$child->getId()]['languages'][$core])) {
                                            $emailSettings[$child->getId()]['languages'][$core] = [];
                                        }
                                        $emailSettings[$child->getId()]['languages'][$core][$language] = $translation->getId();
                                    }
                                }
                            }

                            $totalSent += $emailSettings[$child->getId()]['sentCount'];
                        }
                    }

                    //set parent weight
                    $emailSettings[$email->getId()]['weight'] = ((100 - $variantWeight) / 100);

                    //now find what percentage of current leads should receive the variants
                    foreach ($emailSettings as $eid => &$details) {
                        $details['weight'] = ($totalSent)
                            ?
                            ($details['weight'] - ($details['variantCount'] / $totalSent)) + $details['weight']
                            :
                            $details['weight'];
                    }
                } else {
                    $emailSettings[$email->getId()]['weight'] = 1;
                }
            }
        }

        return $emailSettings;
    }

    /**
     * Send an email to lead(s)
     *
     * @param       $email
     * @param       $leads
     * @param       $options = array()
     *                       array source array('model', 'id')
     *                       array emailSettings
     *                       int   listId
     *                       bool  allowResends     If false, exact emails (by id) already sent to the lead will not be resent
     *                       bool  ignoreDNC        If true, emails listed in the do not contact table will still get the email
     *                       bool  sendBatchMail    If false, the function will not send batched mail but will defer to calling function to handle it
     *                       array assetAttachments Array of optional Asset IDs to attach
     *
     * @return mixed
     * @throws \Doctrine\ORM\ORMException
     */
||||||||    public function &getEmailSettings(Email $email, $includeVariants = true)
    {
        if (empty($this->emailSettings[$email->getId()])) {
            //used to house slots so they don't have to be fetched over and over for same template
            $slots = [];
            if ($template = $email->getTemplate()) {
                $slots[$template] = $this->themeHelper->getTheme($template)->getSlots('email');
            }

            //store the settings of all the variants in order to properly disperse the emails
            //set the parent's settings
            $emailSettings = [
                $email->getId() => [
                    'template'     => $email->getTemplate(),
                    'slots'        => $slots,
                    'sentCount'    => $email->getSentCount(),
                    'variantCount' => $email->getVariantSentCount(),
                    'isVariant'    => null !== $email->getVariantStartDate(),
                    'entity'       => $email,
                    'translations' => $email->getTranslations(true),
                    'languages'    => ['default' => $email->getId()]
                ],
            ];

            if ($emailSettings[$email->getId()]['translations']) {
                // Add in the sent counts for translations of this email
                /** @var Email $translation */
                foreach ($emailSettings[$email->getId()]['translations'] as $translation) {
                    if ($translation->isPublished()) {
                        $emailSettings[$email->getId()]['sentCount'] += $translation->getSentCount();
                        $emailSettings[$email->getId()]['variantCount'] += $translation->getVariantSentCount();

                        // Prevent empty key due to misconfiguration - pretty much ignored
                        if (!$language = $translation->getLanguage()) {
                            $language = 'unknown';
                        }
                        $core = $this->getTranslationLocaleCore($language);
                        if (!isset($emailSettings[$email->getId()]['languages'][$core])) {
                            $emailSettings[$email->getId()]['languages'][$core] = [];
                        }
                        $emailSettings[$email->getId()]['languages'][$core][$language] = $translation->getId();
                    }
                }
            }

            if ($includeVariants) {
                //get a list of variants for A/B testing
                $childrenVariant = $email->getVariantChildren();

                if (count($childrenVariant)) {
                    $variantWeight = 0;
                    $totalSent     = $emailSettings[$email->getId()]['variantCount'];

                    foreach ($childrenVariant as $id => $child) {
                        if ($child->isPublished()) {
                            $useSlots = [];
                            if ($template = $child->getTemplate()) {
                                if (isset($slots[$template])) {
                                    $useSlots = $slots[$template];
                                } else {
                                    $slots[$template] = $this->themeHelper->getTheme($template)->getSlots('email');
                                    $useSlots         = $slots[$template];
                                }
                            }
                            $variantSettings                = $child->getVariantSettings();
                            $emailSettings[$child->getId()] = [
                                'template'     => $child->getTemplate(),
                                'slots'        => $useSlots,
                                'sentCount'    => $child->getSentCount(),
                                'variantCount' => $child->getVariantSentCount(),
                                'isVariant'    => null !== $email->getVariantStartDate(),
                                'weight'       => ($variantSettings['weight'] / 100),
                                'entity'       => $child,
                                'translations' => $child->getTranslations(true),
                                'languages'    => ['default' => $child->getId()]
                            ];

                            $variantWeight += $variantSettings['weight'];

                            if ($emailSettings[$child->getId()]['translations']) {
                                // Add in the sent counts for translations of this email
                                /** @var Email $translation */
                                foreach ($emailSettings[$child->getId()]['translations'] as $translation) {
                                    if ($translation->isPublished()) {
                                        $emailSettings[$child->getId()]['sentCount'] += $translation->getSentCount();
                                        $emailSettings[$child->getId()]['variantCount'] += $translation->getVariantSentCount();

                                        // Prevent empty key due to misconfiguration - pretty much ignored
                                        if (!$language = $translation->getLanguage()) {
                                            $language = 'unknown';
                                        }
                                        $core = $this->getTranslationLocaleCore($language);
                                        if (!isset($emailSettings[$child->getId()]['languages'][$core])) {
                                            $emailSettings[$child->getId()]['languages'][$core] = [];
                                        }
                                        $emailSettings[$child->getId()]['languages'][$core][$language] = $translation->getId();
                                    }
                                }
                            }

                            $totalSent += $emailSettings[$child->getId()]['sentCount'];
                        }
                    }

                    //set parent weight
                    $emailSettings[$email->getId()]['weight'] = ((100 - $variantWeight) / 100);

                    //now find what percentage of current leads should receive the variants
                    foreach ($emailSettings as $eid => $details) {
                        $emailSettings[$eid]['weight'] = ($totalSent)
                            ?
                            ($details['weight'] - ($details['variantCount'] / $totalSent)) + $details['weight']
                            :
                            $details['weight'];
                    }
                } else {
                    $emailSettings[$email->getId()]['weight'] = 1;
                }
            }

            $this->emailSettings[$email->getId()] = $emailSettings;
        } else {
            // Reorder according to variantSentCount so that campaigns which currently send one at a time alternate
            uasort($this->emailSettings[$email->getId()], function($a, $b) {
               if ($a['isVariant']) {
                   return ($a['variantCount'] < $b['variantCount']) ? -1 : 1;
               }

               return 0;
            });
        }

        return $this->emailSettings[$email->getId()];
    }

    /**
     * Send an email to lead(s)
     *
     * @param       $email
     * @param       $leads
     * @param       $options = array()
     *                       array source array('model', 'id')
     *                       array emailSettings
     *                       int   listId
     *                       bool  allowResends     If false, exact emails (by id) already sent to the lead will not be resent
     *                       bool  ignoreDNC        If true, emails listed in the do not contact table will still get the email
     *                       bool  sendBatchMail    If false, the function will not send batched mail but will defer to calling function to handle it
     *                       array assetAttachments Array of optional Asset IDs to attach
     *
     * @return mixed
     * @throws \Doctrine\ORM\ORMException
     */
||||||||HAS_DOC_COMMENTNO_RETURN_TYPE
(PARAM_TYPENO_PARAM_DEFAULTNO_PARAM_TYPEPARAM_DEFAULT)
(
    (AST_STATIC
        (AST_VAR)
        (AST_ARRAY))
    (AST_IF
        (AST_IF_ELEM
            (AST_EMPTY
                (AST_DIM
                    (AST_VAR)
                    (AST_METHOD_CALL
                        (AST_VAR))))
            (
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_ARRAY))
                (AST_IF
                    (AST_IF_ELEM
                        (AST_ASSIGN
                            (AST_VAR)
                            (AST_METHOD_CALL
                                (AST_VAR)))
                        (
                            (AST_ASSIGN
                                (AST_DIM
                                    (AST_VAR)
                                    (AST_VAR))
                                (AST_METHOD_CALL
                                    (AST_METHOD_CALL
                                        (AST_PROP
                                            (AST_VAR))
                                        (
                                            (AST_VAR)))
                                    (
                                        (SCALAR)))))))
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_ARRAY
                        (AST_ARRAY_ELEM
                            (AST_ARRAY
                                (AST_ARRAY_ELEM
                                    (AST_METHOD_CALL
                                        (AST_VAR))
                                    (SCALAR))
                                (AST_ARRAY_ELEM
                                    (AST_VAR)
                                    (SCALAR))
                                (AST_ARRAY_ELEM
                                    (AST_METHOD_CALL
                                        (AST_VAR))
                                    (SCALAR))
                                (AST_ARRAY_ELEM
                                    (AST_METHOD_CALL
                                        (AST_VAR))
                                    (SCALAR))
                                (AST_ARRAY_ELEM
                                    (AST_BINARY_OP
                                        (AST_CONST)
                                        (AST_METHOD_CALL
                                            (AST_VAR)))
                                    (SCALAR))
                                (AST_ARRAY_ELEM
                                    (AST_VAR)
                                    (SCALAR))
                                (AST_ARRAY_ELEM
                                    (AST_METHOD_CALL
                                        (AST_VAR)
                                        (
                                            (AST_CONST)))
                                    (SCALAR))
                                (AST_ARRAY_ELEM
                                    (AST_ARRAY
                                        (AST_ARRAY_ELEM
                                            (AST_METHOD_CALL
                                                (AST_VAR))
                                            (SCALAR)))
                                    (SCALAR)))
                            (AST_METHOD_CALL
                                (AST_VAR)))))
                (AST_IF
                    (AST_IF_ELEM
                        (AST_DIM
                            (AST_DIM
                                (AST_VAR)
                                (AST_METHOD_CALL
                                    (AST_VAR)))
                            (SCALAR))
                        (
                            (AST_FOREACH
                                (AST_DIM
                                    (AST_DIM
                                        (AST_VAR)
                                        (AST_METHOD_CALL
                                            (AST_VAR)))
                                    (SCALAR))
                                (AST_VAR)
                                (NULL)
                                (
                                    (AST_IF
                                        (AST_IF_ELEM
                                            (AST_METHOD_CALL
                                                (AST_VAR))
                                            (
                                                (AST_ASSIGN_OP
                                                    (AST_DIM
                                                        (AST_DIM
                                                            (AST_VAR)
                                                            (AST_METHOD_CALL
                                                                (AST_VAR)))
                                                        (SCALAR))
                                                    (AST_METHOD_CALL
                                                        (AST_VAR)))
                                                (AST_ASSIGN_OP
                                                    (AST_DIM
                                                        (AST_DIM
                                                            (AST_VAR)
                                                            (AST_METHOD_CALL
                                                                (AST_VAR)))
                                                        (SCALAR))
                                                    (AST_METHOD_CALL
                                                        (AST_VAR)))
                                                (AST_IF
                                                    (AST_IF_ELEM
                                                        (AST_UNARY_OP
                                                            (AST_ASSIGN
                                                                (AST_VAR)
                                                                (AST_METHOD_CALL
                                                                    (AST_VAR))))
                                                        (
                                                            (AST_ASSIGN
                                                                (AST_VAR)
                                                                (SCALAR)))))
                                                (AST_ASSIGN
                                                    (AST_VAR)
                                                    (AST_METHOD_CALL
                                                        (AST_VAR)
                                                        (
                                                            (AST_VAR))))
                                                (AST_IF
                                                    (AST_IF_ELEM
                                                        (AST_UNARY_OP
                                                            (AST_ISSET
                                                                (AST_DIM
                                                                    (AST_DIM
                                                                        (AST_DIM
                                                                            (AST_VAR)
                                                                            (AST_METHOD_CALL
                                                                                (AST_VAR)))
                                                                        (SCALAR))
                                                                    (AST_VAR))))
                                                        (
                                                            (AST_ASSIGN
                                                                (AST_DIM
                                                                    (AST_DIM
                                                                        (AST_DIM
                                                                            (AST_VAR)
                                                                            (AST_METHOD_CALL
                                                                                (AST_VAR)))
                                                                        (SCALAR))
                                                                    (AST_VAR))
                                                                (AST_ARRAY)))))
                                                (AST_ASSIGN
                                                    (AST_DIM
                                                        (AST_DIM
                                                            (AST_DIM
                                                                (AST_DIM
                                                                    (AST_VAR)
                                                                    (AST_METHOD_CALL
                                                                        (AST_VAR)))
                                                                (SCALAR))
                                                            (AST_VAR))
                                                        (AST_VAR))
                                                    (AST_METHOD_CALL
                                                        (AST_VAR)))))))))))
                (AST_IF
                    (AST_IF_ELEM
                        (AST_VAR)
                        (
                            (AST_ASSIGN
                                (AST_VAR)
                                (AST_METHOD_CALL
                                    (AST_VAR)))
                            (AST_IF
                                (AST_IF_ELEM
                                    (AST_CALL
                                        (
                                            (AST_VAR)))
                                    (
                                        (AST_ASSIGN
                                            (AST_VAR)
                                            (SCALAR))
                                        (AST_ASSIGN
                                            (AST_VAR)
                                            (AST_DIM
                                                (AST_DIM
                                                    (AST_VAR)
                                                    (AST_METHOD_CALL
                                                        (AST_VAR)))
                                                (SCALAR)))
                                        (AST_FOREACH
                                            (AST_VAR)
                                            (AST_VAR)
                                            (AST_VAR)
                                            (
                                                (AST_IF
                                                    (AST_IF_ELEM
                                                        (AST_METHOD_CALL
                                                            (AST_VAR))
                                                        (
                                                            (AST_ASSIGN
                                                                (AST_VAR)
                                                                (AST_ARRAY))
                                                            (AST_IF
                                                                (AST_IF_ELEM
                                                                    (AST_ASSIGN
                                                                        (AST_VAR)
                                                                        (AST_METHOD_CALL
                                                                            (AST_VAR)))
                                                                    (
                                                                        (AST_IF
                                                                            (AST_IF_ELEM
                                                                                (AST_ISSET
                                                                                    (AST_DIM
                                                                                        (AST_VAR)
                                                                                        (AST_VAR)))
                                                                                (
                                                                                    (AST_ASSIGN
                                                                                        (AST_VAR)
                                                                                        (AST_DIM
                                                                                            (AST_VAR)
                                                                                            (AST_VAR)))))
                                                                            (AST_IF_ELEM
                                                                                (NULL)
                                                                                (
                                                                                    (AST_ASSIGN
                                                                                        (AST_DIM
                                                                                            (AST_VAR)
                                                                                            (AST_VAR))
                                                                                        (AST_METHOD_CALL
                                                                                            (AST_METHOD_CALL
                                                                                                (AST_PROP
                                                                                                    (AST_VAR))
                                                                                                (
                                                                                                    (AST_VAR)))
                                                                                            (
                                                                                                (SCALAR))))
                                                                                    (AST_ASSIGN
                                                                                        (AST_VAR)
                                                                                        (AST_DIM
                                                                                            (AST_VAR)
                                                                                            (AST_VAR)))))))))
                                                            (AST_ASSIGN
                                                                (AST_VAR)
                                                                (AST_METHOD_CALL
                                                                    (AST_VAR)))
                                                            (AST_ASSIGN
                                                                (AST_DIM
                                                                    (AST_VAR)
                                                                    (AST_METHOD_CALL
                                                                        (AST_VAR)))
                                                                (AST_ARRAY
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_METHOD_CALL
                                                                            (AST_VAR))
                                                                        (SCALAR))
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_VAR)
                                                                        (SCALAR))
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_METHOD_CALL
                                                                            (AST_VAR))
                                                                        (SCALAR))
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_METHOD_CALL
                                                                            (AST_VAR))
                                                                        (SCALAR))
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_BINARY_OP
                                                                            (AST_CONST)
                                                                            (AST_METHOD_CALL
                                                                                (AST_VAR)))
                                                                        (SCALAR))
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_BINARY_OP
                                                                            (AST_DIM
                                                                                (AST_VAR)
                                                                                (SCALAR))
                                                                            (SCALAR))
                                                                        (SCALAR))
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_VAR)
                                                                        (SCALAR))
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_METHOD_CALL
                                                                            (AST_VAR)
                                                                            (
                                                                                (AST_CONST)))
                                                                        (SCALAR))
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_ARRAY
                                                                            (AST_ARRAY_ELEM
                                                                                (AST_METHOD_CALL
                                                                                    (AST_VAR))
                                                                                (SCALAR)))
                                                                        (SCALAR))))
                                                            (AST_ASSIGN_OP
                                                                (AST_VAR)
                                                                (AST_DIM
                                                                    (AST_VAR)
                                                                    (SCALAR)))
                                                            (AST_IF
                                                                (AST_IF_ELEM
                                                                    (AST_DIM
                                                                        (AST_DIM
                                                                            (AST_VAR)
                                                                            (AST_METHOD_CALL
                                                                                (AST_VAR)))
                                                                        (SCALAR))
                                                                    (
                                                                        (AST_FOREACH
                                                                            (AST_DIM
                                                                                (AST_DIM
                                                                                    (AST_VAR)
                                                                                    (AST_METHOD_CALL
                                                                                        (AST_VAR)))
                                                                                (SCALAR))
                                                                            (AST_VAR)
                                                                            (NULL)
                                                                            (
                                                                                (AST_IF
                                                                                    (AST_IF_ELEM
                                                                                        (AST_METHOD_CALL
                                                                                            (AST_VAR))
                                                                                        (
                                                                                            (AST_ASSIGN_OP
                                                                                                (AST_DIM
                                                                                                    (AST_DIM
                                                                                                        (AST_VAR)
                                                                                                        (AST_METHOD_CALL
                                                                                                            (AST_VAR)))
                                                                                                    (SCALAR))
                                                                                                (AST_METHOD_CALL
                                                                                                    (AST_VAR)))
                                                                                            (AST_ASSIGN_OP
                                                                                                (AST_DIM
                                                                                                    (AST_DIM
                                                                                                        (AST_VAR)
                                                                                                        (AST_METHOD_CALL
                                                                                                            (AST_VAR)))
                                                                                                    (SCALAR))
                                                                                                (AST_METHOD_CALL
                                                                                                    (AST_VAR)))
                                                                                            (AST_IF
                                                                                                (AST_IF_ELEM
                                                                                                    (AST_UNARY_OP
                                                                                                        (AST_ASSIGN
                                                                                                            (AST_VAR)
                                                                                                            (AST_METHOD_CALL
                                                                                                                (AST_VAR))))
                                                                                                    (
                                                                                                        (AST_ASSIGN
                                                                                                            (AST_VAR)
                                                                                                            (SCALAR)))))
                                                                                            (AST_ASSIGN
                                                                                                (AST_VAR)
                                                                                                (AST_METHOD_CALL
                                                                                                    (AST_VAR)
                                                                                                    (
                                                                                                        (AST_VAR))))
                                                                                            (AST_IF
                                                                                                (AST_IF_ELEM
                                                                                                    (AST_UNARY_OP
                                                                                                        (AST_ISSET
                                                                                                            (AST_DIM
                                                                                                                (AST_DIM
                                                                                                                    (AST_DIM
                                                                                                                        (AST_VAR)
                                                                                                                        (AST_METHOD_CALL
                                                                                                                            (AST_VAR)))
                                                                                                                    (SCALAR))
                                                                                                                (AST_VAR))))
                                                                                                    (
                                                                                                        (AST_ASSIGN
                                                                                                            (AST_DIM
                                                                                                                (AST_DIM
                                                                                                                    (AST_DIM
                                                                                                                        (AST_VAR)
                                                                                                                        (AST_METHOD_CALL
                                                                                                                            (AST_VAR)))
                                                                                                                    (SCALAR))
                                                                                                                (AST_VAR))
                                                                                                            (AST_ARRAY)))))
                                                                                            (AST_ASSIGN
                                                                                                (AST_DIM
                                                                                                    (AST_DIM
                                                                                                        (AST_DIM
                                                                                                            (AST_DIM
                                                                                                                (AST_VAR)
                                                                                                                (AST_METHOD_CALL
                                                                                                                    (AST_VAR)))
                                                                                                            (SCALAR))
                                                                                                        (AST_VAR))
                                                                                                    (AST_VAR))
                                                                                                (AST_METHOD_CALL
                                                                                                    (AST_VAR)))))))))))
                                                            (AST_ASSIGN_OP
                                                                (AST_VAR)
                                                                (AST_DIM
                                                                    (AST_DIM
                                                                        (AST_VAR)
                                                                        (AST_METHOD_CALL
                                                                            (AST_VAR)))
                                                                    (SCALAR))))))))
                                        (AST_ASSIGN
                                            (AST_DIM
                                                (AST_DIM
                                                    (AST_VAR)
                                                    (AST_METHOD_CALL
                                                        (AST_VAR)))
                                                (SCALAR))
                                            (AST_BINARY_OP
                                                (AST_BINARY_OP
                                                    (SCALAR)
                                                    (AST_VAR))
                                                (SCALAR)))
                                        (AST_FOREACH
                                            (AST_VAR)
                                            (AST_REF
                                                (AST_VAR))
                                            (AST_VAR)
                                            (
                                                (AST_ASSIGN
                                                    (AST_DIM
                                                        (AST_VAR)
                                                        (SCALAR))
                                                    (AST_CONDITIONAL
                                                        (AST_VAR)
                                                        (AST_BINARY_OP
                                                            (AST_BINARY_OP
                                                                (AST_DIM
                                                                    (AST_VAR)
                                                                    (SCALAR))
                                                                (AST_BINARY_OP
                                                                    (AST_DIM
                                                                        (AST_VAR)
                                                                        (SCALAR))
                                                                    (AST_VAR)))
                                                            (AST_DIM
                                                                (AST_VAR)
                                                                (SCALAR)))
                                                        (AST_DIM
                                                            (AST_VAR)
                                                            (SCALAR))))))))
                                (AST_IF_ELEM
                                    (NULL)
                                    (
                                        (AST_ASSIGN
                                            (AST_DIM
                                                (AST_DIM
                                                    (AST_VAR)
                                                    (AST_METHOD_CALL
                                                        (AST_VAR)))
                                                (SCALAR))
                                            (SCALAR)))))))))))
    (AST_RETURN
        (AST_VAR)))||||||||HAS_DOC_COMMENTNO_RETURN_TYPE
(PARAM_TYPENO_PARAM_DEFAULTNO_PARAM_TYPEPARAM_DEFAULT)
(
    (AST_IF
        (AST_IF_ELEM
            (AST_EMPTY
                (AST_DIM
                    (AST_PROP
                        (AST_VAR))
                    (AST_METHOD_CALL
                        (AST_VAR))))
            (
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_ARRAY))
                (AST_IF
                    (AST_IF_ELEM
                        (AST_ASSIGN
                            (AST_VAR)
                            (AST_METHOD_CALL
                                (AST_VAR)))
                        (
                            (AST_ASSIGN
                                (AST_DIM
                                    (AST_VAR)
                                    (AST_VAR))
                                (AST_METHOD_CALL
                                    (AST_METHOD_CALL
                                        (AST_PROP
                                            (AST_VAR))
                                        (
                                            (AST_VAR)))
                                    (
                                        (SCALAR)))))))
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_ARRAY
                        (AST_ARRAY_ELEM
                            (AST_ARRAY
                                (AST_ARRAY_ELEM
                                    (AST_METHOD_CALL
                                        (AST_VAR))
                                    (SCALAR))
                                (AST_ARRAY_ELEM
                                    (AST_VAR)
                                    (SCALAR))
                                (AST_ARRAY_ELEM
                                    (AST_METHOD_CALL
                                        (AST_VAR))
                                    (SCALAR))
                                (AST_ARRAY_ELEM
                                    (AST_METHOD_CALL
                                        (AST_VAR))
                                    (SCALAR))
                                (AST_ARRAY_ELEM
                                    (AST_BINARY_OP
                                        (AST_CONST)
                                        (AST_METHOD_CALL
                                            (AST_VAR)))
                                    (SCALAR))
                                (AST_ARRAY_ELEM
                                    (AST_VAR)
                                    (SCALAR))
                                (AST_ARRAY_ELEM
                                    (AST_METHOD_CALL
                                        (AST_VAR)
                                        (
                                            (AST_CONST)))
                                    (SCALAR))
                                (AST_ARRAY_ELEM
                                    (AST_ARRAY
                                        (AST_ARRAY_ELEM
                                            (AST_METHOD_CALL
                                                (AST_VAR))
                                            (SCALAR)))
                                    (SCALAR)))
                            (AST_METHOD_CALL
                                (AST_VAR)))))
                (AST_IF
                    (AST_IF_ELEM
                        (AST_DIM
                            (AST_DIM
                                (AST_VAR)
                                (AST_METHOD_CALL
                                    (AST_VAR)))
                            (SCALAR))
                        (
                            (AST_FOREACH
                                (AST_DIM
                                    (AST_DIM
                                        (AST_VAR)
                                        (AST_METHOD_CALL
                                            (AST_VAR)))
                                    (SCALAR))
                                (AST_VAR)
                                (NULL)
                                (
                                    (AST_IF
                                        (AST_IF_ELEM
                                            (AST_METHOD_CALL
                                                (AST_VAR))
                                            (
                                                (AST_ASSIGN_OP
                                                    (AST_DIM
                                                        (AST_DIM
                                                            (AST_VAR)
                                                            (AST_METHOD_CALL
                                                                (AST_VAR)))
                                                        (SCALAR))
                                                    (AST_METHOD_CALL
                                                        (AST_VAR)))
                                                (AST_ASSIGN_OP
                                                    (AST_DIM
                                                        (AST_DIM
                                                            (AST_VAR)
                                                            (AST_METHOD_CALL
                                                                (AST_VAR)))
                                                        (SCALAR))
                                                    (AST_METHOD_CALL
                                                        (AST_VAR)))
                                                (AST_IF
                                                    (AST_IF_ELEM
                                                        (AST_UNARY_OP
                                                            (AST_ASSIGN
                                                                (AST_VAR)
                                                                (AST_METHOD_CALL
                                                                    (AST_VAR))))
                                                        (
                                                            (AST_ASSIGN
                                                                (AST_VAR)
                                                                (SCALAR)))))
                                                (AST_ASSIGN
                                                    (AST_VAR)
                                                    (AST_METHOD_CALL
                                                        (AST_VAR)
                                                        (
                                                            (AST_VAR))))
                                                (AST_IF
                                                    (AST_IF_ELEM
                                                        (AST_UNARY_OP
                                                            (AST_ISSET
                                                                (AST_DIM
                                                                    (AST_DIM
                                                                        (AST_DIM
                                                                            (AST_VAR)
                                                                            (AST_METHOD_CALL
                                                                                (AST_VAR)))
                                                                        (SCALAR))
                                                                    (AST_VAR))))
                                                        (
                                                            (AST_ASSIGN
                                                                (AST_DIM
                                                                    (AST_DIM
                                                                        (AST_DIM
                                                                            (AST_VAR)
                                                                            (AST_METHOD_CALL
                                                                                (AST_VAR)))
                                                                        (SCALAR))
                                                                    (AST_VAR))
                                                                (AST_ARRAY)))))
                                                (AST_ASSIGN
                                                    (AST_DIM
                                                        (AST_DIM
                                                            (AST_DIM
                                                                (AST_DIM
                                                                    (AST_VAR)
                                                                    (AST_METHOD_CALL
                                                                        (AST_VAR)))
                                                                (SCALAR))
                                                            (AST_VAR))
                                                        (AST_VAR))
                                                    (AST_METHOD_CALL
                                                        (AST_VAR)))))))))))
                (AST_IF
                    (AST_IF_ELEM
                        (AST_VAR)
                        (
                            (AST_ASSIGN
                                (AST_VAR)
                                (AST_METHOD_CALL
                                    (AST_VAR)))
                            (AST_IF
                                (AST_IF_ELEM
                                    (AST_CALL
                                        (
                                            (AST_VAR)))
                                    (
                                        (AST_ASSIGN
                                            (AST_VAR)
                                            (SCALAR))
                                        (AST_ASSIGN
                                            (AST_VAR)
                                            (AST_DIM
                                                (AST_DIM
                                                    (AST_VAR)
                                                    (AST_METHOD_CALL
                                                        (AST_VAR)))
                                                (SCALAR)))
                                        (AST_FOREACH
                                            (AST_VAR)
                                            (AST_VAR)
                                            (AST_VAR)
                                            (
                                                (AST_IF
                                                    (AST_IF_ELEM
                                                        (AST_METHOD_CALL
                                                            (AST_VAR))
                                                        (
                                                            (AST_ASSIGN
                                                                (AST_VAR)
                                                                (AST_ARRAY))
                                                            (AST_IF
                                                                (AST_IF_ELEM
                                                                    (AST_ASSIGN
                                                                        (AST_VAR)
                                                                        (AST_METHOD_CALL
                                                                            (AST_VAR)))
                                                                    (
                                                                        (AST_IF
                                                                            (AST_IF_ELEM
                                                                                (AST_ISSET
                                                                                    (AST_DIM
                                                                                        (AST_VAR)
                                                                                        (AST_VAR)))
                                                                                (
                                                                                    (AST_ASSIGN
                                                                                        (AST_VAR)
                                                                                        (AST_DIM
                                                                                            (AST_VAR)
                                                                                            (AST_VAR)))))
                                                                            (AST_IF_ELEM
                                                                                (NULL)
                                                                                (
                                                                                    (AST_ASSIGN
                                                                                        (AST_DIM
                                                                                            (AST_VAR)
                                                                                            (AST_VAR))
                                                                                        (AST_METHOD_CALL
                                                                                            (AST_METHOD_CALL
                                                                                                (AST_PROP
                                                                                                    (AST_VAR))
                                                                                                (
                                                                                                    (AST_VAR)))
                                                                                            (
                                                                                                (SCALAR))))
                                                                                    (AST_ASSIGN
                                                                                        (AST_VAR)
                                                                                        (AST_DIM
                                                                                            (AST_VAR)
                                                                                            (AST_VAR)))))))))
                                                            (AST_ASSIGN
                                                                (AST_VAR)
                                                                (AST_METHOD_CALL
                                                                    (AST_VAR)))
                                                            (AST_ASSIGN
                                                                (AST_DIM
                                                                    (AST_VAR)
                                                                    (AST_METHOD_CALL
                                                                        (AST_VAR)))
                                                                (AST_ARRAY
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_METHOD_CALL
                                                                            (AST_VAR))
                                                                        (SCALAR))
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_VAR)
                                                                        (SCALAR))
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_METHOD_CALL
                                                                            (AST_VAR))
                                                                        (SCALAR))
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_METHOD_CALL
                                                                            (AST_VAR))
                                                                        (SCALAR))
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_BINARY_OP
                                                                            (AST_CONST)
                                                                            (AST_METHOD_CALL
                                                                                (AST_VAR)))
                                                                        (SCALAR))
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_BINARY_OP
                                                                            (AST_DIM
                                                                                (AST_VAR)
                                                                                (SCALAR))
                                                                            (SCALAR))
                                                                        (SCALAR))
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_VAR)
                                                                        (SCALAR))
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_METHOD_CALL
                                                                            (AST_VAR)
                                                                            (
                                                                                (AST_CONST)))
                                                                        (SCALAR))
                                                                    (AST_ARRAY_ELEM
                                                                        (AST_ARRAY
                                                                            (AST_ARRAY_ELEM
                                                                                (AST_METHOD_CALL
                                                                                    (AST_VAR))
                                                                                (SCALAR)))
                                                                        (SCALAR))))
                                                            (AST_ASSIGN_OP
                                                                (AST_VAR)
                                                                (AST_DIM
                                                                    (AST_VAR)
                                                                    (SCALAR)))
                                                            (AST_IF
                                                                (AST_IF_ELEM
                                                                    (AST_DIM
                                                                        (AST_DIM
                                                                            (AST_VAR)
                                                                            (AST_METHOD_CALL
                                                                                (AST_VAR)))
                                                                        (SCALAR))
                                                                    (
                                                                        (AST_FOREACH
                                                                            (AST_DIM
                                                                                (AST_DIM
                                                                                    (AST_VAR)
                                                                                    (AST_METHOD_CALL
                                                                                        (AST_VAR)))
                                                                                (SCALAR))
                                                                            (AST_VAR)
                                                                            (NULL)
                                                                            (
                                                                                (AST_IF
                                                                                    (AST_IF_ELEM
                                                                                        (AST_METHOD_CALL
                                                                                            (AST_VAR))
                                                                                        (
                                                                                            (AST_ASSIGN_OP
                                                                                                (AST_DIM
                                                                                                    (AST_DIM
                                                                                                        (AST_VAR)
                                                                                                        (AST_METHOD_CALL
                                                                                                            (AST_VAR)))
                                                                                                    (SCALAR))
                                                                                                (AST_METHOD_CALL
                                                                                                    (AST_VAR)))
                                                                                            (AST_ASSIGN_OP
                                                                                                (AST_DIM
                                                                                                    (AST_DIM
                                                                                                        (AST_VAR)
                                                                                                        (AST_METHOD_CALL
                                                                                                            (AST_VAR)))
                                                                                                    (SCALAR))
                                                                                                (AST_METHOD_CALL
                                                                                                    (AST_VAR)))
                                                                                            (AST_IF
                                                                                                (AST_IF_ELEM
                                                                                                    (AST_UNARY_OP
                                                                                                        (AST_ASSIGN
                                                                                                            (AST_VAR)
                                                                                                            (AST_METHOD_CALL
                                                                                                                (AST_VAR))))
                                                                                                    (
                                                                                                        (AST_ASSIGN
                                                                                                            (AST_VAR)
                                                                                                            (SCALAR)))))
                                                                                            (AST_ASSIGN
                                                                                                (AST_VAR)
                                                                                                (AST_METHOD_CALL
                                                                                                    (AST_VAR)
                                                                                                    (
                                                                                                        (AST_VAR))))
                                                                                            (AST_IF
                                                                                                (AST_IF_ELEM
                                                                                                    (AST_UNARY_OP
                                                                                                        (AST_ISSET
                                                                                                            (AST_DIM
                                                                                                                (AST_DIM
                                                                                                                    (AST_DIM
                                                                                                                        (AST_VAR)
                                                                                                                        (AST_METHOD_CALL
                                                                                                                            (AST_VAR)))
                                                                                                                    (SCALAR))
                                                                                                                (AST_VAR))))
                                                                                                    (
                                                                                                        (AST_ASSIGN
                                                                                                            (AST_DIM
                                                                                                                (AST_DIM
                                                                                                                    (AST_DIM
                                                                                                                        (AST_VAR)
                                                                                                                        (AST_METHOD_CALL
                                                                                                                            (AST_VAR)))
                                                                                                                    (SCALAR))
                                                                                                                (AST_VAR))
                                                                                                            (AST_ARRAY)))))
                                                                                            (AST_ASSIGN
                                                                                                (AST_DIM
                                                                                                    (AST_DIM
                                                                                                        (AST_DIM
                                                                                                            (AST_DIM
                                                                                                                (AST_VAR)
                                                                                                                (AST_METHOD_CALL
                                                                                                                    (AST_VAR)))
                                                                                                            (SCALAR))
                                                                                                        (AST_VAR))
                                                                                                    (AST_VAR))
                                                                                                (AST_METHOD_CALL
                                                                                                    (AST_VAR)))))))))))
                                                            (AST_ASSIGN_OP
                                                                (AST_VAR)
                                                                (AST_DIM
                                                                    (AST_DIM
                                                                        (AST_VAR)
                                                                        (AST_METHOD_CALL
                                                                            (AST_VAR)))
                                                                    (SCALAR))))))))
                                        (AST_ASSIGN
                                            (AST_DIM
                                                (AST_DIM
                                                    (AST_VAR)
                                                    (AST_METHOD_CALL
                                                        (AST_VAR)))
                                                (SCALAR))
                                            (AST_BINARY_OP
                                                (AST_BINARY_OP
                                                    (SCALAR)
                                                    (AST_VAR))
                                                (SCALAR)))
                                        (AST_FOREACH
                                            (AST_VAR)
                                            (AST_VAR)
                                            (AST_VAR)
                                            (
                                                (AST_ASSIGN
                                                    (AST_DIM
                                                        (AST_DIM
                                                            (AST_VAR)
                                                            (AST_VAR))
                                                        (SCALAR))
                                                    (AST_CONDITIONAL
                                                        (AST_VAR)
                                                        (AST_BINARY_OP
                                                            (AST_BINARY_OP
                                                                (AST_DIM
                                                                    (AST_VAR)
                                                                    (SCALAR))
                                                                (AST_BINARY_OP
                                                                    (AST_DIM
                                                                        (AST_VAR)
                                                                        (SCALAR))
                                                                    (AST_VAR)))
                                                            (AST_DIM
                                                                (AST_VAR)
                                                                (SCALAR)))
                                                        (AST_DIM
                                                            (AST_VAR)
                                                            (SCALAR))))))))
                                (AST_IF_ELEM
                                    (NULL)
                                    (
                                        (AST_ASSIGN
                                            (AST_DIM
                                                (AST_DIM
                                                    (AST_VAR)
                                                    (AST_METHOD_CALL
                                                        (AST_VAR)))
                                                (SCALAR))
                                            (SCALAR))))))))
                (AST_ASSIGN
                    (AST_DIM
                        (AST_PROP
                            (AST_VAR))
                        (AST_METHOD_CALL
                            (AST_VAR)))
                    (AST_VAR))))
        (AST_IF_ELEM
            (NULL)
            (
                (AST_CALL
                    (
                        (AST_DIM
                            (AST_PROP
                                (AST_VAR))
                            (AST_METHOD_CALL
                                (AST_VAR)))
                        (AST_CLOSURE
                            (NO_PARAM_TYPENO_PARAM_DEFAULTNO_PARAM_TYPENO_PARAM_DEFAULT)
                            (NULL)
                            (
                                (AST_IF
                                    (AST_IF_ELEM
                                        (AST_DIM
                                            (AST_VAR)
                                            (SCALAR))
                                        (
                                            (AST_RETURN
                                                (AST_CONDITIONAL
                                                    (AST_BINARY_OP
                                                        (AST_DIM
                                                            (AST_VAR)
                                                            (SCALAR))
                                                        (AST_DIM
                                                            (AST_VAR)
                                                            (SCALAR)))
                                                    (AST_UNARY_OP
                                                        (SCALAR))
                                                    (SCALAR))))))
                                (AST_RETURN
                                    (SCALAR)))))))))
    (AST_RETURN
        (AST_DIM
            (AST_PROP
                (AST_VAR))
            (AST_METHOD_CALL
                (AST_VAR)))))