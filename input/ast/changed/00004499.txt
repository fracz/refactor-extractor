	public function _readPpsWks($blockId)
	{
		$fh = $this->getStream($blockId);
		for ($pos = 0; ; $pos += 128) {
			fseek($fh, $pos, SEEK_SET);
			$nameUtf16 = fread($fh, 64);
			$nameLength = $this->_readInt2($fh);
			$nameUtf16 = substr($nameUtf16, 0, $nameLength - 2);
			// Simple conversion from UTF-16LE to ISO-8859-1
			$name = str_replace("\x00", "", $nameUtf16);
			$type = $this->_readInt1($fh);
			switch ($type) {
			case self::OLE_PPS_TYPE_ROOT:
				$pps = new PHPExcel_Shared_OLE_PPS_Root(null, null, array());
				$this->root = $pps;
				break;
			case self::OLE_PPS_TYPE_DIR:
				$pps = new PHPExcel_Shared_OLE_PPS(null, null, null, null, null,
								   null, null, null, null, array());
				break;
			case self::OLE_PPS_TYPE_FILE:
				$pps = new PHPExcel_Shared_OLE_PPS_File($name);
				break;
			default:
				continue;
			}
			fseek($fh, 1, SEEK_CUR);
			$pps->Type    = $type;
			$pps->Name    = $name;
			$pps->PrevPps = $this->_readInt4($fh);
			$pps->NextPps = $this->_readInt4($fh);
			$pps->DirPps  = $this->_readInt4($fh);
			fseek($fh, 20, SEEK_CUR);
			$pps->Time1st = self::OLE2LocalDate(fread($fh, 8));
			$pps->Time2nd = self::OLE2LocalDate(fread($fh, 8));
			$pps->_StartBlock = $this->_readInt4($fh);
			$pps->Size = $this->_readInt4($fh);
			$pps->No = count($this->_list);
			$this->_list[] = $pps;

			// check if the PPS tree (starting from root) is complete
			if (isset($this->root) &&
				$this->_ppsTreeComplete($this->root->No)) {

				break;
			}
		}
		fclose($fh);

		// Initialize $pps->children on directories
		foreach ($this->_list as $pps) {
			if ($pps->Type == self::OLE_PPS_TYPE_DIR || $pps->Type == self::OLE_PPS_TYPE_ROOT) {
				$nos = array($pps->DirPps);
				$pps->children = array();
				while ($nos) {
					$no = array_pop($nos);
					if ($no != -1) {
						$childPps = $this->_list[$no];
						$nos[] = $childPps->PrevPps;
						$nos[] = $childPps->NextPps;
						$pps->children[] = $childPps;
					}
				}
			}
		}

		return true;
	}

	/**
	* It checks whether the PPS tree is complete (all PPS's read)
	* starting with the given PPS (not necessarily root)
	*
	* @access public
	* @param integer $index The index of the PPS from which we are checking
	* @return boolean Whether the PPS tree for the given PPS is complete
	*/
||||||||	public function _readPpsWks($blockId)
	{
		$fh = $this->getStream($blockId);
		for ($pos = 0; ; $pos += 128) {
			fseek($fh, $pos, SEEK_SET);
			$nameUtf16 = fread($fh, 64);
			$nameLength = self::_readInt2($fh);
			$nameUtf16 = substr($nameUtf16, 0, $nameLength - 2);
			// Simple conversion from UTF-16LE to ISO-8859-1
			$name = str_replace("\x00", "", $nameUtf16);
			$type = self::_readInt1($fh);
			switch ($type) {
			case self::OLE_PPS_TYPE_ROOT:
				$pps = new PHPExcel_Shared_OLE_PPS_Root(null, null, array());
				$this->root = $pps;
				break;
			case self::OLE_PPS_TYPE_DIR:
				$pps = new PHPExcel_Shared_OLE_PPS(null, null, null, null, null,
								   null, null, null, null, array());
				break;
			case self::OLE_PPS_TYPE_FILE:
				$pps = new PHPExcel_Shared_OLE_PPS_File($name);
				break;
			default:
				continue;
			}
			fseek($fh, 1, SEEK_CUR);
			$pps->Type    = $type;
			$pps->Name    = $name;
			$pps->PrevPps = self::_readInt4($fh);
			$pps->NextPps = self::_readInt4($fh);
			$pps->DirPps  = self::_readInt4($fh);
			fseek($fh, 20, SEEK_CUR);
			$pps->Time1st = self::OLE2LocalDate(fread($fh, 8));
			$pps->Time2nd = self::OLE2LocalDate(fread($fh, 8));
			$pps->_StartBlock = self::_readInt4($fh);
			$pps->Size = self::_readInt4($fh);
			$pps->No = count($this->_list);
			$this->_list[] = $pps;

			// check if the PPS tree (starting from root) is complete
			if (isset($this->root) &&
				$this->_ppsTreeComplete($this->root->No)) {

				break;
			}
		}
		fclose($fh);

		// Initialize $pps->children on directories
		foreach ($this->_list as $pps) {
			if ($pps->Type == self::OLE_PPS_TYPE_DIR || $pps->Type == self::OLE_PPS_TYPE_ROOT) {
				$nos = array($pps->DirPps);
				$pps->children = array();
				while ($nos) {
					$no = array_pop($nos);
					if ($no != -1) {
						$childPps = $this->_list[$no];
						$nos[] = $childPps->PrevPps;
						$nos[] = $childPps->NextPps;
						$pps->children[] = $childPps;
					}
				}
			}
		}

		return true;
	}

	/**
	* It checks whether the PPS tree is complete (all PPS's read)
	* starting with the given PPS (not necessarily root)
	*
	* @access public
	* @param integer $index The index of the PPS from which we are checking
	* @return boolean Whether the PPS tree for the given PPS is complete
	*/
||||||||HAS_DOC_COMMENTNO_RETURN_TYPE
(NO_PARAM_TYPENO_PARAM_DEFAULT)
(
    (AST_ASSIGN
        (AST_VAR)
        (AST_METHOD_CALL
            (AST_VAR)
            (
                (AST_VAR))))
    (AST_FOR
        (AST_EXPR_LIST
            (AST_ASSIGN
                (AST_VAR)
                (SCALAR)))
        (NULL)
        (AST_EXPR_LIST
            (AST_ASSIGN_OP
                (AST_VAR)
                (SCALAR)))
        (
            (AST_CALL
                (
                    (AST_VAR)
                    (AST_VAR)
                    (AST_CONST)))
            (AST_ASSIGN
                (AST_VAR)
                (AST_CALL
                    (
                        (AST_VAR)
                        (SCALAR))))
            (AST_ASSIGN
                (AST_VAR)
                (AST_METHOD_CALL
                    (AST_VAR)
                    (
                        (AST_VAR))))
            (AST_ASSIGN
                (AST_VAR)
                (AST_CALL
                    (
                        (AST_VAR)
                        (SCALAR)
                        (AST_BINARY_OP
                            (AST_VAR)
                            (SCALAR)))))
            (AST_ASSIGN
                (AST_VAR)
                (AST_CALL
                    (
                        (SCALAR)
                        (SCALAR)
                        (AST_VAR))))
            (AST_ASSIGN
                (AST_VAR)
                (AST_METHOD_CALL
                    (AST_VAR)
                    (
                        (AST_VAR))))
            (AST_SWITCH
                (AST_VAR)
                (AST_SWITCH_LIST
                    (AST_SWITCH_CASE
                        (AST_CLASS_CONST
                            (SCALAR))
                        (
                            (AST_ASSIGN
                                (AST_VAR)
                                (AST_NEW
                                    (
                                        (AST_CONST)
                                        (AST_CONST)
                                        (AST_ARRAY))))
                            (AST_ASSIGN
                                (AST_PROP
                                    (AST_VAR))
                                (AST_VAR))
                            (AST_BREAK
                                (NULL))))
                    (AST_SWITCH_CASE
                        (AST_CLASS_CONST
                            (SCALAR))
                        (
                            (AST_ASSIGN
                                (AST_VAR)
                                (AST_NEW
                                    (
                                        (AST_CONST)
                                        (AST_CONST)
                                        (AST_CONST)
                                        (AST_CONST)
                                        (AST_CONST)
                                        (AST_CONST)
                                        (AST_CONST)
                                        (AST_CONST)
                                        (AST_CONST)
                                        (AST_ARRAY))))
                            (AST_BREAK
                                (NULL))))
                    (AST_SWITCH_CASE
                        (AST_CLASS_CONST
                            (SCALAR))
                        (
                            (AST_ASSIGN
                                (AST_VAR)
                                (AST_NEW
                                    (
                                        (AST_VAR))))
                            (AST_BREAK
                                (NULL))))
                    (AST_SWITCH_CASE
                        (NULL)
                        (
                            (AST_CONTINUE
                                (NULL))))))
            (AST_CALL
                (
                    (AST_VAR)
                    (SCALAR)
                    (AST_CONST)))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_VAR))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_VAR))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_METHOD_CALL
                    (AST_VAR)
                    (
                        (AST_VAR))))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_METHOD_CALL
                    (AST_VAR)
                    (
                        (AST_VAR))))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_METHOD_CALL
                    (AST_VAR)
                    (
                        (AST_VAR))))
            (AST_CALL
                (
                    (AST_VAR)
                    (SCALAR)
                    (AST_CONST)))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_STATIC_CALL
                    (
                        (AST_CALL
                            (
                                (AST_VAR)
                                (SCALAR))))))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_STATIC_CALL
                    (
                        (AST_CALL
                            (
                                (AST_VAR)
                                (SCALAR))))))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_METHOD_CALL
                    (AST_VAR)
                    (
                        (AST_VAR))))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_METHOD_CALL
                    (AST_VAR)
                    (
                        (AST_VAR))))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_CALL
                    (
                        (AST_PROP
                            (AST_VAR)))))
            (AST_ASSIGN
                (AST_DIM
                    (AST_PROP
                        (AST_VAR))
                    (NULL))
                (AST_VAR))
            (AST_IF
                (AST_IF_ELEM
                    (AST_BINARY_OP
                        (AST_ISSET
                            (AST_PROP
                                (AST_VAR)))
                        (AST_METHOD_CALL
                            (AST_VAR)
                            (
                                (AST_PROP
                                    (AST_PROP
                                        (AST_VAR))))))
                    (
                        (AST_BREAK
                            (NULL)))))))
    (AST_CALL
        (
            (AST_VAR)))
    (AST_FOREACH
        (AST_PROP
            (AST_VAR))
        (AST_VAR)
        (NULL)
        (
            (AST_IF
                (AST_IF_ELEM
                    (AST_BINARY_OP
                        (AST_BINARY_OP
                            (AST_PROP
                                (AST_VAR))
                            (AST_CLASS_CONST
                                (SCALAR)))
                        (AST_BINARY_OP
                            (AST_PROP
                                (AST_VAR))
                            (AST_CLASS_CONST
                                (SCALAR))))
                    (
                        (AST_ASSIGN
                            (AST_VAR)
                            (AST_ARRAY
                                (AST_ARRAY_ELEM
                                    (AST_PROP
                                        (AST_VAR))
                                    (NULL))))
                        (AST_ASSIGN
                            (AST_PROP
                                (AST_VAR))
                            (AST_ARRAY))
                        (AST_WHILE
                            (AST_VAR)
                            (
                                (AST_ASSIGN
                                    (AST_VAR)
                                    (AST_CALL
                                        (
                                            (AST_VAR))))
                                (AST_IF
                                    (AST_IF_ELEM
                                        (AST_BINARY_OP
                                            (AST_VAR)
                                            (AST_UNARY_OP
                                                (SCALAR)))
                                        (
                                            (AST_ASSIGN
                                                (AST_VAR)
                                                (AST_DIM
                                                    (AST_PROP
                                                        (AST_VAR))
                                                    (AST_VAR)))
                                            (AST_ASSIGN
                                                (AST_DIM
                                                    (AST_VAR)
                                                    (NULL))
                                                (AST_PROP
                                                    (AST_VAR)))
                                            (AST_ASSIGN
                                                (AST_DIM
                                                    (AST_VAR)
                                                    (NULL))
                                                (AST_PROP
                                                    (AST_VAR)))
                                            (AST_ASSIGN
                                                (AST_DIM
                                                    (AST_PROP
                                                        (AST_VAR))
                                                    (NULL))
                                                (AST_VAR))))))))))))
    (AST_RETURN
        (AST_CONST)))||||||||HAS_DOC_COMMENTNO_RETURN_TYPE
(NO_PARAM_TYPENO_PARAM_DEFAULT)
(
    (AST_ASSIGN
        (AST_VAR)
        (AST_METHOD_CALL
            (AST_VAR)
            (
                (AST_VAR))))
    (AST_FOR
        (AST_EXPR_LIST
            (AST_ASSIGN
                (AST_VAR)
                (SCALAR)))
        (NULL)
        (AST_EXPR_LIST
            (AST_ASSIGN_OP
                (AST_VAR)
                (SCALAR)))
        (
            (AST_CALL
                (
                    (AST_VAR)
                    (AST_VAR)
                    (AST_CONST)))
            (AST_ASSIGN
                (AST_VAR)
                (AST_CALL
                    (
                        (AST_VAR)
                        (SCALAR))))
            (AST_ASSIGN
                (AST_VAR)
                (AST_STATIC_CALL
                    (
                        (AST_VAR))))
            (AST_ASSIGN
                (AST_VAR)
                (AST_CALL
                    (
                        (AST_VAR)
                        (SCALAR)
                        (AST_BINARY_OP
                            (AST_VAR)
                            (SCALAR)))))
            (AST_ASSIGN
                (AST_VAR)
                (AST_CALL
                    (
                        (SCALAR)
                        (SCALAR)
                        (AST_VAR))))
            (AST_ASSIGN
                (AST_VAR)
                (AST_STATIC_CALL
                    (
                        (AST_VAR))))
            (AST_SWITCH
                (AST_VAR)
                (AST_SWITCH_LIST
                    (AST_SWITCH_CASE
                        (AST_CLASS_CONST
                            (SCALAR))
                        (
                            (AST_ASSIGN
                                (AST_VAR)
                                (AST_NEW
                                    (
                                        (AST_CONST)
                                        (AST_CONST)
                                        (AST_ARRAY))))
                            (AST_ASSIGN
                                (AST_PROP
                                    (AST_VAR))
                                (AST_VAR))
                            (AST_BREAK
                                (NULL))))
                    (AST_SWITCH_CASE
                        (AST_CLASS_CONST
                            (SCALAR))
                        (
                            (AST_ASSIGN
                                (AST_VAR)
                                (AST_NEW
                                    (
                                        (AST_CONST)
                                        (AST_CONST)
                                        (AST_CONST)
                                        (AST_CONST)
                                        (AST_CONST)
                                        (AST_CONST)
                                        (AST_CONST)
                                        (AST_CONST)
                                        (AST_CONST)
                                        (AST_ARRAY))))
                            (AST_BREAK
                                (NULL))))
                    (AST_SWITCH_CASE
                        (AST_CLASS_CONST
                            (SCALAR))
                        (
                            (AST_ASSIGN
                                (AST_VAR)
                                (AST_NEW
                                    (
                                        (AST_VAR))))
                            (AST_BREAK
                                (NULL))))
                    (AST_SWITCH_CASE
                        (NULL)
                        (
                            (AST_CONTINUE
                                (NULL))))))
            (AST_CALL
                (
                    (AST_VAR)
                    (SCALAR)
                    (AST_CONST)))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_VAR))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_VAR))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_STATIC_CALL
                    (
                        (AST_VAR))))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_STATIC_CALL
                    (
                        (AST_VAR))))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_STATIC_CALL
                    (
                        (AST_VAR))))
            (AST_CALL
                (
                    (AST_VAR)
                    (SCALAR)
                    (AST_CONST)))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_STATIC_CALL
                    (
                        (AST_CALL
                            (
                                (AST_VAR)
                                (SCALAR))))))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_STATIC_CALL
                    (
                        (AST_CALL
                            (
                                (AST_VAR)
                                (SCALAR))))))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_STATIC_CALL
                    (
                        (AST_VAR))))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_STATIC_CALL
                    (
                        (AST_VAR))))
            (AST_ASSIGN
                (AST_PROP
                    (AST_VAR))
                (AST_CALL
                    (
                        (AST_PROP
                            (AST_VAR)))))
            (AST_ASSIGN
                (AST_DIM
                    (AST_PROP
                        (AST_VAR))
                    (NULL))
                (AST_VAR))
            (AST_IF
                (AST_IF_ELEM
                    (AST_BINARY_OP
                        (AST_ISSET
                            (AST_PROP
                                (AST_VAR)))
                        (AST_METHOD_CALL
                            (AST_VAR)
                            (
                                (AST_PROP
                                    (AST_PROP
                                        (AST_VAR))))))
                    (
                        (AST_BREAK
                            (NULL)))))))
    (AST_CALL
        (
            (AST_VAR)))
    (AST_FOREACH
        (AST_PROP
            (AST_VAR))
        (AST_VAR)
        (NULL)
        (
            (AST_IF
                (AST_IF_ELEM
                    (AST_BINARY_OP
                        (AST_BINARY_OP
                            (AST_PROP
                                (AST_VAR))
                            (AST_CLASS_CONST
                                (SCALAR)))
                        (AST_BINARY_OP
                            (AST_PROP
                                (AST_VAR))
                            (AST_CLASS_CONST
                                (SCALAR))))
                    (
                        (AST_ASSIGN
                            (AST_VAR)
                            (AST_ARRAY
                                (AST_ARRAY_ELEM
                                    (AST_PROP
                                        (AST_VAR))
                                    (NULL))))
                        (AST_ASSIGN
                            (AST_PROP
                                (AST_VAR))
                            (AST_ARRAY))
                        (AST_WHILE
                            (AST_VAR)
                            (
                                (AST_ASSIGN
                                    (AST_VAR)
                                    (AST_CALL
                                        (
                                            (AST_VAR))))
                                (AST_IF
                                    (AST_IF_ELEM
                                        (AST_BINARY_OP
                                            (AST_VAR)
                                            (AST_UNARY_OP
                                                (SCALAR)))
                                        (
                                            (AST_ASSIGN
                                                (AST_VAR)
                                                (AST_DIM
                                                    (AST_PROP
                                                        (AST_VAR))
                                                    (AST_VAR)))
                                            (AST_ASSIGN
                                                (AST_DIM
                                                    (AST_VAR)
                                                    (NULL))
                                                (AST_PROP
                                                    (AST_VAR)))
                                            (AST_ASSIGN
                                                (AST_DIM
                                                    (AST_VAR)
                                                    (NULL))
                                                (AST_PROP
                                                    (AST_VAR)))
                                            (AST_ASSIGN
                                                (AST_DIM
                                                    (AST_PROP
                                                        (AST_VAR))
                                                    (NULL))
                                                (AST_VAR))))))))))))
    (AST_RETURN
        (AST_CONST)))