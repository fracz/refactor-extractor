    public function createDerivedFiles(Media $media)
    {

        $profileCollection = ProfileCollectionFactory::createForMedia($media);

        foreach ($profileCollection->getProfilesForCollection($media->collection_name) as $profile) {

            $tempFile = storage_path('media-library/temp/' . $media->id .'-' . $profile->name . '.jpg');

            /*
             * @todo make this working with cloud systems
             */
            copy($media->getPath(), $tempFile);

            foreach($profile->getConversion as $conversion)
            {
                (new GlideImage())
                    ->load($tempFile, $conversion)
                    ->useAbsoluteSourceFilePath()
                    ->save($tempFile);
            }


            app(MediaLibraryFileSystem::class)->copyFileToMediaLibraryForMedia($tempFile, $media);

            unlink($tempFile);


        }

    }
}||||||||    public function createDerivedFiles(Media $media)
    {
        $profileCollection = ProfileCollectionFactory::createForMedia($media);

        foreach ($profileCollection->getConversionsForCollection($media->collection_name) as $conversion) {

            $tempFile = storage_path('media-library/temp/' . $media->id .'-' . $conversion->getName() . '.jpg');

            /*
             * @todo make this working with cloud systems
             */
            copy($media->getPath(), $tempFile);

            foreach($conversion->getManipulations() as $manipulation)
            {
                (new GlideImage())
                    ->load($tempFile, $manipulation)
                    ->useAbsoluteSourceFilePath()
                    ->save($tempFile);
            }

            app(MediaLibraryFileSystem::class)->copyFileToMediaLibraryForMedia($tempFile, $media);

            unlink($tempFile);


        }

    }
}||||||||NO_DOC_COMMENTNO_RETURN_TYPE
(PARAM_TYPENO_PARAM_DEFAULT)
(
    (AST_ASSIGN
        (AST_VAR)
        (AST_STATIC_CALL
            (
                (AST_VAR))))
    (AST_FOREACH
        (AST_METHOD_CALL
            (AST_VAR)
            (
                (AST_PROP
                    (AST_VAR))))
        (AST_VAR)
        (NULL)
        (
            (AST_ASSIGN
                (AST_VAR)
                (AST_CALL
                    (
                        (AST_BINARY_OP
                            (AST_BINARY_OP
                                (AST_BINARY_OP
                                    (AST_BINARY_OP
                                        (SCALAR)
                                        (AST_PROP
                                            (AST_VAR)))
                                    (SCALAR))
                                (AST_PROP
                                    (AST_VAR)))
                            (SCALAR)))))
            (AST_CALL
                (
                    (AST_METHOD_CALL
                        (AST_VAR))
                    (AST_VAR)))
            (AST_FOREACH
                (AST_PROP
                    (AST_VAR))
                (AST_VAR)
                (NULL)
                (
                    (AST_METHOD_CALL
                        (AST_METHOD_CALL
                            (AST_METHOD_CALL
                                (AST_NEW)
                                (
                                    (AST_VAR)
                                    (AST_VAR))))
                        (
                            (AST_VAR)))))
            (AST_METHOD_CALL
                (AST_CALL
                    (
                        (AST_CLASS_CONST
                            (SCALAR))))
                (
                    (AST_VAR)
                    (AST_VAR)))
            (AST_CALL
                (
                    (AST_VAR))))))||||||||NO_DOC_COMMENTNO_RETURN_TYPE
(PARAM_TYPENO_PARAM_DEFAULT)
(
    (AST_ASSIGN
        (AST_VAR)
        (AST_STATIC_CALL
            (
                (AST_VAR))))
    (AST_FOREACH
        (AST_METHOD_CALL
            (AST_VAR)
            (
                (AST_PROP
                    (AST_VAR))))
        (AST_VAR)
        (NULL)
        (
            (AST_ASSIGN
                (AST_VAR)
                (AST_CALL
                    (
                        (AST_BINARY_OP
                            (AST_BINARY_OP
                                (AST_BINARY_OP
                                    (AST_BINARY_OP
                                        (SCALAR)
                                        (AST_PROP
                                            (AST_VAR)))
                                    (SCALAR))
                                (AST_METHOD_CALL
                                    (AST_VAR)))
                            (SCALAR)))))
            (AST_CALL
                (
                    (AST_METHOD_CALL
                        (AST_VAR))
                    (AST_VAR)))
            (AST_FOREACH
                (AST_METHOD_CALL
                    (AST_VAR))
                (AST_VAR)
                (NULL)
                (
                    (AST_METHOD_CALL
                        (AST_METHOD_CALL
                            (AST_METHOD_CALL
                                (AST_NEW)
                                (
                                    (AST_VAR)
                                    (AST_VAR))))
                        (
                            (AST_VAR)))))
            (AST_METHOD_CALL
                (AST_CALL
                    (
                        (AST_CLASS_CONST
                            (SCALAR))))
                (
                    (AST_VAR)
                    (AST_VAR)))
            (AST_CALL
                (
                    (AST_VAR))))))