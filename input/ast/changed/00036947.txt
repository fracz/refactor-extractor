    private function addGlobalsSection(NodeBuilder $rootNode)
    {
        $rootNode
            ->fixXmlConfig('global')
            ->arrayNode('globals')
                ->useAttributeAsKey('key')
                ->prototype('array')
                    ->beforeNormalization()
                        ->ifTrue(function($v){ return is_scalar($v); })
                        ->then(function($v){
                            return ('@' === substr($v, 0, 1))
                                   ? array('id' => substr($v, 1), 'type' => 'service')
                                   : array('value' => $v);
                        })
                    ->end()
                    ->scalarNode('id')->end()
                    ->scalarNode('type')
                        ->validate()
                            ->ifNotInArray(array('service'))
                            ->thenInvalid('The %s type is not supported')
                        ->end()
                    ->end()
                    ->scalarNode('value')->end()
                ->end()
            ->end()
        ;
    }

||||||||    private function addGlobalsSection(NodeBuilder $rootNode)
    {
        $rootNode
            ->fixXmlConfig('global')
            ->arrayNode('globals')
                ->useAttributeAsKey('key')
                ->prototype('array')
                    ->beforeNormalization()
                        ->ifTrue(function($v){ return is_string($v) && '@' === substr($v, 0, 1); })
                        ->then(function($v){ return array('id' => substr($v, 1), 'type' => 'service'); })
                    ->end()
                    ->beforeNormalization()
                        ->ifTrue(function($v){
                            if (is_array($v)) {
                                $keys = array_keys($v);
                                sort($keys);

                                return $keys !== array('id', 'type') && $keys !== array('value');
                            }

                            return true;
                        })
                        ->then(function($v){ return array('value' => $v); })
                    ->end()
                    ->scalarNode('id')->end()
                    ->scalarNode('type')
                        ->validate()
                            ->ifNotInArray(array('service'))
                            ->thenInvalid('The %s type is not supported')
                        ->end()
                    ->end()
                    ->variableNode('value')->end()
                ->end()
            ->end()
        ;
    }

||||||||NO_DOC_COMMENTNO_RETURN_TYPE
(PARAM_TYPENO_PARAM_DEFAULT)
(
    (AST_METHOD_CALL
        (AST_METHOD_CALL
            (AST_METHOD_CALL
                (AST_METHOD_CALL
                    (AST_METHOD_CALL
                        (AST_METHOD_CALL
                            (AST_METHOD_CALL
                                (AST_METHOD_CALL
                                    (AST_METHOD_CALL
                                        (AST_METHOD_CALL
                                            (AST_METHOD_CALL
                                                (AST_METHOD_CALL
                                                    (AST_METHOD_CALL
                                                        (AST_METHOD_CALL
                                                            (AST_METHOD_CALL
                                                                (AST_METHOD_CALL
                                                                    (AST_METHOD_CALL
                                                                        (AST_METHOD_CALL
                                                                            (AST_METHOD_CALL
                                                                                (AST_METHOD_CALL
                                                                                    (AST_VAR)
                                                                                    (
                                                                                        (SCALAR)))
                                                                                (
                                                                                    (SCALAR)))
                                                                            (
                                                                                (SCALAR)))
                                                                        (
                                                                            (SCALAR))))
                                                                (
                                                                    (AST_CLOSURE
                                                                        (NO_PARAM_TYPENO_PARAM_DEFAULT)
                                                                        (NULL)
                                                                        (
                                                                            (AST_RETURN
                                                                                (AST_CALL
                                                                                    (
                                                                                        (AST_VAR))))))))
                                                            (
                                                                (AST_CLOSURE
                                                                    (NO_PARAM_TYPENO_PARAM_DEFAULT)
                                                                    (NULL)
                                                                    (
                                                                        (AST_RETURN
                                                                            (AST_CONDITIONAL
                                                                                (AST_BINARY_OP
                                                                                    (SCALAR)
                                                                                    (AST_CALL
                                                                                        (
                                                                                            (AST_VAR)
                                                                                            (SCALAR)
                                                                                            (SCALAR))))
                                                                                (AST_ARRAY
                                                                                    (AST_ARRAY_ELEM
                                                                                        (AST_CALL
                                                                                            (
                                                                                                (AST_VAR)
                                                                                                (SCALAR)))
                                                                                        (SCALAR))
                                                                                    (AST_ARRAY_ELEM
                                                                                        (SCALAR)
                                                                                        (SCALAR)))
                                                                                (AST_ARRAY
                                                                                    (AST_ARRAY_ELEM
                                                                                        (AST_VAR)
                                                                                        (SCALAR))))))))))
                                                    (
                                                        (SCALAR))))
                                            (
                                                (SCALAR))))
                                    (
                                        (AST_ARRAY
                                            (AST_ARRAY_ELEM
                                                (SCALAR)
                                                (NULL)))))
                                (
                                    (SCALAR)))))
                    (
                        (SCALAR)))))))||||||||NO_DOC_COMMENTNO_RETURN_TYPE
(PARAM_TYPENO_PARAM_DEFAULT)
(
    (AST_METHOD_CALL
        (AST_METHOD_CALL
            (AST_METHOD_CALL
                (AST_METHOD_CALL
                    (AST_METHOD_CALL
                        (AST_METHOD_CALL
                            (AST_METHOD_CALL
                                (AST_METHOD_CALL
                                    (AST_METHOD_CALL
                                        (AST_METHOD_CALL
                                            (AST_METHOD_CALL
                                                (AST_METHOD_CALL
                                                    (AST_METHOD_CALL
                                                        (AST_METHOD_CALL
                                                            (AST_METHOD_CALL
                                                                (AST_METHOD_CALL
                                                                    (AST_METHOD_CALL
                                                                        (AST_METHOD_CALL
                                                                            (AST_METHOD_CALL
                                                                                (AST_METHOD_CALL
                                                                                    (AST_METHOD_CALL
                                                                                        (AST_METHOD_CALL
                                                                                            (AST_METHOD_CALL
                                                                                                (AST_METHOD_CALL
                                                                                                    (AST_VAR)
                                                                                                    (
                                                                                                        (SCALAR)))
                                                                                                (
                                                                                                    (SCALAR)))
                                                                                            (
                                                                                                (SCALAR)))
                                                                                        (
                                                                                            (SCALAR))))
                                                                                (
                                                                                    (AST_CLOSURE
                                                                                        (NO_PARAM_TYPENO_PARAM_DEFAULT)
                                                                                        (NULL)
                                                                                        (
                                                                                            (AST_RETURN
                                                                                                (AST_BINARY_OP
                                                                                                    (AST_CALL
                                                                                                        (
                                                                                                            (AST_VAR)))
                                                                                                    (AST_BINARY_OP
                                                                                                        (SCALAR)
                                                                                                        (AST_CALL
                                                                                                            (
                                                                                                                (AST_VAR)
                                                                                                                (SCALAR)
                                                                                                                (SCALAR))))))))))
                                                                            (
                                                                                (AST_CLOSURE
                                                                                    (NO_PARAM_TYPENO_PARAM_DEFAULT)
                                                                                    (NULL)
                                                                                    (
                                                                                        (AST_RETURN
                                                                                            (AST_ARRAY
                                                                                                (AST_ARRAY_ELEM
                                                                                                    (AST_CALL
                                                                                                        (
                                                                                                            (AST_VAR)
                                                                                                            (SCALAR)))
                                                                                                    (SCALAR))
                                                                                                (AST_ARRAY_ELEM
                                                                                                    (SCALAR)
                                                                                                    (SCALAR))))))))))
                                                                (
                                                                    (AST_CLOSURE
                                                                        (NO_PARAM_TYPENO_PARAM_DEFAULT)
                                                                        (NULL)
                                                                        (
                                                                            (AST_IF
                                                                                (AST_IF_ELEM
                                                                                    (AST_CALL
                                                                                        (
                                                                                            (AST_VAR)))
                                                                                    (
                                                                                        (AST_ASSIGN
                                                                                            (AST_VAR)
                                                                                            (AST_CALL
                                                                                                (
                                                                                                    (AST_VAR))))
                                                                                        (AST_CALL
                                                                                            (
                                                                                                (AST_VAR)))
                                                                                        (AST_RETURN
                                                                                            (AST_BINARY_OP
                                                                                                (AST_BINARY_OP
                                                                                                    (AST_VAR)
                                                                                                    (AST_ARRAY
                                                                                                        (AST_ARRAY_ELEM
                                                                                                            (SCALAR)
                                                                                                            (NULL))
                                                                                                        (AST_ARRAY_ELEM
                                                                                                            (SCALAR)
                                                                                                            (NULL))))
                                                                                                (AST_BINARY_OP
                                                                                                    (AST_VAR)
                                                                                                    (AST_ARRAY
                                                                                                        (AST_ARRAY_ELEM
                                                                                                            (SCALAR)
                                                                                                            (NULL)))))))))
                                                                            (AST_RETURN
                                                                                (AST_CONST))))))
                                                            (
                                                                (AST_CLOSURE
                                                                    (NO_PARAM_TYPENO_PARAM_DEFAULT)
                                                                    (NULL)
                                                                    (
                                                                        (AST_RETURN
                                                                            (AST_ARRAY
                                                                                (AST_ARRAY_ELEM
                                                                                    (AST_VAR)
                                                                                    (SCALAR)))))))))
                                                    (
                                                        (SCALAR))))
                                            (
                                                (SCALAR))))
                                    (
                                        (AST_ARRAY
                                            (AST_ARRAY_ELEM
                                                (SCALAR)
                                                (NULL)))))
                                (
                                    (SCALAR)))))
                    (
                        (SCALAR)))))))