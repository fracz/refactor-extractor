	public function DoAdminUpdateCoreData()
	{
		$this->IsAdminLoggined();

		$bReal = false;
		$sNewVersion = '';

		$bRainLoopUpdatable = $this->rainLoopUpdatable();
		$bRainLoopAccess = $this->rainLoopCoreAccess();

		$aData = array();
		if ($bRainLoopUpdatable && $bRainLoopAccess)
		{
			$aData = $this->getCoreData($bReal);
		}

		$bResult = false;
		if ($bReal && !empty($aData['file']))
		{
			$sTmp = $this->downloadRemotePackageByUrl($aData['file']);
			if (!empty($sTmp))
			{
				include_once APP_VERSION_ROOT_PATH.'app/libraries/pclzip/pclzip.lib.php';

				$oArchive = new \PclZip($sTmp);
				$sTmpFolder = APP_PRIVATE_DATA.\md5($sTmp);

				\mkdir($sTmpFolder);
				if (\is_dir($sTmpFolder))
				{
					$bResult = 0 !== $oArchive->extract(PCLZIP_OPT_PATH, $sTmpFolder);
					if (!$bResult)
					{
						$this->Logger()->Write('Cannot extract package files: '.$oArchive->errorInfo(), \MailSo\Log\Enumerations\Type::ERROR, 'INSTALLER');
					}

					if ($bResult && \file_exists($sTmpFolder.'/index.php') &&
						\is_writable(APP_INDEX_ROOT_PATH.'rainloop/') &&
						\is_writable(APP_INDEX_ROOT_PATH.'index.php') &&
						\is_dir($sTmpFolder.'/rainloop/'))
					{
						$aMatch = array();
						$sIndexFile = \file_get_contents($sTmpFolder.'/index.php');
						if (\preg_match('/\'APP_VERSION\', \'([^\']+)\'/', $sIndexFile, $aMatch) && !empty($aMatch[1]))
						{
							$sNewVersion = \trim($aMatch[1]);
						}

						if (empty($sNewVersion))
						{
							$this->Logger()->Write('Unknown version', \MailSo\Log\Enumerations\Type::ERROR, 'INSTALLER');
						}
						else if (!\is_dir(APP_INDEX_ROOT_PATH.'rainloop/v/'.$sNewVersion))
						{
							\MailSo\Base\Utils::CopyDir($sTmpFolder.'/rainloop/', APP_INDEX_ROOT_PATH.'rainloop/');

							if (\is_dir(APP_INDEX_ROOT_PATH.'rainloop/v/'.$sNewVersion) &&
								\is_file(APP_INDEX_ROOT_PATH.'rainloop/v/'.$sNewVersion.'/index.php'))
							{
								$bResult = \copy($sTmpFolder.'/index.php', APP_INDEX_ROOT_PATH.'index.php');

								if ($bResult)
								{
									if (\MailSo\Base\Utils::FunctionExistsAndEnabled('opcache_invalidate'))
									{
										@\opcache_invalidate(APP_INDEX_ROOT_PATH.'index.php', true);
									}

									if (\MailSo\Base\Utils::FunctionExistsAndEnabled('apc_delete_file'))
									{
										@\apc_delete_file(APP_INDEX_ROOT_PATH.'index.php');
									}
								}
							}
							else
							{
								$this->Logger()->Write('Cannot copy new package files', \MailSo\Log\Enumerations\Type::ERROR, 'INSTALLER');
								$this->Logger()->Write($sTmpFolder.'/rainloop/ -> '.APP_INDEX_ROOT_PATH.'rainloop/', \MailSo\Log\Enumerations\Type::ERROR, 'INSTALLER');
							}
						}
						else if (!empty($sNewVersion))
						{
							$this->Logger()->Write('"'.$sNewVersion.'" version already installed', \MailSo\Log\Enumerations\Type::ERROR, 'INSTALLER');
						}
					}
					else if ($bResult)
					{
						$this->Logger()->Write('Cannot validate package files', \MailSo\Log\Enumerations\Type::ERROR, 'INSTALLER');
					}

					\MailSo\Base\Utils::RecRmDir($sTmpFolder);
				}
				else
				{
					$this->Logger()->Write('Cannot create tmp folder: '.$sTmpFolder, \MailSo\Log\Enumerations\Type::ERROR, 'INSTALLER');
				}

				@\unlink($sTmp);
			}
		}

		return $this->DefaultResponse(__FUNCTION__, $bResult);
	}

||||||||	public function DoAdminUpdateCoreData()
	{
		$this->IsAdminLoggined();

		$bReal = false;

		$bRainLoopUpdatable = $this->rainLoopUpdatable();
		$bRainLoopAccess = $this->rainLoopCoreAccess();
		$oPremProvider = $this->PremProvider();

		$aData = array();
		if ($bRainLoopUpdatable && $bRainLoopAccess)
		{
			$aData = $this->getCoreData($bReal);
		}

		$bResult = false;
		if ($bReal && $oPremProvider && !empty($aData['file']))
		{
			$bResult = $oPremProvider->UpdateCore($this, $aData['file']);
		}

		return $this->DefaultResponse(__FUNCTION__, $bResult);
	}

	/**
	 * @return array
	 */
||||||||HAS_DOC_COMMENTNO_RETURN_TYPE
(
    (AST_METHOD_CALL
        (AST_VAR))
    (AST_ASSIGN
        (AST_VAR)
        (AST_CONST))
    (AST_ASSIGN
        (AST_VAR)
        (SCALAR))
    (AST_ASSIGN
        (AST_VAR)
        (AST_METHOD_CALL
            (AST_VAR)))
    (AST_ASSIGN
        (AST_VAR)
        (AST_METHOD_CALL
            (AST_VAR)))
    (AST_ASSIGN
        (AST_VAR)
        (AST_ARRAY))
    (AST_IF
        (AST_IF_ELEM
            (AST_BINARY_OP
                (AST_VAR)
                (AST_VAR))
            (
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_METHOD_CALL
                        (AST_VAR)
                        (
                            (AST_VAR)))))))
    (AST_ASSIGN
        (AST_VAR)
        (AST_CONST))
    (AST_IF
        (AST_IF_ELEM
            (AST_BINARY_OP
                (AST_VAR)
                (AST_UNARY_OP
                    (AST_EMPTY
                        (AST_DIM
                            (AST_VAR)
                            (SCALAR)))))
            (
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_METHOD_CALL
                        (AST_VAR)
                        (
                            (AST_DIM
                                (AST_VAR)
                                (SCALAR)))))
                (AST_IF
                    (AST_IF_ELEM
                        (AST_UNARY_OP
                            (AST_EMPTY
                                (AST_VAR)))
                        (
                            (AST_INCLUDE_OR_EVAL
                                (AST_BINARY_OP
                                    (AST_CONST)
                                    (SCALAR)))
                            (AST_ASSIGN
                                (AST_VAR)
                                (AST_NEW
                                    (
                                        (AST_VAR))))
                            (AST_ASSIGN
                                (AST_VAR)
                                (AST_BINARY_OP
                                    (AST_CONST)
                                    (AST_CALL
                                        (
                                            (AST_VAR)))))
                            (AST_CALL
                                (
                                    (AST_VAR)))
                            (AST_IF
                                (AST_IF_ELEM
                                    (AST_CALL
                                        (
                                            (AST_VAR)))
                                    (
                                        (AST_ASSIGN
                                            (AST_VAR)
                                            (AST_BINARY_OP
                                                (SCALAR)
                                                (AST_METHOD_CALL
                                                    (AST_VAR)
                                                    (
                                                        (AST_CONST)
                                                        (AST_VAR)))))
                                        (AST_IF
                                            (AST_IF_ELEM
                                                (AST_UNARY_OP
                                                    (AST_VAR))
                                                (
                                                    (AST_METHOD_CALL
                                                        (AST_METHOD_CALL
                                                            (AST_VAR))
                                                        (
                                                            (AST_BINARY_OP
                                                                (SCALAR)
                                                                (AST_METHOD_CALL
                                                                    (AST_VAR)))
                                                            (AST_CLASS_CONST
                                                                (SCALAR))
                                                            (SCALAR))))))
                                        (AST_IF
                                            (AST_IF_ELEM
                                                (AST_BINARY_OP
                                                    (AST_BINARY_OP
                                                        (AST_BINARY_OP
                                                            (AST_BINARY_OP
                                                                (AST_VAR)
                                                                (AST_CALL
                                                                    (
                                                                        (AST_BINARY_OP
                                                                            (AST_VAR)
                                                                            (SCALAR)))))
                                                            (AST_CALL
                                                                (
                                                                    (AST_BINARY_OP
                                                                        (AST_CONST)
                                                                        (SCALAR)))))
                                                        (AST_CALL
                                                            (
                                                                (AST_BINARY_OP
                                                                    (AST_CONST)
                                                                    (SCALAR)))))
                                                    (AST_CALL
                                                        (
                                                            (AST_BINARY_OP
                                                                (AST_VAR)
                                                                (SCALAR)))))
                                                (
                                                    (AST_ASSIGN
                                                        (AST_VAR)
                                                        (AST_ARRAY))
                                                    (AST_ASSIGN
                                                        (AST_VAR)
                                                        (AST_CALL
                                                            (
                                                                (AST_BINARY_OP
                                                                    (AST_VAR)
                                                                    (SCALAR)))))
                                                    (AST_IF
                                                        (AST_IF_ELEM
                                                            (AST_BINARY_OP
                                                                (AST_CALL
                                                                    (
                                                                        (SCALAR)
                                                                        (AST_VAR)
                                                                        (AST_VAR)))
                                                                (AST_UNARY_OP
                                                                    (AST_EMPTY
                                                                        (AST_DIM
                                                                            (AST_VAR)
                                                                            (SCALAR)))))
                                                            (
                                                                (AST_ASSIGN
                                                                    (AST_VAR)
                                                                    (AST_CALL
                                                                        (
                                                                            (AST_DIM
                                                                                (AST_VAR)
                                                                                (SCALAR))))))))
                                                    (AST_IF
                                                        (AST_IF_ELEM
                                                            (AST_EMPTY
                                                                (AST_VAR))
                                                            (
                                                                (AST_METHOD_CALL
                                                                    (AST_METHOD_CALL
                                                                        (AST_VAR))
                                                                    (
                                                                        (SCALAR)
                                                                        (AST_CLASS_CONST
                                                                            (SCALAR))
                                                                        (SCALAR)))))
                                                        (AST_IF_ELEM
                                                            (NULL)
                                                            (
                                                                (AST_IF
                                                                    (AST_IF_ELEM
                                                                        (AST_UNARY_OP
                                                                            (AST_CALL
                                                                                (
                                                                                    (AST_BINARY_OP
                                                                                        (AST_BINARY_OP
                                                                                            (AST_CONST)
                                                                                            (SCALAR))
                                                                                        (AST_VAR)))))
                                                                        (
                                                                            (AST_STATIC_CALL
                                                                                (
                                                                                    (AST_BINARY_OP
                                                                                        (AST_VAR)
                                                                                        (SCALAR))
                                                                                    (AST_BINARY_OP
                                                                                        (AST_CONST)
                                                                                        (SCALAR))))
                                                                            (AST_IF
                                                                                (AST_IF_ELEM
                                                                                    (AST_BINARY_OP
                                                                                        (AST_CALL
                                                                                            (
                                                                                                (AST_BINARY_OP
                                                                                                    (AST_BINARY_OP
                                                                                                        (AST_CONST)
                                                                                                        (SCALAR))
                                                                                                    (AST_VAR))))
                                                                                        (AST_CALL
                                                                                            (
                                                                                                (AST_BINARY_OP
                                                                                                    (AST_BINARY_OP
                                                                                                        (AST_BINARY_OP
                                                                                                            (AST_CONST)
                                                                                                            (SCALAR))
                                                                                                        (AST_VAR))
                                                                                                    (SCALAR)))))
                                                                                    (
                                                                                        (AST_ASSIGN
                                                                                            (AST_VAR)
                                                                                            (AST_CALL
                                                                                                (
                                                                                                    (AST_BINARY_OP
                                                                                                        (AST_VAR)
                                                                                                        (SCALAR))
                                                                                                    (AST_BINARY_OP
                                                                                                        (AST_CONST)
                                                                                                        (SCALAR)))))
                                                                                        (AST_IF
                                                                                            (AST_IF_ELEM
                                                                                                (AST_VAR)
                                                                                                (
                                                                                                    (AST_IF
                                                                                                        (AST_IF_ELEM
                                                                                                            (AST_STATIC_CALL
                                                                                                                (
                                                                                                                    (SCALAR)))
                                                                                                            (
                                                                                                                (AST_UNARY_OP
                                                                                                                    (AST_CALL
                                                                                                                        (
                                                                                                                            (AST_BINARY_OP
                                                                                                                                (AST_CONST)
                                                                                                                                (SCALAR))
                                                                                                                            (AST_CONST)))))))
                                                                                                    (AST_IF
                                                                                                        (AST_IF_ELEM
                                                                                                            (AST_STATIC_CALL
                                                                                                                (
                                                                                                                    (SCALAR)))
                                                                                                            (
                                                                                                                (AST_UNARY_OP
                                                                                                                    (AST_CALL
                                                                                                                        (
                                                                                                                            (AST_BINARY_OP
                                                                                                                                (AST_CONST)
                                                                                                                                (SCALAR)))))))))))))
                                                                                (AST_IF_ELEM
                                                                                    (NULL)
                                                                                    (
                                                                                        (AST_METHOD_CALL
                                                                                            (AST_METHOD_CALL
                                                                                                (AST_VAR))
                                                                                            (
                                                                                                (SCALAR)
                                                                                                (AST_CLASS_CONST
                                                                                                    (SCALAR))
                                                                                                (SCALAR)))
                                                                                        (AST_METHOD_CALL
                                                                                            (AST_METHOD_CALL
                                                                                                (AST_VAR))
                                                                                            (
                                                                                                (AST_BINARY_OP
                                                                                                    (AST_BINARY_OP
                                                                                                        (AST_BINARY_OP
                                                                                                            (AST_VAR)
                                                                                                            (SCALAR))
                                                                                                        (AST_CONST))
                                                                                                    (SCALAR))
                                                                                                (AST_CLASS_CONST
                                                                                                    (SCALAR))
                                                                                                (SCALAR))))))))
                                                                    (AST_IF_ELEM
                                                                        (NULL)
                                                                        (
                                                                            (AST_IF
                                                                                (AST_IF_ELEM
                                                                                    (AST_UNARY_OP
                                                                                        (AST_EMPTY
                                                                                            (AST_VAR)))
                                                                                    (
                                                                                        (AST_METHOD_CALL
                                                                                            (AST_METHOD_CALL
                                                                                                (AST_VAR))
                                                                                            (
                                                                                                (AST_BINARY_OP
                                                                                                    (AST_BINARY_OP
                                                                                                        (SCALAR)
                                                                                                        (AST_VAR))
                                                                                                    (SCALAR))
                                                                                                (AST_CLASS_CONST
                                                                                                    (SCALAR))
                                                                                                (SCALAR))))))))))))))
                                            (AST_IF_ELEM
                                                (NULL)
                                                (
                                                    (AST_IF
                                                        (AST_IF_ELEM
                                                            (AST_VAR)
                                                            (
                                                                (AST_METHOD_CALL
                                                                    (AST_METHOD_CALL
                                                                        (AST_VAR))
                                                                    (
                                                                        (SCALAR)
                                                                        (AST_CLASS_CONST
                                                                            (SCALAR))
                                                                        (SCALAR)))))))))
                                        (AST_STATIC_CALL
                                            (
                                                (AST_VAR)))))
                                (AST_IF_ELEM
                                    (NULL)
                                    (
                                        (AST_METHOD_CALL
                                            (AST_METHOD_CALL
                                                (AST_VAR))
                                            (
                                                (AST_BINARY_OP
                                                    (SCALAR)
                                                    (AST_VAR))
                                                (AST_CLASS_CONST
                                                    (SCALAR))
                                                (SCALAR))))))
                            (AST_UNARY_OP
                                (AST_CALL
                                    (
                                        (AST_VAR))))))))))
    (AST_RETURN
        (AST_METHOD_CALL
            (AST_VAR)
            (
                (AST_MAGIC_CONST)
                (AST_VAR)))))||||||||HAS_DOC_COMMENTNO_RETURN_TYPE
(
    (AST_METHOD_CALL
        (AST_VAR))
    (AST_ASSIGN
        (AST_VAR)
        (AST_CONST))
    (AST_ASSIGN
        (AST_VAR)
        (AST_METHOD_CALL
            (AST_VAR)))
    (AST_ASSIGN
        (AST_VAR)
        (AST_METHOD_CALL
            (AST_VAR)))
    (AST_ASSIGN
        (AST_VAR)
        (AST_METHOD_CALL
            (AST_VAR)))
    (AST_ASSIGN
        (AST_VAR)
        (AST_ARRAY))
    (AST_IF
        (AST_IF_ELEM
            (AST_BINARY_OP
                (AST_VAR)
                (AST_VAR))
            (
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_METHOD_CALL
                        (AST_VAR)
                        (
                            (AST_VAR)))))))
    (AST_ASSIGN
        (AST_VAR)
        (AST_CONST))
    (AST_IF
        (AST_IF_ELEM
            (AST_BINARY_OP
                (AST_BINARY_OP
                    (AST_VAR)
                    (AST_VAR))
                (AST_UNARY_OP
                    (AST_EMPTY
                        (AST_DIM
                            (AST_VAR)
                            (SCALAR)))))
            (
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_METHOD_CALL
                        (AST_VAR)
                        (
                            (AST_VAR)
                            (AST_DIM
                                (AST_VAR)
                                (SCALAR))))))))
    (AST_RETURN
        (AST_METHOD_CALL
            (AST_VAR)
            (
                (AST_MAGIC_CONST)
                (AST_VAR)))))