	function initFormImages($obj, $token = null)
	{
		$smarty = $this->context->smarty;
		$content = '';
		if (!Tools::getValue('id_product'))
			return ''; // TEMPO
		global $attributeJs, $images;
		$shops = false;
		if (Shop::isFeatureActive())
			$shops = Shop::getShops();

		$countImages = Db::getInstance()->getValue('SELECT COUNT(id_product) FROM '._DB_PREFIX_.'image WHERE id_product = '.(int)$obj->id);
		$smarty->assign('countImages', $countImages);

		$images = Image::getImages($this->context->language->id, $obj->id);
		$imagesTotal = Image::getImagesTotal($obj->id);
		$smarty->assign('id_product', (int)Tools::getValue('id_product'));
		$smarty->assign('id_category_default', (int)$this->_category->id);

		$content .= '
							<p class="float" style="clear: both;">
								'.$this->l('Format:').' JPG, GIF, PNG. '.$this->l('Filesize:').' '.($this->maxImageSize / 1000).''.$this->l('Kb max.').'
							</p>
						</td>
					</tr>
					<tr>
						<td colspan="2" style="text-align:center;">
						<input type="hidden" name="resizer" value="auto" />
							'.(Tools::getValue('id_image') ? '<input type="hidden" name="id_image" value="'.(int)(Tools::getValue('id_image')).'" />' : '').'
						</td>
					</tr>
					<tr><td colspan="2" style="padding-bottom:10px;"><div class="separation"></div></td></tr>
					<tr>
						<td colspan="2">
							<script type="text/javascript" src="'._PS_JS_DIR_.'jquery/jquery.tablednd_0_5.js"></script>
							<script type="text/javascript">
								var token = \''.($token != null ? $token : $this->token).'\';
								var come_from = \''.$this->table.'\';
								var alternate = \''.($this->_orderWay == 'DESC' ? '1' : '0' ).'\';
							</script>
							<script type="text/javascript" src="'._PS_JS_DIR_.'admin-dnd.js"></script>
							<table cellspacing="0" cellpadding="0" class="table tableDnD" id="imageTable" style="display:'.($countImages == 0 ? 'none' : '').';">
								<thead>
								<tr>
									<th style="width: 100px;">'.$this->l('Image').'</th>
									<th>&nbsp;</th>
									<th>'.$this->l('Position').'</th>';
						if ($shops)
						{
							$content .= '<script type="text/javascript">
											$(document).ready(function() {
												$(\'.image_shop\').change(function() {
													$.post("ajax-tab.php",
														{
															updateProductImageShopAsso: 1,
															id_image:$(this).attr("name"),
															id_shop: $(this).val(),
															active:$(this).attr("checked"),
															id_product : "'.(int)Tools::getValue('id_product').'",
															id_category : "'.(int)$this->_category->id.'",
															token : "'.Tools::getAdminTokenLite('AdminProducts').'",
															tab : "AdminProducts",
															updateproduct : 1,
														});
												});
											});
										</script>';
							foreach ($shops as $shop)
								$content .= '<th>'.$shop['name'].'</th>';
						}
						$content .= '
									<th>'.$this->l('Cover').'</th>
									<th>'.$this->l('Action').'</th>
								</tr></thead>';

						foreach ($images as $k => $image)
							$content .= $this->getLineTableImage($image, $imagesTotal, $token, $shops);
			$content .= '
							</table>
						</td>
					</tr>
				</table>
			</div>';
			$smarty->assign('up_filename', strval(Tools::getValue('virtual_product_filename_attribute')));
			$smarty->assign('content',$content);
			$this->content = $smarty->fetch('products/images.tpl');
	}

||||||||	public function initFormImages($obj, $token = null)
	{
		$this->addJs('admin-dnd');
		$this->addJqueryPlugin('tablednd');

		$data = $this->context->smarty->createData();
		$data->assign('product', $this->loadObject());
		$content = '';
		if (!Tools::getValue('id_product'))
			return ''; // TEMPO
		global $attributeJs, $images;
		$shops = false;
		if (Shop::isFeatureActive())
			$shops = Shop::getShops();

		$data->assign('shops', $shops);
		$countImages = Db::getInstance()->getValue('SELECT COUNT(id_product) FROM '._DB_PREFIX_.'image WHERE id_product = '.(int)$obj->id);
		$data->assign('countImages', $countImages);

		$images = Image::getImages($this->context->language->id, $obj->id);
		$imagesTotal = Image::getImagesTotal($obj->id);
		$data->assign('id_product', (int)Tools::getValue('id_product'));
		$data->assign('id_category_default', (int)$this->_category->id);



		foreach ($images as $k => $image)
			$images[$k] = new Image($image['id_image']);

		$data->assign('images', $images);
		$data->assign('token', $token);
		$data->assign($this->tpl_form_vars);
		$data->assign('table', $this->table);
		$data->assign('max_image_size', $this->max_image_size);

		$data->assign('up_filename', strval(Tools::getValue('virtual_product_filename_attribute')));
		$data->assign('currency', $this->context->currency);

		$this->tpl_form_vars['custom_form'] = $this->context->smarty->createTemplate($this->tpl_form, $data)->fetch();
	}

||||||||NO_DOC_COMMENTNO_RETURN_TYPE
(NO_PARAM_TYPENO_PARAM_DEFAULTNO_PARAM_TYPEPARAM_DEFAULT)
(
    (AST_ASSIGN
        (AST_VAR)
        (AST_PROP
            (AST_PROP
                (AST_VAR))))
    (AST_ASSIGN
        (AST_VAR)
        (SCALAR))
    (AST_IF
        (AST_IF_ELEM
            (AST_UNARY_OP
                (AST_STATIC_CALL
                    (
                        (SCALAR))))
            (
                (AST_RETURN
                    (SCALAR)))))
    (AST_GLOBAL
        (AST_VAR))
    (AST_GLOBAL
        (AST_VAR))
    (AST_ASSIGN
        (AST_VAR)
        (AST_CONST))
    (AST_IF
        (AST_IF_ELEM
            (AST_STATIC_CALL)
            (
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_STATIC_CALL)))))
    (AST_ASSIGN
        (AST_VAR)
        (AST_METHOD_CALL
            (AST_STATIC_CALL)
            (
                (AST_BINARY_OP
                    (AST_BINARY_OP
                        (AST_BINARY_OP
                            (SCALAR)
                            (AST_CONST))
                        (SCALAR))
                    (AST_CAST
                        (AST_PROP
                            (AST_VAR)))))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_VAR)))
    (AST_ASSIGN
        (AST_VAR)
        (AST_STATIC_CALL
            (
                (AST_PROP
                    (AST_PROP
                        (AST_PROP
                            (AST_VAR))))
                (AST_PROP
                    (AST_VAR)))))
    (AST_ASSIGN
        (AST_VAR)
        (AST_STATIC_CALL
            (
                (AST_PROP
                    (AST_VAR)))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_CAST
                (AST_STATIC_CALL
                    (
                        (SCALAR))))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_CAST
                (AST_PROP
                    (AST_PROP
                        (AST_VAR))))))
    (AST_ASSIGN_OP
        (AST_VAR)
        (AST_BINARY_OP
            (AST_BINARY_OP
                (AST_BINARY_OP
                    (AST_BINARY_OP
                        (AST_BINARY_OP
                            (AST_BINARY_OP
                                (AST_BINARY_OP
                                    (AST_BINARY_OP
                                        (AST_BINARY_OP
                                            (AST_BINARY_OP
                                                (AST_BINARY_OP
                                                    (AST_BINARY_OP
                                                        (AST_BINARY_OP
                                                            (AST_BINARY_OP
                                                                (AST_BINARY_OP
                                                                    (AST_BINARY_OP
                                                                        (AST_BINARY_OP
                                                                            (AST_BINARY_OP
                                                                                (AST_BINARY_OP
                                                                                    (AST_BINARY_OP
                                                                                        (AST_BINARY_OP
                                                                                            (AST_BINARY_OP
                                                                                                (AST_BINARY_OP
                                                                                                    (AST_BINARY_OP
                                                                                                        (AST_BINARY_OP
                                                                                                            (AST_BINARY_OP
                                                                                                                (SCALAR)
                                                                                                                (AST_METHOD_CALL
                                                                                                                    (AST_VAR)
                                                                                                                    (
                                                                                                                        (SCALAR))))
                                                                                                            (SCALAR))
                                                                                                        (AST_METHOD_CALL
                                                                                                            (AST_VAR)
                                                                                                            (
                                                                                                                (SCALAR))))
                                                                                                    (SCALAR))
                                                                                                (AST_BINARY_OP
                                                                                                    (AST_PROP
                                                                                                        (AST_VAR))
                                                                                                    (SCALAR)))
                                                                                            (SCALAR))
                                                                                        (AST_METHOD_CALL
                                                                                            (AST_VAR)
                                                                                            (
                                                                                                (SCALAR))))
                                                                                    (SCALAR))
                                                                                (AST_CONDITIONAL
                                                                                    (AST_STATIC_CALL
                                                                                        (
                                                                                            (SCALAR)))
                                                                                    (AST_BINARY_OP
                                                                                        (AST_BINARY_OP
                                                                                            (SCALAR)
                                                                                            (AST_CAST
                                                                                                (AST_STATIC_CALL
                                                                                                    (
                                                                                                        (SCALAR)))))
                                                                                        (SCALAR))
                                                                                    (SCALAR)))
                                                                            (SCALAR))
                                                                        (AST_CONST))
                                                                    (SCALAR))
                                                                (AST_CONDITIONAL
                                                                    (AST_BINARY_OP
                                                                        (AST_VAR)
                                                                        (AST_CONST))
                                                                    (AST_VAR)
                                                                    (AST_PROP
                                                                        (AST_VAR))))
                                                            (SCALAR))
                                                        (AST_PROP
                                                            (AST_VAR)))
                                                    (SCALAR))
                                                (AST_CONDITIONAL
                                                    (AST_BINARY_OP
                                                        (AST_PROP
                                                            (AST_VAR))
                                                        (SCALAR))
                                                    (SCALAR)
                                                    (SCALAR)))
                                            (SCALAR))
                                        (AST_CONST))
                                    (SCALAR))
                                (AST_CONDITIONAL
                                    (AST_BINARY_OP
                                        (AST_VAR)
                                        (SCALAR))
                                    (SCALAR)
                                    (SCALAR)))
                            (SCALAR))
                        (AST_METHOD_CALL
                            (AST_VAR)
                            (
                                (SCALAR))))
                    (SCALAR))
                (AST_METHOD_CALL
                    (AST_VAR)
                    (
                        (SCALAR))))
            (SCALAR)))
    (AST_IF
        (AST_IF_ELEM
            (AST_VAR)
            (
                (AST_ASSIGN_OP
                    (AST_VAR)
                    (AST_BINARY_OP
                        (AST_BINARY_OP
                            (AST_BINARY_OP
                                (AST_BINARY_OP
                                    (AST_BINARY_OP
                                        (AST_BINARY_OP
                                            (SCALAR)
                                            (AST_CAST
                                                (AST_STATIC_CALL
                                                    (
                                                        (SCALAR)))))
                                        (SCALAR))
                                    (AST_CAST
                                        (AST_PROP
                                            (AST_PROP
                                                (AST_VAR)))))
                                (SCALAR))
                            (AST_STATIC_CALL
                                (
                                    (SCALAR))))
                        (SCALAR)))
                (AST_FOREACH
                    (AST_VAR)
                    (AST_VAR)
                    (NULL)
                    (
                        (AST_ASSIGN_OP
                            (AST_VAR)
                            (AST_BINARY_OP
                                (AST_BINARY_OP
                                    (SCALAR)
                                    (AST_DIM
                                        (AST_VAR)
                                        (SCALAR)))
                                (SCALAR))))))))
    (AST_ASSIGN_OP
        (AST_VAR)
        (AST_BINARY_OP
            (AST_BINARY_OP
                (AST_BINARY_OP
                    (AST_BINARY_OP
                        (SCALAR)
                        (AST_METHOD_CALL
                            (AST_VAR)
                            (
                                (SCALAR))))
                    (SCALAR))
                (AST_METHOD_CALL
                    (AST_VAR)
                    (
                        (SCALAR))))
            (SCALAR)))
    (AST_FOREACH
        (AST_VAR)
        (AST_VAR)
        (AST_VAR)
        (
            (AST_ASSIGN_OP
                (AST_VAR)
                (AST_METHOD_CALL
                    (AST_VAR)
                    (
                        (AST_VAR)
                        (AST_VAR)
                        (AST_VAR)
                        (AST_VAR))))))
    (AST_ASSIGN_OP
        (AST_VAR)
        (SCALAR))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_CALL
                (
                    (AST_STATIC_CALL
                        (
                            (SCALAR)))))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_VAR)))
    (AST_ASSIGN
        (AST_PROP
            (AST_VAR))
        (AST_METHOD_CALL
            (AST_VAR)
            (
                (SCALAR)))))||||||||NO_DOC_COMMENTNO_RETURN_TYPE
(NO_PARAM_TYPENO_PARAM_DEFAULTNO_PARAM_TYPEPARAM_DEFAULT)
(
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)))
    (AST_ASSIGN
        (AST_VAR)
        (AST_METHOD_CALL
            (AST_PROP
                (AST_PROP
                    (AST_VAR)))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_METHOD_CALL
                (AST_VAR))))
    (AST_ASSIGN
        (AST_VAR)
        (SCALAR))
    (AST_IF
        (AST_IF_ELEM
            (AST_UNARY_OP
                (AST_STATIC_CALL
                    (
                        (SCALAR))))
            (
                (AST_RETURN
                    (SCALAR)))))
    (AST_GLOBAL
        (AST_VAR))
    (AST_GLOBAL
        (AST_VAR))
    (AST_ASSIGN
        (AST_VAR)
        (AST_CONST))
    (AST_IF
        (AST_IF_ELEM
            (AST_STATIC_CALL)
            (
                (AST_ASSIGN
                    (AST_VAR)
                    (AST_STATIC_CALL)))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_VAR)))
    (AST_ASSIGN
        (AST_VAR)
        (AST_METHOD_CALL
            (AST_STATIC_CALL)
            (
                (AST_BINARY_OP
                    (AST_BINARY_OP
                        (AST_BINARY_OP
                            (SCALAR)
                            (AST_CONST))
                        (SCALAR))
                    (AST_CAST
                        (AST_PROP
                            (AST_VAR)))))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_VAR)))
    (AST_ASSIGN
        (AST_VAR)
        (AST_STATIC_CALL
            (
                (AST_PROP
                    (AST_PROP
                        (AST_PROP
                            (AST_VAR))))
                (AST_PROP
                    (AST_VAR)))))
    (AST_ASSIGN
        (AST_VAR)
        (AST_STATIC_CALL
            (
                (AST_PROP
                    (AST_VAR)))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_CAST
                (AST_STATIC_CALL
                    (
                        (SCALAR))))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_CAST
                (AST_PROP
                    (AST_PROP
                        (AST_VAR))))))
    (AST_FOREACH
        (AST_VAR)
        (AST_VAR)
        (AST_VAR)
        (
            (AST_ASSIGN
                (AST_DIM
                    (AST_VAR)
                    (AST_VAR))
                (AST_NEW
                    (
                        (AST_DIM
                            (AST_VAR)
                            (SCALAR)))))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_VAR)))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_VAR)))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (AST_PROP
                (AST_VAR))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_PROP
                (AST_VAR))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_PROP
                (AST_VAR))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_CALL
                (
                    (AST_STATIC_CALL
                        (
                            (SCALAR)))))))
    (AST_METHOD_CALL
        (AST_VAR)
        (
            (SCALAR)
            (AST_PROP
                (AST_PROP
                    (AST_VAR)))))
    (AST_ASSIGN
        (AST_DIM
            (AST_PROP
                (AST_VAR))
            (SCALAR))
        (AST_METHOD_CALL
            (AST_METHOD_CALL
                (AST_PROP
                    (AST_PROP
                        (AST_VAR)))
                (
                    (AST_PROP
                        (AST_VAR))
                    (AST_VAR))))))