commit c9a70acf36095a632904ed95b1b848643db36d9a
Author: Szczepan Faber <szczepiq@gmail.com>
Date:   Fri Dec 16 13:13:54 2011 +0100

    Added some missing coverage, refactored the code a bit.