@Test
public void shouldPeekAndIterateOverRange() throws Exception {
    final ThreadCache cache = new ThreadCache("testCache", 10000L, new MockStreamsMetrics(new Metrics()));
    final byte[][] bytes = { { 0 }, { 1 }, { 2 }, { 3 }, { 4 }, { 5 }, { 6 }, { 7 }, { 8 }, { 9 }, { 10 } };
    final String namespace = "streams";
    for (final byte[] aByte : bytes) {
        cache.put(namespace, aByte, dirtyEntry(aByte));
    }
    final ThreadCache.MemoryLRUCacheBytesIterator iterator = cache.range(namespace, new byte[] { 1 }, new byte[] { 4 });
    int bytesIndex = 1;
    while (iterator.hasNext()) {
        Bytes peekedKey = iterator.peekNextKey();
        final KeyValue<Bytes, LRUCacheEntry> next = iterator.next();
        assertArrayEquals(bytes[bytesIndex], peekedKey.get());
        assertArrayEquals(bytes[bytesIndex], next.key.get());
        bytesIndex++;
    }
    assertEquals(5, bytesIndex);
}||||||||@Test
public void shouldPeekAndIterateOverRange() throws Exception {
    final ThreadCache cache = new ThreadCache("testCache", 10000L, new MockStreamsMetrics(new Metrics()));
    final byte[][] bytes = { { 0 }, { 1 }, { 2 }, { 3 }, { 4 }, { 5 }, { 6 }, { 7 }, { 8 }, { 9 }, { 10 } };
    final String namespace = "streams";
    for (final byte[] aByte : bytes) {
        cache.put(namespace, Bytes.wrap(aByte), dirtyEntry(aByte));
    }
    final ThreadCache.MemoryLRUCacheBytesIterator iterator = cache.range(namespace, Bytes.wrap(new byte[] { 1 }), Bytes.wrap(new byte[] { 4 }));
    int bytesIndex = 1;
    while (iterator.hasNext()) {
        Bytes peekedKey = iterator.peekNextKey();
        final KeyValue<Bytes, LRUCacheEntry> next = iterator.next();
        assertArrayEquals(bytes[bytesIndex], peekedKey.get());
        assertArrayEquals(bytes[bytesIndex], next.key.get());
        bytesIndex++;
    }
    assertEquals(5, bytesIndex);
}||||||||(MethodDeclaration
	(BlockStmt
		(ExpressionStmt
			(VariableDeclarationExpr
				(VariableDeclarator
					(ObjectCreationExpr
						StringLiteralExpr
						(LongLiteralExpr
						)
						(ObjectCreationExpr
							(ObjectCreationExpr
								(ClassOrInterfaceType
									SimpleName
								)
							)
							(ClassOrInterfaceType
								SimpleName
							)
						)
						(ClassOrInterfaceType
							SimpleName
						)
					)
					SimpleName
					(ClassOrInterfaceType
						SimpleName
					)
				)
			)
		)
		(ExpressionStmt
			(VariableDeclarationExpr
				(VariableDeclarator
					(ArrayInitializerExpr
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
					)
					SimpleName
					(ArrayType
						(ArrayType
							(PrimitiveType
							)
						)
					)
				)
			)
		)
		(ExpressionStmt
			(VariableDeclarationExpr
				(VariableDeclarator
					StringLiteralExpr
					SimpleName
					(ClassOrInterfaceType
						SimpleName
					)
				)
			)
		)
		(ForeachStmt
			(BlockStmt
				(ExpressionStmt
					(MethodCallExpr
						NameExpr
							SimpleName
						NameExpr
							SimpleName
						(MethodCallExpr
							NameExpr
								SimpleName
							SimpleName
						)
						SimpleName
						NameExpr
							SimpleName
					)
				)
			)
			NameExpr
				SimpleName
			(VariableDeclarationExpr
				(VariableDeclarator
					SimpleName
					(ArrayType
						(PrimitiveType
						)
					)
				)
			)
		)
		(ExpressionStmt
			(VariableDeclarationExpr
				(VariableDeclarator
					(MethodCallExpr
						NameExpr
							SimpleName
						(ArrayCreationExpr
							(PrimitiveType
							)
							(ArrayInitializerExpr
								(IntegerLiteralExpr
								)
							)
							(ArrayCreationLevel
							)
						)
						(ArrayCreationExpr
							(PrimitiveType
							)
							(ArrayInitializerExpr
								(IntegerLiteralExpr
								)
							)
							(ArrayCreationLevel
							)
						)
						SimpleName
						NameExpr
							SimpleName
					)
					SimpleName
					(ClassOrInterfaceType
						SimpleName
						(ClassOrInterfaceType
							SimpleName
						)
					)
				)
			)
		)
		(ExpressionStmt
			(VariableDeclarationExpr
				(VariableDeclarator
					(IntegerLiteralExpr
					)
					SimpleName
					(PrimitiveType
					)
				)
			)
		)
		(WhileStmt
			(BlockStmt
				(ExpressionStmt
					(VariableDeclarationExpr
						(VariableDeclarator
							(MethodCallExpr
								SimpleName
								NameExpr
									SimpleName
							)
							SimpleName
							(ClassOrInterfaceType
								SimpleName
							)
						)
					)
				)
				(ExpressionStmt
					(VariableDeclarationExpr
						(VariableDeclarator
							(MethodCallExpr
								SimpleName
								NameExpr
									SimpleName
							)
							SimpleName
							(ClassOrInterfaceType
								SimpleName
								(ClassOrInterfaceType
									SimpleName
								)
								(ClassOrInterfaceType
									SimpleName
								)
							)
						)
					)
				)
				(ExpressionStmt
					(MethodCallExpr
						(ArrayAccessExpr
							NameExpr
								SimpleName
							NameExpr
								SimpleName
						)
						(MethodCallExpr
							SimpleName
							NameExpr
								SimpleName
						)
						SimpleName
					)
				)
				(ExpressionStmt
					(MethodCallExpr
						(ArrayAccessExpr
							NameExpr
								SimpleName
							NameExpr
								SimpleName
						)
						(MethodCallExpr
							SimpleName
							(FieldAccessExpr
								SimpleName
								NameExpr
									SimpleName
							)
						)
						SimpleName
					)
				)
				(ExpressionStmt
					(UnaryExpr
						NameExpr
							SimpleName
					)
				)
			)
			(MethodCallExpr
				SimpleName
				NameExpr
					SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(IntegerLiteralExpr
				)
				NameExpr
					SimpleName
				SimpleName
			)
		)
	)
	(VoidType
	)
	SimpleName
	(ClassOrInterfaceType
		SimpleName
	)
	(MarkerAnnotationExpr
		Name
	)
)
||||||||(MethodDeclaration
	(BlockStmt
		(ExpressionStmt
			(VariableDeclarationExpr
				(VariableDeclarator
					(ObjectCreationExpr
						StringLiteralExpr
						(LongLiteralExpr
						)
						(ObjectCreationExpr
							(ObjectCreationExpr
								(ClassOrInterfaceType
									SimpleName
								)
							)
							(ClassOrInterfaceType
								SimpleName
							)
						)
						(ClassOrInterfaceType
							SimpleName
						)
					)
					SimpleName
					(ClassOrInterfaceType
						SimpleName
					)
				)
			)
		)
		(ExpressionStmt
			(VariableDeclarationExpr
				(VariableDeclarator
					(ArrayInitializerExpr
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
						(ArrayInitializerExpr
							(IntegerLiteralExpr
							)
						)
					)
					SimpleName
					(ArrayType
						(ArrayType
							(PrimitiveType
							)
						)
					)
				)
			)
		)
		(ExpressionStmt
			(VariableDeclarationExpr
				(VariableDeclarator
					StringLiteralExpr
					SimpleName
					(ClassOrInterfaceType
						SimpleName
					)
				)
			)
		)
		(ForeachStmt
			(BlockStmt
				(ExpressionStmt
					(MethodCallExpr
						NameExpr
							SimpleName
						(MethodCallExpr
							NameExpr
								SimpleName
							SimpleName
							NameExpr
								SimpleName
						)
						(MethodCallExpr
							NameExpr
								SimpleName
							SimpleName
						)
						SimpleName
						NameExpr
							SimpleName
					)
				)
			)
			NameExpr
				SimpleName
			(VariableDeclarationExpr
				(VariableDeclarator
					SimpleName
					(ArrayType
						(PrimitiveType
						)
					)
				)
			)
		)
		(ExpressionStmt
			(VariableDeclarationExpr
				(VariableDeclarator
					(MethodCallExpr
						NameExpr
							SimpleName
						(MethodCallExpr
							(ArrayCreationExpr
								(PrimitiveType
								)
								(ArrayInitializerExpr
									(IntegerLiteralExpr
									)
								)
								(ArrayCreationLevel
								)
							)
							SimpleName
							NameExpr
								SimpleName
						)
						(MethodCallExpr
							(ArrayCreationExpr
								(PrimitiveType
								)
								(ArrayInitializerExpr
									(IntegerLiteralExpr
									)
								)
								(ArrayCreationLevel
								)
							)
							SimpleName
							NameExpr
								SimpleName
						)
						SimpleName
						NameExpr
							SimpleName
					)
					SimpleName
					(ClassOrInterfaceType
						SimpleName
						(ClassOrInterfaceType
							SimpleName
						)
					)
				)
			)
		)
		(ExpressionStmt
			(VariableDeclarationExpr
				(VariableDeclarator
					(IntegerLiteralExpr
					)
					SimpleName
					(PrimitiveType
					)
				)
			)
		)
		(WhileStmt
			(BlockStmt
				(ExpressionStmt
					(VariableDeclarationExpr
						(VariableDeclarator
							(MethodCallExpr
								SimpleName
								NameExpr
									SimpleName
							)
							SimpleName
							(ClassOrInterfaceType
								SimpleName
							)
						)
					)
				)
				(ExpressionStmt
					(VariableDeclarationExpr
						(VariableDeclarator
							(MethodCallExpr
								SimpleName
								NameExpr
									SimpleName
							)
							SimpleName
							(ClassOrInterfaceType
								SimpleName
								(ClassOrInterfaceType
									SimpleName
								)
								(ClassOrInterfaceType
									SimpleName
								)
							)
						)
					)
				)
				(ExpressionStmt
					(MethodCallExpr
						(ArrayAccessExpr
							NameExpr
								SimpleName
							NameExpr
								SimpleName
						)
						(MethodCallExpr
							SimpleName
							NameExpr
								SimpleName
						)
						SimpleName
					)
				)
				(ExpressionStmt
					(MethodCallExpr
						(ArrayAccessExpr
							NameExpr
								SimpleName
							NameExpr
								SimpleName
						)
						(MethodCallExpr
							SimpleName
							(FieldAccessExpr
								SimpleName
								NameExpr
									SimpleName
							)
						)
						SimpleName
					)
				)
				(ExpressionStmt
					(UnaryExpr
						NameExpr
							SimpleName
					)
				)
			)
			(MethodCallExpr
				SimpleName
				NameExpr
					SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(IntegerLiteralExpr
				)
				NameExpr
					SimpleName
				SimpleName
			)
		)
	)
	(VoidType
	)
	SimpleName
	(ClassOrInterfaceType
		SimpleName
	)
	(MarkerAnnotationExpr
		Name
	)
)

