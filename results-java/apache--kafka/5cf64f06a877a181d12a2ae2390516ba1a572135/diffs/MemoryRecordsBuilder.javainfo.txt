/**
 * Get the max timestamp and its offset. If the log append time is used, then the offset will
 * be either the first offset in the set if no compression is used or the last offset otherwise.
 * @return The max timestamp and its offset
 */
public RecordsInfo info() {
    if (timestampType == TimestampType.LOG_APPEND_TIME)
        return new RecordsInfo(logAppendTime, lastOffset);
    else if (maxTimestamp == RecordBatch.NO_TIMESTAMP)
        return new RecordsInfo(RecordBatch.NO_TIMESTAMP, lastOffset);
    else
        return new RecordsInfo(maxTimestamp, compressionType == CompressionType.NONE ? offsetOfMaxTimestamp : lastOffset);
}||||||||/**
 * Get the max timestamp and its offset. The details of the offset returned are a bit subtle.
 *
 * If the log append time is used, the offset will be the last offset unless no compression is used and
 * the message format version is 0 or 1, in which case, it will be the first offset.
 *
 * If create time is used, the offset will be the last offset unless no compression is used and the message
 * format version is 0 or 1, in which case, it will be the offset of the record with the max timestamp.
 *
 * @return The max timestamp and its offset
 */
public RecordsInfo info() {
    if (timestampType == TimestampType.LOG_APPEND_TIME) {
        long shallowOffsetOfMaxTimestamp;
        // Use the last offset when dealing with record batches
        if (compressionType != CompressionType.NONE || magic >= RecordBatch.MAGIC_VALUE_V2)
            shallowOffsetOfMaxTimestamp = lastOffset;
        else
            shallowOffsetOfMaxTimestamp = baseOffset;
        return new RecordsInfo(logAppendTime, shallowOffsetOfMaxTimestamp);
    } else if (maxTimestamp == RecordBatch.NO_TIMESTAMP) {
        return new RecordsInfo(RecordBatch.NO_TIMESTAMP, lastOffset);
    } else {
        long shallowOffsetOfMaxTimestamp;
        // Use the last offset when dealing with record batches
        if (compressionType != CompressionType.NONE || magic >= RecordBatch.MAGIC_VALUE_V2)
            shallowOffsetOfMaxTimestamp = lastOffset;
        else
            shallowOffsetOfMaxTimestamp = offsetOfMaxTimestamp;
        return new RecordsInfo(maxTimestamp, shallowOffsetOfMaxTimestamp);
    }
}||||||||(MethodDeclaration
	(BlockStmt
		(IfStmt
			(BinaryExpr
				NameExpr
					SimpleName
				(FieldAccessExpr
					SimpleName
					NameExpr
						SimpleName
				)
			)
			(IfStmt
				(BinaryExpr
					NameExpr
						SimpleName
					(FieldAccessExpr
						SimpleName
						NameExpr
							SimpleName
					)
				)
				(ReturnStmt
					(ObjectCreationExpr
						NameExpr
							SimpleName
						(ConditionalExpr
							(BinaryExpr
								NameExpr
									SimpleName
								(FieldAccessExpr
									SimpleName
									NameExpr
										SimpleName
								)
							)
							NameExpr
								SimpleName
							NameExpr
								SimpleName
						)
						(ClassOrInterfaceType
							SimpleName
						)
					)
				)
				(ReturnStmt
					(ObjectCreationExpr
						(FieldAccessExpr
							SimpleName
							NameExpr
								SimpleName
						)
						NameExpr
							SimpleName
						(ClassOrInterfaceType
							SimpleName
						)
					)
				)
			)
			(ReturnStmt
				(ObjectCreationExpr
					NameExpr
						SimpleName
					NameExpr
						SimpleName
					(ClassOrInterfaceType
						SimpleName
					)
				)
			)
		)
	)
	(ClassOrInterfaceType
		SimpleName
	)
	SimpleName
	(JavadocComment
	)
)
||||||||(MethodDeclaration
	(BlockStmt
		(IfStmt
			(BinaryExpr
				NameExpr
					SimpleName
				(FieldAccessExpr
					SimpleName
					NameExpr
						SimpleName
				)
			)
			(IfStmt
				(BinaryExpr
					NameExpr
						SimpleName
					(FieldAccessExpr
						SimpleName
						NameExpr
							SimpleName
					)
				)
				(BlockStmt
					(ExpressionStmt
						(VariableDeclarationExpr
							(VariableDeclarator
								SimpleName
								(PrimitiveType
								)
							)
						)
					)
					(IfStmt
						(BinaryExpr
							(BinaryExpr
								NameExpr
									SimpleName
								(FieldAccessExpr
									SimpleName
									NameExpr
										SimpleName
								)
							)
							(BinaryExpr
								NameExpr
									SimpleName
								(FieldAccessExpr
									SimpleName
									NameExpr
										SimpleName
								)
							)
						)
						(ExpressionStmt
							(AssignExpr
								NameExpr
									SimpleName
								NameExpr
									SimpleName
							)
						)
						(ExpressionStmt
							(AssignExpr
								NameExpr
									SimpleName
								NameExpr
									SimpleName
							)
						)
						LineComment
					)
					(ReturnStmt
						(ObjectCreationExpr
							NameExpr
								SimpleName
							NameExpr
								SimpleName
							(ClassOrInterfaceType
								SimpleName
							)
						)
					)
				)
				(BlockStmt
					(ReturnStmt
						(ObjectCreationExpr
							(FieldAccessExpr
								SimpleName
								NameExpr
									SimpleName
							)
							NameExpr
								SimpleName
							(ClassOrInterfaceType
								SimpleName
							)
						)
					)
				)
			)
			(BlockStmt
				(ExpressionStmt
					(VariableDeclarationExpr
						(VariableDeclarator
							SimpleName
							(PrimitiveType
							)
						)
					)
				)
				(IfStmt
					(BinaryExpr
						(BinaryExpr
							NameExpr
								SimpleName
							(FieldAccessExpr
								SimpleName
								NameExpr
									SimpleName
							)
						)
						(BinaryExpr
							NameExpr
								SimpleName
							(FieldAccessExpr
								SimpleName
								NameExpr
									SimpleName
							)
						)
					)
					(ExpressionStmt
						(AssignExpr
							NameExpr
								SimpleName
							NameExpr
								SimpleName
						)
					)
					(ExpressionStmt
						(AssignExpr
							NameExpr
								SimpleName
							NameExpr
								SimpleName
						)
					)
					LineComment
				)
				(ReturnStmt
					(ObjectCreationExpr
						NameExpr
							SimpleName
						NameExpr
							SimpleName
						(ClassOrInterfaceType
							SimpleName
						)
					)
				)
			)
		)
	)
	(ClassOrInterfaceType
		SimpleName
	)
	SimpleName
	(JavadocComment
	)
)

