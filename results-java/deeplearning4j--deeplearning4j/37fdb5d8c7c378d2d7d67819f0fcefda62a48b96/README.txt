commit 37fdb5d8c7c378d2d7d67819f0fcefda62a48b96
Author: Alex Black <blacka101@gmail.com>
Date:   Wed Jul 12 17:30:48 2017 +1000

    Additional fixes after refactoring