@Test
public void testAsynchEventListeners() throws IOException {
    if (!database.getURL().startsWith("remote:"))
        return;
    database.open("admin", "admin");
    ((OStorageRemoteThread) database.getStorage()).addRemoteServerEventListener(new ORemoteServerEventListener() {

        public void onRecordPulled(ORecord<?> iRecord) {
            onRecordPulled++;
        }

        public void onClusterConfigurationChange(byte[] clusterConfig) {
            onClusterConfigurationChange++;
        }
    });
    database.close();
}||||||||@Test
public void testAsynchEventListeners() throws IOException {
    if (!database.getURL().startsWith("remote:"))
        return;
    database.open("admin", "admin");
    ((OStorageRemoteThread) database.getStorage()).setRemoteServerEventListener(new ORemoteServerEventListener() {

        public void onRequest(byte iRequestCode, Object iObject) {
            switch(iRequestCode) {
                case OChannelBinaryProtocol.REQUEST_PUSH_RECORD:
                    onRecordPulled++;
                    break;
                case OChannelDistributedProtocol.PUSH_DISTRIBUTED_CONFIG:
                    onClusterConfigurationChange++;
                    break;
                case OChannelDistributedProtocol.PUSH_LEADER_AVAILABLE_DBS:
                    onAvailableDatabaseChange++;
                    break;
            }
        }
    });
    database.close();
}||||||||(MethodDeclaration
	(BlockStmt
		(IfStmt
			(UnaryExpr
				(MethodCallExpr
					StringLiteralExpr
					SimpleName
					(MethodCallExpr
						SimpleName
						NameExpr
							SimpleName
					)
				)
			)
			(ReturnStmt
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				StringLiteralExpr
				StringLiteralExpr
				SimpleName
				NameExpr
					SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(ObjectCreationExpr
					(MethodDeclaration
						(BlockStmt
							(ExpressionStmt
								(UnaryExpr
									NameExpr
										SimpleName
								)
							)
						)
						(VoidType
						)
						SimpleName
						(Parameter
							SimpleName
							(ClassOrInterfaceType
								SimpleName
								(WildcardType
								)
							)
						)
					)
					(MethodDeclaration
						(BlockStmt
							(ExpressionStmt
								(UnaryExpr
									NameExpr
										SimpleName
								)
							)
						)
						(VoidType
						)
						SimpleName
						(Parameter
							SimpleName
							(ArrayType
								(PrimitiveType
								)
							)
						)
					)
					(ClassOrInterfaceType
						SimpleName
					)
				)
				SimpleName
				(EnclosedExpr
					(CastExpr
						(MethodCallExpr
							SimpleName
							NameExpr
								SimpleName
						)
						(ClassOrInterfaceType
							SimpleName
						)
					)
				)
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				SimpleName
				NameExpr
					SimpleName
			)
		)
	)
	(VoidType
	)
	SimpleName
	(ClassOrInterfaceType
		SimpleName
	)
	(MarkerAnnotationExpr
		Name
	)
)
||||||||(MethodDeclaration
	(BlockStmt
		(IfStmt
			(UnaryExpr
				(MethodCallExpr
					StringLiteralExpr
					SimpleName
					(MethodCallExpr
						SimpleName
						NameExpr
							SimpleName
					)
				)
			)
			(ReturnStmt
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				StringLiteralExpr
				StringLiteralExpr
				SimpleName
				NameExpr
					SimpleName
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				(ObjectCreationExpr
					(MethodDeclaration
						(BlockStmt
							(SwitchStmt
								(SwitchEntryStmt
									(FieldAccessExpr
										SimpleName
										NameExpr
											SimpleName
									)
									(ExpressionStmt
										(UnaryExpr
											NameExpr
												SimpleName
										)
									)
									(BreakStmt
									)
								)
								(SwitchEntryStmt
									(FieldAccessExpr
										SimpleName
										NameExpr
											SimpleName
									)
									(ExpressionStmt
										(UnaryExpr
											NameExpr
												SimpleName
										)
									)
									(BreakStmt
									)
								)
								(SwitchEntryStmt
									(FieldAccessExpr
										SimpleName
										NameExpr
											SimpleName
									)
									(ExpressionStmt
										(UnaryExpr
											NameExpr
												SimpleName
										)
									)
									(BreakStmt
									)
								)
								NameExpr
									SimpleName
							)
						)
						(VoidType
						)
						SimpleName
						(Parameter
							SimpleName
							(PrimitiveType
							)
						)
						(Parameter
							SimpleName
							(ClassOrInterfaceType
								SimpleName
							)
						)
					)
					(ClassOrInterfaceType
						SimpleName
					)
				)
				SimpleName
				(EnclosedExpr
					(CastExpr
						(MethodCallExpr
							SimpleName
							NameExpr
								SimpleName
						)
						(ClassOrInterfaceType
							SimpleName
						)
					)
				)
			)
		)
		(ExpressionStmt
			(MethodCallExpr
				SimpleName
				NameExpr
					SimpleName
			)
		)
	)
	(VoidType
	)
	SimpleName
	(ClassOrInterfaceType
		SimpleName
	)
	(MarkerAnnotationExpr
		Name
	)
)

