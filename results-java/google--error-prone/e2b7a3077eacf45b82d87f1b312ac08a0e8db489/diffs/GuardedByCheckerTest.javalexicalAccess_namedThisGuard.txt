@Test
public void lexicalAccess_namedThisGuard() throws Exception {
    compilationHelper.assertCompileFailsWithMessages(compilationHelper.fileManager().forSourceLines("threadsafety/Test.java", "package threadsafety;", "import javax.annotation.concurrent.GuardedBy;", "class LexicalAccess_NamedThisGuard {", "  class Outer {", "    class Inner {", "      @GuardedBy(\"Outer.this\")", "      int x;", "      class InnerMost {", "        void m() {", "          synchronized (Outer.this) {", "            Inner.this.x++;", "          }", "          // BUG: Diagnostic contains: Expected Outer.this", "          Inner.this.x++;", "        }", "      }", "    }", "  }", "}"));
}||||||||@Test
public void lexicalAccess_namedThisGuard() throws Exception {
    compilationHelper.assertCompileFailsWithMessages(compilationHelper.fileManager().forSourceLines("threadsafety/Test.java", "package threadsafety;", "import javax.annotation.concurrent.GuardedBy;", "class LexicalAccess_NamedThisGuard {", "  class Outer {", "    class Inner {", "      @GuardedBy(\"Outer.this\")", "      int x;", "      class InnerMost {", "        void m() {", "          synchronized (Outer.this) {", "            Inner.this.x++;", "          }", "          // BUG: Diagnostic contains:", "          // should be guarded by 'Outer.this'", "          Inner.this.x++;", "        }", "      }", "    }", "  }", "}"));
}||||||||(MethodDeclaration
	(BlockStmt
		(ExpressionStmt
			(MethodCallExpr
				(MethodCallExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					SimpleName
					(MethodCallExpr
						SimpleName
						NameExpr
							SimpleName
					)
				)
				SimpleName
				NameExpr
					SimpleName
			)
		)
	)
	(VoidType
	)
	SimpleName
	(ClassOrInterfaceType
		SimpleName
	)
	(MarkerAnnotationExpr
		Name
	)
)
||||||||(MethodDeclaration
	(BlockStmt
		(ExpressionStmt
			(MethodCallExpr
				(MethodCallExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					StringLiteralExpr
					SimpleName
					(MethodCallExpr
						SimpleName
						NameExpr
							SimpleName
					)
				)
				SimpleName
				NameExpr
					SimpleName
			)
		)
	)
	(VoidType
	)
	SimpleName
	(ClassOrInterfaceType
		SimpleName
	)
	(MarkerAnnotationExpr
		Name
	)
)

