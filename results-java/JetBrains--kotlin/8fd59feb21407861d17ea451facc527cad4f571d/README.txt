commit 8fd59feb21407861d17ea451facc527cad4f571d
Author: Andrey Breslav <andrey.breslav@jetbrains.com>
Date:   Wed Jan 30 20:59:19 2013 +0400

    Logic refactored to a finite automaton