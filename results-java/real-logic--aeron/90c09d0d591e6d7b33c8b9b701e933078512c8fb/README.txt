commit 90c09d0d591e6d7b33c8b9b701e933078512c8fb
Author: Richard Warburton <richard.warburton@gmail.com>
Date:   Tue Jul 22 17:28:20 2014 +0100

    fix bugs from last refactor